(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{3454:function(A,S,E){"use strict";var C,T;A.exports=(null==(C=E.g.process)?void 0:C.env)&&"object"==typeof(null==(T=E.g.process)?void 0:T.env)?E.g.process:E(7663)},1118:function(A,S,E){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return E(9597)}])},9597:function(A,S,E){"use strict";E.r(S),E.d(S,{default:function(){return App}});var C=E(5893),T=E(2191);function App(A){let{Component:S,pageProps:E}=A;return(0,C.jsx)(S,{...E})}T.default.GlobalWorkerOptions.workerSrc="//unpkg.com/pdfjs-dist@".concat(T.default.version,"/legacy/build/pdf.worker.min.js")},1876:function(A){var S="/";!function(){var E={675:function(A,S){"use strict";S.byteLength=byteLength,S.toByteArray=toByteArray,S.fromByteArray=fromByteArray;for(var E=[],C=[],T="undefined"!=typeof Uint8Array?Uint8Array:Array,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=0,R=P.length;M<R;++M)E[M]=P[M],C[P.charCodeAt(M)]=M;function getLens(A){var S=A.length;if(S%4>0)throw Error("Invalid string. Length must be a multiple of 4");var E=A.indexOf("=");-1===E&&(E=S);var C=E===S?0:4-E%4;return[E,C]}function byteLength(A){var S=getLens(A),E=S[0],C=S[1];return(E+C)*3/4-C}function _byteLength(A,S,E){return(S+E)*3/4-E}function toByteArray(A){var S,E,P=getLens(A),M=P[0],R=P[1],F=new T(_byteLength(A,M,R)),I=0,D=R>0?M-4:M;for(E=0;E<D;E+=4)S=C[A.charCodeAt(E)]<<18|C[A.charCodeAt(E+1)]<<12|C[A.charCodeAt(E+2)]<<6|C[A.charCodeAt(E+3)],F[I++]=S>>16&255,F[I++]=S>>8&255,F[I++]=255&S;return 2===R&&(S=C[A.charCodeAt(E)]<<2|C[A.charCodeAt(E+1)]>>4,F[I++]=255&S),1===R&&(S=C[A.charCodeAt(E)]<<10|C[A.charCodeAt(E+1)]<<4|C[A.charCodeAt(E+2)]>>2,F[I++]=S>>8&255,F[I++]=255&S),F}function tripletToBase64(A){return E[A>>18&63]+E[A>>12&63]+E[A>>6&63]+E[63&A]}function encodeChunk(A,S,E){for(var C=[],T=S;T<E;T+=3)C.push(tripletToBase64((A[T]<<16&16711680)+(A[T+1]<<8&65280)+(255&A[T+2])));return C.join("")}function fromByteArray(A){for(var S,C=A.length,T=C%3,P=[],M=16383,R=0,F=C-T;R<F;R+=M)P.push(encodeChunk(A,R,R+M>F?F:R+M));return 1===T?P.push(E[(S=A[C-1])>>2]+E[S<<4&63]+"=="):2===T&&P.push(E[(S=(A[C-2]<<8)+A[C-1])>>10]+E[S>>4&63]+E[S<<2&63]+"="),P.join("")}C["-".charCodeAt(0)]=62,C["_".charCodeAt(0)]=63},72:function(A,S,E){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var C=E(675),T=E(783),P="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;S.Buffer=Buffer,S.SlowBuffer=SlowBuffer,S.INSPECT_MAX_BYTES=50;var M=2147483647;function typedArraySupport(){try{var A=new Uint8Array(1),S={foo:function(){return 42}};return Object.setPrototypeOf(S,Uint8Array.prototype),Object.setPrototypeOf(A,S),42===A.foo()}catch(A){return!1}}function createBuffer(A){if(A>M)throw RangeError('The value "'+A+'" is invalid for option "size"');var S=new Uint8Array(A);return Object.setPrototypeOf(S,Buffer.prototype),S}function Buffer(A,S,E){if("number"==typeof A){if("string"==typeof S)throw TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(A)}return from(A,S,E)}function from(A,S,E){if("string"==typeof A)return fromString(A,S);if(ArrayBuffer.isView(A))return fromArrayLike(A);if(null==A)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A);if(isInstance(A,ArrayBuffer)||A&&isInstance(A.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(isInstance(A,SharedArrayBuffer)||A&&isInstance(A.buffer,SharedArrayBuffer)))return fromArrayBuffer(A,S,E);if("number"==typeof A)throw TypeError('The "value" argument must not be of type number. Received type number');var C=A.valueOf&&A.valueOf();if(null!=C&&C!==A)return Buffer.from(C,S,E);var T=fromObject(A);if(T)return T;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof A[Symbol.toPrimitive])return Buffer.from(A[Symbol.toPrimitive]("string"),S,E);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A)}function assertSize(A){if("number"!=typeof A)throw TypeError('"size" argument must be of type number');if(A<0)throw RangeError('The value "'+A+'" is invalid for option "size"')}function alloc(A,S,E){return(assertSize(A),A<=0)?createBuffer(A):void 0!==S?"string"==typeof E?createBuffer(A).fill(S,E):createBuffer(A).fill(S):createBuffer(A)}function allocUnsafe(A){return assertSize(A),createBuffer(A<0?0:0|checked(A))}function fromString(A,S){if(("string"!=typeof S||""===S)&&(S="utf8"),!Buffer.isEncoding(S))throw TypeError("Unknown encoding: "+S);var E=0|byteLength(A,S),C=createBuffer(E),T=C.write(A,S);return T!==E&&(C=C.slice(0,T)),C}function fromArrayLike(A){for(var S=A.length<0?0:0|checked(A.length),E=createBuffer(S),C=0;C<S;C+=1)E[C]=255&A[C];return E}function fromArrayBuffer(A,S,E){var C;if(S<0||A.byteLength<S)throw RangeError('"offset" is outside of buffer bounds');if(A.byteLength<S+(E||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(C=void 0===S&&void 0===E?new Uint8Array(A):void 0===E?new Uint8Array(A,S):new Uint8Array(A,S,E),Buffer.prototype),C}function fromObject(A){if(Buffer.isBuffer(A)){var S=0|checked(A.length),E=createBuffer(S);return 0===E.length||A.copy(E,0,0,S),E}return void 0!==A.length?"number"!=typeof A.length||numberIsNaN(A.length)?createBuffer(0):fromArrayLike(A):"Buffer"===A.type&&Array.isArray(A.data)?fromArrayLike(A.data):void 0}function checked(A){if(A>=M)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+M.toString(16)+" bytes");return 0|A}function SlowBuffer(A){return+A!=A&&(A=0),Buffer.alloc(+A)}function byteLength(A,S){if(Buffer.isBuffer(A))return A.length;if(ArrayBuffer.isView(A)||isInstance(A,ArrayBuffer))return A.byteLength;if("string"!=typeof A)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof A);var E=A.length,C=arguments.length>2&&!0===arguments[2];if(!C&&0===E)return 0;for(var T=!1;;)switch(S){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return utf8ToBytes(A).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*E;case"hex":return E>>>1;case"base64":return base64ToBytes(A).length;default:if(T)return C?-1:utf8ToBytes(A).length;S=(""+S).toLowerCase(),T=!0}}function slowToString(A,S,E){var C=!1;if((void 0===S||S<0)&&(S=0),S>this.length||((void 0===E||E>this.length)&&(E=this.length),E<=0||(E>>>=0)<=(S>>>=0)))return"";for(A||(A="utf8");;)switch(A){case"hex":return hexSlice(this,S,E);case"utf8":case"utf-8":return utf8Slice(this,S,E);case"ascii":return asciiSlice(this,S,E);case"latin1":case"binary":return latin1Slice(this,S,E);case"base64":return base64Slice(this,S,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,S,E);default:if(C)throw TypeError("Unknown encoding: "+A);A=(A+"").toLowerCase(),C=!0}}function swap(A,S,E){var C=A[S];A[S]=A[E],A[E]=C}function bidirectionalIndexOf(A,S,E,C,T){if(0===A.length)return -1;if("string"==typeof E?(C=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),numberIsNaN(E=+E)&&(E=T?0:A.length-1),E<0&&(E=A.length+E),E>=A.length){if(T)return -1;E=A.length-1}else if(E<0){if(!T)return -1;E=0}if("string"==typeof S&&(S=Buffer.from(S,C)),Buffer.isBuffer(S))return 0===S.length?-1:arrayIndexOf(A,S,E,C,T);if("number"==typeof S)return(S&=255,"function"==typeof Uint8Array.prototype.indexOf)?T?Uint8Array.prototype.indexOf.call(A,S,E):Uint8Array.prototype.lastIndexOf.call(A,S,E):arrayIndexOf(A,[S],E,C,T);throw TypeError("val must be string, number or Buffer")}function arrayIndexOf(A,S,E,C,T){var P,M=1,R=A.length,F=S.length;if(void 0!==C&&("ucs2"===(C=String(C).toLowerCase())||"ucs-2"===C||"utf16le"===C||"utf-16le"===C)){if(A.length<2||S.length<2)return -1;M=2,R/=2,F/=2,E/=2}function read(A,S){return 1===M?A[S]:A.readUInt16BE(S*M)}if(T){var I=-1;for(P=E;P<R;P++)if(read(A,P)===read(S,-1===I?0:P-I)){if(-1===I&&(I=P),P-I+1===F)return I*M}else -1!==I&&(P-=P-I),I=-1}else for(E+F>R&&(E=R-F),P=E;P>=0;P--){for(var D=!0,L=0;L<F;L++)if(read(A,P+L)!==read(S,L)){D=!1;break}if(D)return P}return -1}function hexWrite(A,S,E,C){E=Number(E)||0;var T=A.length-E;C?(C=Number(C))>T&&(C=T):C=T;var P=S.length;C>P/2&&(C=P/2);for(var M=0;M<C;++M){var R=parseInt(S.substr(2*M,2),16);if(numberIsNaN(R))break;A[E+M]=R}return M}function utf8Write(A,S,E,C){return blitBuffer(utf8ToBytes(S,A.length-E),A,E,C)}function asciiWrite(A,S,E,C){return blitBuffer(asciiToBytes(S),A,E,C)}function latin1Write(A,S,E,C){return asciiWrite(A,S,E,C)}function base64Write(A,S,E,C){return blitBuffer(base64ToBytes(S),A,E,C)}function ucs2Write(A,S,E,C){return blitBuffer(utf16leToBytes(S,A.length-E),A,E,C)}function base64Slice(A,S,E){return 0===S&&E===A.length?C.fromByteArray(A):C.fromByteArray(A.slice(S,E))}function utf8Slice(A,S,E){E=Math.min(A.length,E);for(var C=[],T=S;T<E;){var P,M,R,F,I=A[T],D=null,L=I>239?4:I>223?3:I>191?2:1;if(T+L<=E)switch(L){case 1:I<128&&(D=I);break;case 2:(192&(P=A[T+1]))==128&&(F=(31&I)<<6|63&P)>127&&(D=F);break;case 3:P=A[T+1],M=A[T+2],(192&P)==128&&(192&M)==128&&(F=(15&I)<<12|(63&P)<<6|63&M)>2047&&(F<55296||F>57343)&&(D=F);break;case 4:P=A[T+1],M=A[T+2],R=A[T+3],(192&P)==128&&(192&M)==128&&(192&R)==128&&(F=(15&I)<<18|(63&P)<<12|(63&M)<<6|63&R)>65535&&F<1114112&&(D=F)}null===D?(D=65533,L=1):D>65535&&(D-=65536,C.push(D>>>10&1023|55296),D=56320|1023&D),C.push(D),T+=L}return decodeCodePointsArray(C)}S.kMaxLength=M,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(A,S,E){return from(A,S,E)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(A,S,E){return alloc(A,S,E)},Buffer.allocUnsafe=function(A){return allocUnsafe(A)},Buffer.allocUnsafeSlow=function(A){return allocUnsafe(A)},Buffer.isBuffer=function(A){return null!=A&&!0===A._isBuffer&&A!==Buffer.prototype},Buffer.compare=function(A,S){if(isInstance(A,Uint8Array)&&(A=Buffer.from(A,A.offset,A.byteLength)),isInstance(S,Uint8Array)&&(S=Buffer.from(S,S.offset,S.byteLength)),!Buffer.isBuffer(A)||!Buffer.isBuffer(S))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(A===S)return 0;for(var E=A.length,C=S.length,T=0,P=Math.min(E,C);T<P;++T)if(A[T]!==S[T]){E=A[T],C=S[T];break}return E<C?-1:C<E?1:0},Buffer.isEncoding=function(A){switch(String(A).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(A,S){if(!Array.isArray(A))throw TypeError('"list" argument must be an Array of Buffers');if(0===A.length)return Buffer.alloc(0);if(void 0===S)for(E=0,S=0;E<A.length;++E)S+=A[E].length;var E,C=Buffer.allocUnsafe(S),T=0;for(E=0;E<A.length;++E){var P=A[E];if(isInstance(P,Uint8Array)&&(P=Buffer.from(P)),!Buffer.isBuffer(P))throw TypeError('"list" argument must be an Array of Buffers');P.copy(C,T),T+=P.length}return C},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var A=this.length;if(A%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var S=0;S<A;S+=2)swap(this,S,S+1);return this},Buffer.prototype.swap32=function(){var A=this.length;if(A%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var S=0;S<A;S+=4)swap(this,S,S+3),swap(this,S+1,S+2);return this},Buffer.prototype.swap64=function(){var A=this.length;if(A%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var S=0;S<A;S+=8)swap(this,S,S+7),swap(this,S+1,S+6),swap(this,S+2,S+5),swap(this,S+3,S+4);return this},Buffer.prototype.toString=function(){var A=this.length;return 0===A?"":0==arguments.length?utf8Slice(this,0,A):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(A){if(!Buffer.isBuffer(A))throw TypeError("Argument must be a Buffer");return this===A||0===Buffer.compare(this,A)},Buffer.prototype.inspect=function(){var A="",E=S.INSPECT_MAX_BYTES;return A=this.toString("hex",0,E).replace(/(.{2})/g,"$1 ").trim(),this.length>E&&(A+=" ... "),"<Buffer "+A+">"},P&&(Buffer.prototype[P]=Buffer.prototype.inspect),Buffer.prototype.compare=function(A,S,E,C,T){if(isInstance(A,Uint8Array)&&(A=Buffer.from(A,A.offset,A.byteLength)),!Buffer.isBuffer(A))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof A);if(void 0===S&&(S=0),void 0===E&&(E=A?A.length:0),void 0===C&&(C=0),void 0===T&&(T=this.length),S<0||E>A.length||C<0||T>this.length)throw RangeError("out of range index");if(C>=T&&S>=E)return 0;if(C>=T)return -1;if(S>=E)return 1;if(S>>>=0,E>>>=0,C>>>=0,T>>>=0,this===A)return 0;for(var P=T-C,M=E-S,R=Math.min(P,M),F=this.slice(C,T),I=A.slice(S,E),D=0;D<R;++D)if(F[D]!==I[D]){P=F[D],M=I[D];break}return P<M?-1:M<P?1:0},Buffer.prototype.includes=function(A,S,E){return -1!==this.indexOf(A,S,E)},Buffer.prototype.indexOf=function(A,S,E){return bidirectionalIndexOf(this,A,S,E,!0)},Buffer.prototype.lastIndexOf=function(A,S,E){return bidirectionalIndexOf(this,A,S,E,!1)},Buffer.prototype.write=function(A,S,E,C){if(void 0===S)C="utf8",E=this.length,S=0;else if(void 0===E&&"string"==typeof S)C=S,E=this.length,S=0;else if(isFinite(S))S>>>=0,isFinite(E)?(E>>>=0,void 0===C&&(C="utf8")):(C=E,E=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var T=this.length-S;if((void 0===E||E>T)&&(E=T),A.length>0&&(E<0||S<0)||S>this.length)throw RangeError("Attempt to write outside buffer bounds");C||(C="utf8");for(var P=!1;;)switch(C){case"hex":return hexWrite(this,A,S,E);case"utf8":case"utf-8":return utf8Write(this,A,S,E);case"ascii":return asciiWrite(this,A,S,E);case"latin1":case"binary":return latin1Write(this,A,S,E);case"base64":return base64Write(this,A,S,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,A,S,E);default:if(P)throw TypeError("Unknown encoding: "+C);C=(""+C).toLowerCase(),P=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function decodeCodePointsArray(A){var S=A.length;if(S<=R)return String.fromCharCode.apply(String,A);for(var E="",C=0;C<S;)E+=String.fromCharCode.apply(String,A.slice(C,C+=R));return E}function asciiSlice(A,S,E){var C="";E=Math.min(A.length,E);for(var T=S;T<E;++T)C+=String.fromCharCode(127&A[T]);return C}function latin1Slice(A,S,E){var C="";E=Math.min(A.length,E);for(var T=S;T<E;++T)C+=String.fromCharCode(A[T]);return C}function hexSlice(A,S,E){var C=A.length;(!S||S<0)&&(S=0),(!E||E<0||E>C)&&(E=C);for(var T="",P=S;P<E;++P)T+=I[A[P]];return T}function utf16leSlice(A,S,E){for(var C=A.slice(S,E),T="",P=0;P<C.length;P+=2)T+=String.fromCharCode(C[P]+256*C[P+1]);return T}function checkOffset(A,S,E){if(A%1!=0||A<0)throw RangeError("offset is not uint");if(A+S>E)throw RangeError("Trying to access beyond buffer length")}function checkInt(A,S,E,C,T,P){if(!Buffer.isBuffer(A))throw TypeError('"buffer" argument must be a Buffer instance');if(S>T||S<P)throw RangeError('"value" argument is out of bounds');if(E+C>A.length)throw RangeError("Index out of range")}function checkIEEE754(A,S,E,C,T,P){if(E+C>A.length||E<0)throw RangeError("Index out of range")}function writeFloat(A,S,E,C,P){return S=+S,E>>>=0,P||checkIEEE754(A,S,E,4,34028234663852886e22,-34028234663852886e22),T.write(A,S,E,C,23,4),E+4}function writeDouble(A,S,E,C,P){return S=+S,E>>>=0,P||checkIEEE754(A,S,E,8,17976931348623157e292,-17976931348623157e292),T.write(A,S,E,C,52,8),E+8}Buffer.prototype.slice=function(A,S){var E=this.length;A=~~A,S=void 0===S?E:~~S,A<0?(A+=E)<0&&(A=0):A>E&&(A=E),S<0?(S+=E)<0&&(S=0):S>E&&(S=E),S<A&&(S=A);var C=this.subarray(A,S);return Object.setPrototypeOf(C,Buffer.prototype),C},Buffer.prototype.readUIntLE=function(A,S,E){A>>>=0,S>>>=0,E||checkOffset(A,S,this.length);for(var C=this[A],T=1,P=0;++P<S&&(T*=256);)C+=this[A+P]*T;return C},Buffer.prototype.readUIntBE=function(A,S,E){A>>>=0,S>>>=0,E||checkOffset(A,S,this.length);for(var C=this[A+--S],T=1;S>0&&(T*=256);)C+=this[A+--S]*T;return C},Buffer.prototype.readUInt8=function(A,S){return A>>>=0,S||checkOffset(A,1,this.length),this[A]},Buffer.prototype.readUInt16LE=function(A,S){return A>>>=0,S||checkOffset(A,2,this.length),this[A]|this[A+1]<<8},Buffer.prototype.readUInt16BE=function(A,S){return A>>>=0,S||checkOffset(A,2,this.length),this[A]<<8|this[A+1]},Buffer.prototype.readUInt32LE=function(A,S){return A>>>=0,S||checkOffset(A,4,this.length),(this[A]|this[A+1]<<8|this[A+2]<<16)+16777216*this[A+3]},Buffer.prototype.readUInt32BE=function(A,S){return A>>>=0,S||checkOffset(A,4,this.length),16777216*this[A]+(this[A+1]<<16|this[A+2]<<8|this[A+3])},Buffer.prototype.readIntLE=function(A,S,E){A>>>=0,S>>>=0,E||checkOffset(A,S,this.length);for(var C=this[A],T=1,P=0;++P<S&&(T*=256);)C+=this[A+P]*T;return C>=(T*=128)&&(C-=Math.pow(2,8*S)),C},Buffer.prototype.readIntBE=function(A,S,E){A>>>=0,S>>>=0,E||checkOffset(A,S,this.length);for(var C=S,T=1,P=this[A+--C];C>0&&(T*=256);)P+=this[A+--C]*T;return P>=(T*=128)&&(P-=Math.pow(2,8*S)),P},Buffer.prototype.readInt8=function(A,S){return(A>>>=0,S||checkOffset(A,1,this.length),128&this[A])?-((255-this[A]+1)*1):this[A]},Buffer.prototype.readInt16LE=function(A,S){A>>>=0,S||checkOffset(A,2,this.length);var E=this[A]|this[A+1]<<8;return 32768&E?4294901760|E:E},Buffer.prototype.readInt16BE=function(A,S){A>>>=0,S||checkOffset(A,2,this.length);var E=this[A+1]|this[A]<<8;return 32768&E?4294901760|E:E},Buffer.prototype.readInt32LE=function(A,S){return A>>>=0,S||checkOffset(A,4,this.length),this[A]|this[A+1]<<8|this[A+2]<<16|this[A+3]<<24},Buffer.prototype.readInt32BE=function(A,S){return A>>>=0,S||checkOffset(A,4,this.length),this[A]<<24|this[A+1]<<16|this[A+2]<<8|this[A+3]},Buffer.prototype.readFloatLE=function(A,S){return A>>>=0,S||checkOffset(A,4,this.length),T.read(this,A,!0,23,4)},Buffer.prototype.readFloatBE=function(A,S){return A>>>=0,S||checkOffset(A,4,this.length),T.read(this,A,!1,23,4)},Buffer.prototype.readDoubleLE=function(A,S){return A>>>=0,S||checkOffset(A,8,this.length),T.read(this,A,!0,52,8)},Buffer.prototype.readDoubleBE=function(A,S){return A>>>=0,S||checkOffset(A,8,this.length),T.read(this,A,!1,52,8)},Buffer.prototype.writeUIntLE=function(A,S,E,C){if(A=+A,S>>>=0,E>>>=0,!C){var T=Math.pow(2,8*E)-1;checkInt(this,A,S,E,T,0)}var P=1,M=0;for(this[S]=255&A;++M<E&&(P*=256);)this[S+M]=A/P&255;return S+E},Buffer.prototype.writeUIntBE=function(A,S,E,C){if(A=+A,S>>>=0,E>>>=0,!C){var T=Math.pow(2,8*E)-1;checkInt(this,A,S,E,T,0)}var P=E-1,M=1;for(this[S+P]=255&A;--P>=0&&(M*=256);)this[S+P]=A/M&255;return S+E},Buffer.prototype.writeUInt8=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,1,255,0),this[S]=255&A,S+1},Buffer.prototype.writeUInt16LE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,2,65535,0),this[S]=255&A,this[S+1]=A>>>8,S+2},Buffer.prototype.writeUInt16BE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,2,65535,0),this[S]=A>>>8,this[S+1]=255&A,S+2},Buffer.prototype.writeUInt32LE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,4,4294967295,0),this[S+3]=A>>>24,this[S+2]=A>>>16,this[S+1]=A>>>8,this[S]=255&A,S+4},Buffer.prototype.writeUInt32BE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,4,4294967295,0),this[S]=A>>>24,this[S+1]=A>>>16,this[S+2]=A>>>8,this[S+3]=255&A,S+4},Buffer.prototype.writeIntLE=function(A,S,E,C){if(A=+A,S>>>=0,!C){var T=Math.pow(2,8*E-1);checkInt(this,A,S,E,T-1,-T)}var P=0,M=1,R=0;for(this[S]=255&A;++P<E&&(M*=256);)A<0&&0===R&&0!==this[S+P-1]&&(R=1),this[S+P]=(A/M>>0)-R&255;return S+E},Buffer.prototype.writeIntBE=function(A,S,E,C){if(A=+A,S>>>=0,!C){var T=Math.pow(2,8*E-1);checkInt(this,A,S,E,T-1,-T)}var P=E-1,M=1,R=0;for(this[S+P]=255&A;--P>=0&&(M*=256);)A<0&&0===R&&0!==this[S+P+1]&&(R=1),this[S+P]=(A/M>>0)-R&255;return S+E},Buffer.prototype.writeInt8=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,1,127,-128),A<0&&(A=255+A+1),this[S]=255&A,S+1},Buffer.prototype.writeInt16LE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,2,32767,-32768),this[S]=255&A,this[S+1]=A>>>8,S+2},Buffer.prototype.writeInt16BE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,2,32767,-32768),this[S]=A>>>8,this[S+1]=255&A,S+2},Buffer.prototype.writeInt32LE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,4,2147483647,-2147483648),this[S]=255&A,this[S+1]=A>>>8,this[S+2]=A>>>16,this[S+3]=A>>>24,S+4},Buffer.prototype.writeInt32BE=function(A,S,E){return A=+A,S>>>=0,E||checkInt(this,A,S,4,2147483647,-2147483648),A<0&&(A=4294967295+A+1),this[S]=A>>>24,this[S+1]=A>>>16,this[S+2]=A>>>8,this[S+3]=255&A,S+4},Buffer.prototype.writeFloatLE=function(A,S,E){return writeFloat(this,A,S,!0,E)},Buffer.prototype.writeFloatBE=function(A,S,E){return writeFloat(this,A,S,!1,E)},Buffer.prototype.writeDoubleLE=function(A,S,E){return writeDouble(this,A,S,!0,E)},Buffer.prototype.writeDoubleBE=function(A,S,E){return writeDouble(this,A,S,!1,E)},Buffer.prototype.copy=function(A,S,E,C){if(!Buffer.isBuffer(A))throw TypeError("argument should be a Buffer");if(E||(E=0),C||0===C||(C=this.length),S>=A.length&&(S=A.length),S||(S=0),C>0&&C<E&&(C=E),C===E||0===A.length||0===this.length)return 0;if(S<0)throw RangeError("targetStart out of bounds");if(E<0||E>=this.length)throw RangeError("Index out of range");if(C<0)throw RangeError("sourceEnd out of bounds");C>this.length&&(C=this.length),A.length-S<C-E&&(C=A.length-S+E);var T=C-E;if(this===A&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(S,E,C);else if(this===A&&E<S&&S<C)for(var P=T-1;P>=0;--P)A[P+S]=this[P+E];else Uint8Array.prototype.set.call(A,this.subarray(E,C),S);return T},Buffer.prototype.fill=function(A,S,E,C){if("string"==typeof A){if("string"==typeof S?(C=S,S=0,E=this.length):"string"==typeof E&&(C=E,E=this.length),void 0!==C&&"string"!=typeof C)throw TypeError("encoding must be a string");if("string"==typeof C&&!Buffer.isEncoding(C))throw TypeError("Unknown encoding: "+C);if(1===A.length){var T,P=A.charCodeAt(0);("utf8"===C&&P<128||"latin1"===C)&&(A=P)}}else"number"==typeof A?A&=255:"boolean"==typeof A&&(A=Number(A));if(S<0||this.length<S||this.length<E)throw RangeError("Out of range index");if(E<=S)return this;if(S>>>=0,E=void 0===E?this.length:E>>>0,A||(A=0),"number"==typeof A)for(T=S;T<E;++T)this[T]=A;else{var M=Buffer.isBuffer(A)?A:Buffer.from(A,C),R=M.length;if(0===R)throw TypeError('The value "'+A+'" is invalid for argument "value"');for(T=0;T<E-S;++T)this[T+S]=M[T%R]}return this};var F=/[^+/0-9A-Za-z-_]/g;function base64clean(A){if((A=(A=A.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;A.length%4!=0;)A+="=";return A}function utf8ToBytes(A,S){S=S||1/0;for(var E,C=A.length,T=null,P=[],M=0;M<C;++M){if((E=A.charCodeAt(M))>55295&&E<57344){if(!T){if(E>56319||M+1===C){(S-=3)>-1&&P.push(239,191,189);continue}T=E;continue}if(E<56320){(S-=3)>-1&&P.push(239,191,189),T=E;continue}E=(T-55296<<10|E-56320)+65536}else T&&(S-=3)>-1&&P.push(239,191,189);if(T=null,E<128){if((S-=1)<0)break;P.push(E)}else if(E<2048){if((S-=2)<0)break;P.push(E>>6|192,63&E|128)}else if(E<65536){if((S-=3)<0)break;P.push(E>>12|224,E>>6&63|128,63&E|128)}else if(E<1114112){if((S-=4)<0)break;P.push(E>>18|240,E>>12&63|128,E>>6&63|128,63&E|128)}else throw Error("Invalid code point")}return P}function asciiToBytes(A){for(var S=[],E=0;E<A.length;++E)S.push(255&A.charCodeAt(E));return S}function utf16leToBytes(A,S){for(var E,C,T=[],P=0;P<A.length&&!((S-=2)<0);++P)C=(E=A.charCodeAt(P))>>8,T.push(E%256),T.push(C);return T}function base64ToBytes(A){return C.toByteArray(base64clean(A))}function blitBuffer(A,S,E,C){for(var T=0;T<C&&!(T+E>=S.length)&&!(T>=A.length);++T)S[T+E]=A[T];return T}function isInstance(A,S){return A instanceof S||null!=A&&null!=A.constructor&&null!=A.constructor.name&&A.constructor.name===S.name}function numberIsNaN(A){return A!=A}var I=function(){for(var A="0123456789abcdef",S=Array(256),E=0;E<16;++E)for(var C=16*E,T=0;T<16;++T)S[C+T]=A[E]+A[T];return S}()},783:function(A,S){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */S.read=function(A,S,E,C,T){var P,M,R=8*T-C-1,F=(1<<R)-1,I=F>>1,D=-7,L=E?T-1:0,O=E?-1:1,B=A[S+L];for(L+=O,P=B&(1<<-D)-1,B>>=-D,D+=R;D>0;P=256*P+A[S+L],L+=O,D-=8);for(M=P&(1<<-D)-1,P>>=-D,D+=C;D>0;M=256*M+A[S+L],L+=O,D-=8);if(0===P)P=1-I;else{if(P===F)return M?NaN:(B?-1:1)*(1/0);M+=Math.pow(2,C),P-=I}return(B?-1:1)*M*Math.pow(2,P-C)},S.write=function(A,S,E,C,T,P){var M,R,F,I=8*P-T-1,D=(1<<I)-1,L=D>>1,O=23===T?5960464477539062e-23:0,B=C?0:P-1,N=C?1:-1,U=S<0||0===S&&1/S<0?1:0;for(isNaN(S=Math.abs(S))||S===1/0?(R=isNaN(S)?1:0,M=D):(M=Math.floor(Math.log(S)/Math.LN2),S*(F=Math.pow(2,-M))<1&&(M--,F*=2),M+L>=1?S+=O/F:S+=O*Math.pow(2,1-L),S*F>=2&&(M++,F/=2),M+L>=D?(R=0,M=D):M+L>=1?(R=(S*F-1)*Math.pow(2,T),M+=L):(R=S*Math.pow(2,L-1)*Math.pow(2,T),M=0));T>=8;A[E+B]=255&R,B+=N,R/=256,T-=8);for(M=M<<T|R,I+=T;I>0;A[E+B]=255&M,B+=N,M/=256,I-=8);A[E+B-N]|=128*U}}},C={};function __nccwpck_require__(A){var S=C[A];if(void 0!==S)return S.exports;var T=C[A]={exports:{}},P=!0;try{E[A](T,T.exports,__nccwpck_require__),P=!1}finally{P&&delete C[A]}return T.exports}__nccwpck_require__.ab=S+"/";var T=__nccwpck_require__(72);A.exports=T}()},7663:function(A){var S="/";!function(){var E={229:function(A){var S,E,C,T=A.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(A){if(S===setTimeout)return setTimeout(A,0);if((S===defaultSetTimout||!S)&&setTimeout)return S=setTimeout,setTimeout(A,0);try{return S(A,0)}catch(E){try{return S.call(null,A,0)}catch(E){return S.call(this,A,0)}}}function runClearTimeout(A){if(E===clearTimeout)return clearTimeout(A);if((E===defaultClearTimeout||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(A);try{return E(A)}catch(S){try{return E.call(null,A)}catch(S){return E.call(this,A)}}}!function(){try{S="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(A){S=defaultSetTimout}try{E="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(A){E=defaultClearTimeout}}();var P=[],M=!1,R=-1;function cleanUpNextTick(){M&&C&&(M=!1,C.length?P=C.concat(P):R=-1,P.length&&drainQueue())}function drainQueue(){if(!M){var A=runTimeout(cleanUpNextTick);M=!0;for(var S=P.length;S;){for(C=P,P=[];++R<S;)C&&C[R].run();R=-1,S=P.length}C=null,M=!1,runClearTimeout(A)}}function Item(A,S){this.fun=A,this.array=S}function noop(){}T.nextTick=function(A){var S=Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)S[E-1]=arguments[E];P.push(new Item(A,S)),1!==P.length||M||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=noop,T.addListener=noop,T.once=noop,T.off=noop,T.removeListener=noop,T.removeAllListeners=noop,T.emit=noop,T.prependListener=noop,T.prependOnceListener=noop,T.listeners=function(A){return[]},T.binding=function(A){throw Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(A){throw Error("process.chdir is not supported")},T.umask=function(){return 0}}},C={};function __nccwpck_require__(A){var S=C[A];if(void 0!==S)return S.exports;var T=C[A]={exports:{}},P=!0;try{E[A](T,T.exports,__nccwpck_require__),P=!1}finally{P&&delete C[A]}return T.exports}__nccwpck_require__.ab=S+"/";var T=__nccwpck_require__(229);A.exports=T}()},9299:function(module,__unused_webpack_exports,__webpack_require__){var process=__webpack_require__(3454),Buffer=__webpack_require__(1876).Buffer;/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2023 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */!function(A,S){module.exports=A.pdfjsLib=S()}(globalThis,()=>(()=>{"use strict";var __webpack_modules__=[,(A,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.VerbosityLevel=S.Util=S.UnknownErrorException=S.UnexpectedResponseException=S.TextRenderingMode=S.RenderingIntentFlag=S.PromiseCapability=S.PermissionFlag=S.PasswordResponses=S.PasswordException=S.PageActionEventType=S.OPS=S.MissingPDFException=S.MAX_IMAGE_SIZE_TO_CACHE=S.LINE_FACTOR=S.LINE_DESCENT_FACTOR=S.InvalidPDFException=S.ImageKind=S.IDENTITY_MATRIX=S.FormatError=S.FeatureTest=S.FONT_IDENTITY_MATRIX=S.DocumentActionEventType=S.CMapCompressionType=S.BaseException=S.BASELINE_FACTOR=S.AnnotationType=S.AnnotationReplyType=S.AnnotationPrefix=S.AnnotationMode=S.AnnotationFlag=S.AnnotationFieldFlag=S.AnnotationEditorType=S.AnnotationEditorPrefix=S.AnnotationEditorParamsType=S.AnnotationBorderStyleType=S.AnnotationActionEventType=S.AbortException=void 0,S.assert=assert,S.bytesToString=bytesToString,S.createValidAbsoluteUrl=createValidAbsoluteUrl,S.getModificationDate=getModificationDate,S.getUuid=getUuid,S.getVerbosityLevel=getVerbosityLevel,S.info=info,S.isArrayBuffer=isArrayBuffer,S.isArrayEqual=isArrayEqual,S.isNodeJS=void 0,S.normalizeUnicode=normalizeUnicode,S.objectFromMap=objectFromMap,S.objectSize=objectSize,S.setVerbosityLevel=setVerbosityLevel,S.shadow=shadow,S.string32=string32,S.stringToBytes=stringToBytes,S.stringToPDFString=stringToPDFString,S.stringToUTF8String=stringToUTF8String,S.unreachable=unreachable,S.utf8StringToString=utf8StringToString,S.warn=warn;let E="object"==typeof process&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type);S.isNodeJS=E;let C=[1,0,0,1,0,0];S.IDENTITY_MATRIX=C;let T=[.001,0,0,.001,0,0];S.FONT_IDENTITY_MATRIX=T;let P=1e7;S.MAX_IMAGE_SIZE_TO_CACHE=P;let M=1.35;S.LINE_FACTOR=M;let R=.35;S.LINE_DESCENT_FACTOR=R;let F=R/M;S.BASELINE_FACTOR=F;let I={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};S.RenderingIntentFlag=I;let D={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};S.AnnotationMode=D;let L="pdfjs_internal_editor_";S.AnnotationEditorPrefix=L;let O={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};S.AnnotationEditorType=O;let B={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};S.AnnotationEditorParamsType=B;let N={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};S.PermissionFlag=N;let U={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};S.TextRenderingMode=U;let z={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};S.ImageKind=z;let H={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};S.AnnotationType=H;let W={GROUP:"Group",REPLY:"R"};S.AnnotationReplyType=W;let V={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};S.AnnotationFlag=V;let $={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};S.AnnotationFieldFlag=$;let X={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};S.AnnotationBorderStyleType=X;let K={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};S.AnnotationActionEventType=K;let Y={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};S.DocumentActionEventType=Y;let J={O:"PageOpen",C:"PageClose"};S.PageActionEventType=J;let Q={ERRORS:0,WARNINGS:1,INFOS:5};S.VerbosityLevel=Q;let Z={NONE:0,BINARY:1};S.CMapCompressionType=Z;let tt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};S.OPS=tt;let te={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};S.PasswordResponses=te;let ti=Q.WARNINGS;function setVerbosityLevel(A){Number.isInteger(A)&&(ti=A)}function getVerbosityLevel(){return ti}function info(A){ti>=Q.INFOS&&console.log(`Info: ${A}`)}function warn(A){ti>=Q.WARNINGS&&console.log(`Warning: ${A}`)}function unreachable(A){throw Error(A)}function assert(A,S){A||unreachable(S)}function _isValidProtocol(A){switch(A?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function createValidAbsoluteUrl(A,S=null,E=null){if(!A)return null;try{if(E&&"string"==typeof A){if(E.addDefaultProtocol&&A.startsWith("www.")){let S=A.match(/\./g);S?.length>=2&&(A=`http://${A}`)}if(E.tryConvertEncoding)try{A=stringToUTF8String(A)}catch{}}let C=S?new URL(A,S):new URL(A);if(_isValidProtocol(C))return C}catch{}return null}function shadow(A,S,E,C=!1){return Object.defineProperty(A,S,{value:E,enumerable:!C,configurable:!0,writable:!1}),E}let tr=function(){function BaseException(A,S){this.constructor===BaseException&&unreachable("Cannot initialize BaseException."),this.message=A,this.name=S}return BaseException.prototype=Error(),BaseException.constructor=BaseException,BaseException}();S.BaseException=tr;let PasswordException=class PasswordException extends tr{constructor(A,S){super(A,"PasswordException"),this.code=S}};S.PasswordException=PasswordException;let UnknownErrorException=class UnknownErrorException extends tr{constructor(A,S){super(A,"UnknownErrorException"),this.details=S}};S.UnknownErrorException=UnknownErrorException;let InvalidPDFException=class InvalidPDFException extends tr{constructor(A){super(A,"InvalidPDFException")}};S.InvalidPDFException=InvalidPDFException;let MissingPDFException=class MissingPDFException extends tr{constructor(A){super(A,"MissingPDFException")}};S.MissingPDFException=MissingPDFException;let UnexpectedResponseException=class UnexpectedResponseException extends tr{constructor(A,S){super(A,"UnexpectedResponseException"),this.status=S}};S.UnexpectedResponseException=UnexpectedResponseException;let FormatError=class FormatError extends tr{constructor(A){super(A,"FormatError")}};S.FormatError=FormatError;let AbortException=class AbortException extends tr{constructor(A){super(A,"AbortException")}};function bytesToString(A){("object"!=typeof A||A?.length===void 0)&&unreachable("Invalid argument for bytesToString");let S=A.length,E=8192;if(S<E)return String.fromCharCode.apply(null,A);let C=[];for(let T=0;T<S;T+=E){let P=Math.min(T+E,S),M=A.subarray(T,P);C.push(String.fromCharCode.apply(null,M))}return C.join("")}function stringToBytes(A){"string"!=typeof A&&unreachable("Invalid argument for stringToBytes");let S=A.length,E=new Uint8Array(S);for(let C=0;C<S;++C)E[C]=255&A.charCodeAt(C);return E}function string32(A){return String.fromCharCode(A>>24&255,A>>16&255,A>>8&255,255&A)}function objectSize(A){return Object.keys(A).length}function objectFromMap(A){let S=Object.create(null);for(let[E,C]of A)S[E]=C;return S}function isLittleEndian(){let A=new Uint8Array(4);A[0]=1;let S=new Uint32Array(A.buffer,0,1);return 1===S[0]}function isEvalSupported(){try{return Function(""),!0}catch{return!1}}S.AbortException=AbortException;let FeatureTest=class FeatureTest{static get isLittleEndian(){return shadow(this,"isLittleEndian",isLittleEndian())}static get isEvalSupported(){return shadow(this,"isEvalSupported",isEvalSupported())}static get isOffscreenCanvasSupported(){return shadow(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"==typeof navigator?shadow(this,"platform",{isWin:!1,isMac:!1}):shadow(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return shadow(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}};S.FeatureTest=FeatureTest;let tn=[...Array(256).keys()].map(A=>A.toString(16).padStart(2,"0"));let Util=class Util{static makeHexColor(A,S,E){return`#${tn[A]}${tn[S]}${tn[E]}`}static scaleMinMax(A,S){let E;A[0]?(A[0]<0&&(E=S[0],S[0]=S[1],S[1]=E),S[0]*=A[0],S[1]*=A[0],A[3]<0&&(E=S[2],S[2]=S[3],S[3]=E),S[2]*=A[3],S[3]*=A[3]):(E=S[0],S[0]=S[2],S[2]=E,E=S[1],S[1]=S[3],S[3]=E,A[1]<0&&(E=S[2],S[2]=S[3],S[3]=E),S[2]*=A[1],S[3]*=A[1],A[2]<0&&(E=S[0],S[0]=S[1],S[1]=E),S[0]*=A[2],S[1]*=A[2]),S[0]+=A[4],S[1]+=A[4],S[2]+=A[5],S[3]+=A[5]}static transform(A,S){return[A[0]*S[0]+A[2]*S[1],A[1]*S[0]+A[3]*S[1],A[0]*S[2]+A[2]*S[3],A[1]*S[2]+A[3]*S[3],A[0]*S[4]+A[2]*S[5]+A[4],A[1]*S[4]+A[3]*S[5]+A[5]]}static applyTransform(A,S){let E=A[0]*S[0]+A[1]*S[2]+S[4],C=A[0]*S[1]+A[1]*S[3]+S[5];return[E,C]}static applyInverseTransform(A,S){let E=S[0]*S[3]-S[1]*S[2],C=(A[0]*S[3]-A[1]*S[2]+S[2]*S[5]-S[4]*S[3])/E,T=(-A[0]*S[1]+A[1]*S[0]+S[4]*S[1]-S[5]*S[0])/E;return[C,T]}static getAxialAlignedBoundingBox(A,S){let E=this.applyTransform(A,S),C=this.applyTransform(A.slice(2,4),S),T=this.applyTransform([A[0],A[3]],S),P=this.applyTransform([A[2],A[1]],S);return[Math.min(E[0],C[0],T[0],P[0]),Math.min(E[1],C[1],T[1],P[1]),Math.max(E[0],C[0],T[0],P[0]),Math.max(E[1],C[1],T[1],P[1])]}static inverseTransform(A){let S=A[0]*A[3]-A[1]*A[2];return[A[3]/S,-A[1]/S,-A[2]/S,A[0]/S,(A[2]*A[5]-A[4]*A[3])/S,(A[4]*A[1]-A[5]*A[0])/S]}static singularValueDecompose2dScale(A){let S=[A[0],A[2],A[1],A[3]],E=A[0]*S[0]+A[1]*S[2],C=A[0]*S[1]+A[1]*S[3],T=A[2]*S[0]+A[3]*S[2],P=A[2]*S[1]+A[3]*S[3],M=(E+P)/2,R=Math.sqrt((E+P)**2-4*(E*P-T*C))/2,F=M+R||1,I=M-R||1;return[Math.sqrt(F),Math.sqrt(I)]}static normalizeRect(A){let S=A.slice(0);return A[0]>A[2]&&(S[0]=A[2],S[2]=A[0]),A[1]>A[3]&&(S[1]=A[3],S[3]=A[1]),S}static intersect(A,S){let E=Math.max(Math.min(A[0],A[2]),Math.min(S[0],S[2])),C=Math.min(Math.max(A[0],A[2]),Math.max(S[0],S[2]));if(E>C)return null;let T=Math.max(Math.min(A[1],A[3]),Math.min(S[1],S[3])),P=Math.min(Math.max(A[1],A[3]),Math.max(S[1],S[3]));return T>P?null:[E,T,C,P]}static bezierBoundingBox(A,S,E,C,T,P,M,R){let F,I,D,L,O,B,N,U;let z=[],H=[[],[]];for(let H=0;H<2;++H){if(0===H?(I=6*A-12*E+6*T,F=-3*A+9*E-9*T+3*M,D=3*E-3*A):(I=6*S-12*C+6*P,F=-3*S+9*C-9*P+3*R,D=3*C-3*S),1e-12>Math.abs(F)){if(1e-12>Math.abs(I))continue;0<(L=-D/I)&&L<1&&z.push(L);continue}U=Math.sqrt(N=I*I-4*D*F),!(N<0)&&(0<(O=(-I+U)/(2*F))&&O<1&&z.push(O),0<(B=(-I-U)/(2*F))&&B<1&&z.push(B))}let W=z.length,V,$=W;for(;W--;)V=1-(L=z[W]),H[0][W]=V*V*V*A+3*V*V*L*E+3*V*L*L*T+L*L*L*M,H[1][W]=V*V*V*S+3*V*V*L*C+3*V*L*L*P+L*L*L*R;return H[0][$]=A,H[1][$]=S,H[0][$+1]=M,H[1][$+1]=R,H[0].length=H[1].length=$+2,[Math.min(...H[0]),Math.min(...H[1]),Math.max(...H[0]),Math.max(...H[1])]}};S.Util=Util;let ts=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function stringToPDFString(A){if(A[0]>="\xef"){let S;if("\xfe"===A[0]&&"\xff"===A[1]?S="utf-16be":"\xff"===A[0]&&"\xfe"===A[1]?S="utf-16le":"\xef"===A[0]&&"\xbb"===A[1]&&"\xbf"===A[2]&&(S="utf-8"),S)try{let E=new TextDecoder(S,{fatal:!0}),C=stringToBytes(A);return E.decode(C)}catch(A){warn(`stringToPDFString: "${A}".`)}}let S=[];for(let E=0,C=A.length;E<C;E++){let C=ts[A.charCodeAt(E)];S.push(C?String.fromCharCode(C):A.charAt(E))}return S.join("")}function stringToUTF8String(A){return decodeURIComponent(escape(A))}function utf8StringToString(A){return unescape(encodeURIComponent(A))}function isArrayBuffer(A){return"object"==typeof A&&A?.byteLength!==void 0}function isArrayEqual(A,S){if(A.length!==S.length)return!1;for(let E=0,C=A.length;E<C;E++)if(A[E]!==S[E])return!1;return!0}function getModificationDate(A=new Date){let S=[A.getUTCFullYear().toString(),(A.getUTCMonth()+1).toString().padStart(2,"0"),A.getUTCDate().toString().padStart(2,"0"),A.getUTCHours().toString().padStart(2,"0"),A.getUTCMinutes().toString().padStart(2,"0"),A.getUTCSeconds().toString().padStart(2,"0")];return S.join("")}let PromiseCapability=class PromiseCapability{#t=!1;constructor(){this.promise=new Promise((A,S)=>{this.resolve=S=>{this.#t=!0,A(S)},this.reject=A=>{this.#t=!0,S(A)}})}get settled(){return this.#t}};S.PromiseCapability=PromiseCapability;let ta=null,to=null;function normalizeUnicode(A){return ta||(ta=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,to=new Map([["ﬅ","ſt"]])),A.replaceAll(ta,(A,S,E)=>S?S.normalize("NFKC"):to.get(E))}function getUuid(){if("undefined"!=typeof crypto&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();let A=new Uint8Array(32);if("undefined"!=typeof crypto&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(A);else for(let S=0;S<32;S++)A[S]=Math.floor(255*Math.random());return bytesToString(A)}let tl="pdfjs_internal_id_";S.AnnotationPrefix=tl},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);let DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;function getDocument(A){if("string"==typeof A||A instanceof URL?A={url:A}:(0,_util.isArrayBuffer)(A)&&(A={data:A}),"object"!=typeof A)throw Error("Invalid parameter in getDocument, need parameter object.");if(!A.url&&!A.data&&!A.range)throw Error("Invalid parameter object: need either .data, .range or .url");let S=new PDFDocumentLoadingTask,{docId:E}=S,C=A.url?getUrlProp(A.url):null,T=A.data?getDataProp(A.data):null,P=A.httpHeaders||null,M=!0===A.withCredentials,R=A.password??null,F=A.range instanceof PDFDataRangeTransport?A.range:null,I=Number.isInteger(A.rangeChunkSize)&&A.rangeChunkSize>0?A.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,D=A.worker instanceof PDFWorker?A.worker:null,L=A.verbosity,O="string"!=typeof A.docBaseUrl||(0,_display_utils.isDataScheme)(A.docBaseUrl)?null:A.docBaseUrl,B="string"==typeof A.cMapUrl?A.cMapUrl:null,N=!1!==A.cMapPacked,U=A.CMapReaderFactory||DefaultCMapReaderFactory,z="string"==typeof A.standardFontDataUrl?A.standardFontDataUrl:null,H=A.StandardFontDataFactory||DefaultStandardFontDataFactory,W=!0!==A.stopAtErrors,V=Number.isInteger(A.maxImageSize)&&A.maxImageSize>-1?A.maxImageSize:-1,$=!1!==A.isEvalSupported,X="boolean"==typeof A.isOffscreenCanvasSupported?A.isOffscreenCanvasSupported:!_util.isNodeJS,K=Number.isInteger(A.canvasMaxAreaInBytes)?A.canvasMaxAreaInBytes:-1,Y="boolean"==typeof A.disableFontFace?A.disableFontFace:_util.isNodeJS,J=!0===A.fontExtraProperties,Q=!0===A.enableXfa,Z=A.ownerDocument||globalThis.document,tt=!0===A.disableRange,te=!0===A.disableStream,ti=!0===A.disableAutoFetch,tr=!0===A.pdfBug,tn=F?F.length:A.length??NaN,ts="boolean"==typeof A.useSystemFonts?A.useSystemFonts:!_util.isNodeJS&&!Y,ta="boolean"==typeof A.useWorkerFetch?A.useWorkerFetch:U===_display_utils.DOMCMapReaderFactory&&H===_display_utils.DOMStandardFontDataFactory&&B&&z&&(0,_display_utils.isValidFetchUrl)(B,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(z,document.baseURI),to=A.canvasFactory||new DefaultCanvasFactory({ownerDocument:Z}),tl=A.filterFactory||new DefaultFilterFactory({docId:E,ownerDocument:Z}),th=null;(0,_util.setVerbosityLevel)(L);let td={canvasFactory:to,filterFactory:tl};if(ta||(td.cMapReaderFactory=new U({baseUrl:B,isCompressed:N}),td.standardFontDataFactory=new H({baseUrl:z})),!D){let A={verbosity:L,port:_worker_options.GlobalWorkerOptions.workerPort};D=A.port?PDFWorker.fromPort(A):new PDFWorker(A),S._worker=D}let tc={docId:E,apiVersion:"3.11.174",data:T,password:R,disableAutoFetch:ti,rangeChunkSize:I,length:tn,docBaseUrl:O,enableXfa:Q,evaluatorOptions:{maxImageSize:V,disableFontFace:Y,ignoreErrors:W,isEvalSupported:$,isOffscreenCanvasSupported:X,canvasMaxAreaInBytes:K,fontExtraProperties:J,useSystemFonts:ts,cMapUrl:ta?B:null,standardFontDataUrl:ta?z:null}},tu={ignoreErrors:W,isEvalSupported:$,disableFontFace:Y,fontExtraProperties:J,enableXfa:Q,ownerDocument:Z,disableAutoFetch:ti,pdfBug:tr,styleElement:th};return D.promise.then(function(){if(S.destroyed)throw Error("Loading aborted");let A=_fetchDocument(D,tc),R=new Promise(function(A){let S;if(F)S=new _transport_stream.PDFDataTransportStream({length:tn,initialData:F.initialData,progressiveDone:F.progressiveDone,contentDispositionFilename:F.contentDispositionFilename,disableRange:tt,disableStream:te},F);else if(!T){let createPDFNetworkStream=A=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(A):(0,_display_utils.isValidFetchUrl)(A.url)?new _displayFetch_stream.PDFFetchStream(A):new _displayNetwork.PDFNetworkStream(A);S=createPDFNetworkStream({url:C,length:tn,httpHeaders:P,withCredentials:M,rangeChunkSize:I,disableRange:tt,disableStream:te})}A(S)});return Promise.all([A,R]).then(function([A,C]){if(S.destroyed)throw Error("Loading aborted");let T=new _message_handler.MessageHandler(E,A,D.port),P=new WorkerTransport(T,S,C,tu,td);S._transport=P,T.send("Ready",null)})}).catch(S._capability.reject),S}async function _fetchDocument(A,S){if(A.destroyed)throw Error("Worker was destroyed");let E=await A.messageHandler.sendWithPromise("GetDocRequest",S,S.data?[S.data.buffer]:null);if(A.destroyed)throw Error("Worker was destroyed");return E}function getUrlProp(A){if(A instanceof URL)return A.href;try{return new URL(A,window.location).href}catch{if(_util.isNodeJS&&"string"==typeof A)return A}throw Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(A){if(_util.isNodeJS&&void 0!==Buffer&&A instanceof Buffer)throw Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength)return A;if("string"==typeof A)return(0,_util.stringToBytes)(A);if("object"==typeof A&&!isNaN(A?.length)||(0,_util.isArrayBuffer)(A))return new Uint8Array(A);throw Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;let PDFDocumentLoadingTask=class PDFDocumentLoadingTask{static #e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(A){throw this._worker?.port&&delete this._worker._pendingDestroy,A}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;let PDFDataRangeTransport=class PDFDataRangeTransport{constructor(A,S,E=!1,C=null){this.length=A,this.initialData=S,this.progressiveDone=E,this.contentDispositionFilename=C,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(A){this._rangeListeners.push(A)}addProgressListener(A){this._progressListeners.push(A)}addProgressiveReadListener(A){this._progressiveReadListeners.push(A)}addProgressiveDoneListener(A){this._progressiveDoneListeners.push(A)}onDataRange(A,S){for(let E of this._rangeListeners)E(A,S)}onDataProgress(A,S){this._readyCapability.promise.then(()=>{for(let E of this._progressListeners)E(A,S)})}onDataProgressiveRead(A){this._readyCapability.promise.then(()=>{for(let S of this._progressiveReadListeners)S(A)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let A of this._progressiveDoneListeners)A()})}transportReady(){this._readyCapability.resolve()}requestDataRange(A,S){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};exports.PDFDataRangeTransport=PDFDataRangeTransport;let PDFDocumentProxy=class PDFDocumentProxy{constructor(A,S){this._pdfInfo=A,this._transport=S,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(A=>{if(!A)return A;let S=[];for(let E in A)S.push(...A[E]);return S}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(A){return this._transport.getPage(A)}getPageIndex(A){return this._transport.getPageIndex(A)}getDestinations(){return this._transport.getDestinations()}getDestination(A){return this._transport.getDestination(A)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(A=!1){return this._transport.startCleanup(A||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}};exports.PDFDocumentProxy=PDFDocumentProxy;let PDFPageProxy=class PDFPageProxy{#i=null;#r=!1;constructor(A,S,E,C=!1){this._pageIndex=A,this._pageInfo=S,this._transport=E,this._stats=C?new _display_utils.StatTimer:null,this._pdfBug=C,this.commonObjs=E.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:A,rotation:S=this.rotate,offsetX:E=0,offsetY:C=0,dontFlip:T=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:A,rotation:S,offsetX:E,offsetY:C,dontFlip:T})}getAnnotations({intent:A="display"}={}){let S=this._transport.getRenderingIntent(A);return this._transport.getAnnotations(this._pageIndex,S.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:A,viewport:S,intent:E="display",annotationMode:C=_util.AnnotationMode.ENABLE,transform:T=null,background:P=null,optionalContentConfigPromise:M=null,annotationCanvasMap:R=null,pageColors:F=null,printAnnotationStorage:I=null}){this._stats?.time("Overall");let D=this._transport.getRenderingIntent(E,C,I);this.#r=!1,this.#n(),M||(M=this._transport.getOptionalContentConfig());let L=this._intentStates.get(D.cacheKey);L||(L=Object.create(null),this._intentStates.set(D.cacheKey,L)),L.streamReaderCancelTimeout&&(clearTimeout(L.streamReaderCancelTimeout),L.streamReaderCancelTimeout=null);let O=!!(D.renderingIntent&_util.RenderingIntentFlag.PRINT);L.displayReadyCapability||(L.displayReadyCapability=new _util.PromiseCapability,L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(D));let complete=A=>{L.renderTasks.delete(B),(this._maybeCleanupAfterRender||O)&&(this.#r=!0),this.#s(!O),A?(B.capability.reject(A),this._abortOperatorList({intentState:L,reason:A instanceof Error?A:Error(A)})):B.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},B=new InternalRenderTask({callback:complete,params:{canvasContext:A,viewport:S,transform:T,background:P},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:R,operatorList:L.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!O,pdfBug:this._pdfBug,pageColors:F});(L.renderTasks||=new Set).add(B);let N=B.task;return Promise.all([L.displayReadyCapability.promise,M]).then(([A,S])=>{if(this.destroyed){complete();return}this._stats?.time("Rendering"),B.initializeGraphics({transparency:A,optionalContentConfig:S}),B.operatorListChanged()}).catch(complete),N}getOperatorList({intent:A="display",annotationMode:S=_util.AnnotationMode.ENABLE,printAnnotationStorage:E=null}={}){let C;function operatorListChanged(){P.operatorList.lastChunk&&(P.opListReadCapability.resolve(P.operatorList),P.renderTasks.delete(C))}let T=this._transport.getRenderingIntent(A,S,E,!0),P=this._intentStates.get(T.cacheKey);return P||(P=Object.create(null),this._intentStates.set(T.cacheKey,P)),P.opListReadCapability||((C=Object.create(null)).operatorListChanged=operatorListChanged,P.opListReadCapability=new _util.PromiseCapability,(P.renderTasks||=new Set).add(C),P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(T)),P.opListReadCapability.promise}streamTextContent({includeMarkedContent:A=!1,disableNormalization:S=!1}={}){let E=100;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===A,disableNormalization:!0===S},{highWaterMark:E,size:A=>A.items.length})}getTextContent(A={}){if(this._transport._htmlForXfa)return this.getXfa().then(A=>_xfa_text.XfaText.textContent(A));let S=this.streamTextContent(A);return new Promise(function(A,E){function pump(){C.read().then(function({value:S,done:E}){if(E){A(T);return}Object.assign(T.styles,S.styles),T.items.push(...S.items),pump()},E)}let C=S.getReader(),T={items:[],styles:Object.create(null)};pump()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let A=[];for(let S of this._intentStates.values())if(this._abortOperatorList({intentState:S,reason:Error("Page was destroyed."),force:!0}),!S.opListReadCapability)for(let E of S.renderTasks)A.push(E.completed),E.cancel();return this.objs.clear(),this.#r=!1,this.#n(),Promise.all(A)}cleanup(A=!1){this.#r=!0;let S=this.#s(!1);return A&&S&&(this._stats&&=new _display_utils.StatTimer),S}#s(A=!1){if(this.#n(),!this.#r||this.destroyed)return!1;if(A)return this.#i=setTimeout(()=>{this.#i=null,this.#s(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(let{renderTasks:A,operatorList:S}of this._intentStates.values())if(A.size>0||!S.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#r=!1,!0}#n(){this.#i&&(clearTimeout(this.#i),this.#i=null)}_startRenderPage(A,S){let E=this._intentStates.get(S);E&&(this._stats?.timeEnd("Page Request"),E.displayReadyCapability?.resolve(A))}_renderPageChunk(A,S){for(let E=0,C=A.length;E<C;E++)S.operatorList.fnArray.push(A.fnArray[E]),S.operatorList.argsArray.push(A.argsArray[E]);for(let E of(S.operatorList.lastChunk=A.lastChunk,S.operatorList.separateAnnots=A.separateAnnots,S.renderTasks))E.operatorListChanged();A.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:A,cacheKey:S,annotationStorageSerializable:E}){let{map:C,transfers:T}=E,P=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:A,cacheKey:S,annotationStorage:C},T),M=P.getReader(),R=this._intentStates.get(S);R.streamReader=M;let pump=()=>{M.read().then(({value:A,done:S})=>{if(S){R.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(A,R),pump())},A=>{if(R.streamReader=null,!this._transport.destroyed){if(R.operatorList){for(let A of(R.operatorList.lastChunk=!0,R.renderTasks))A.operatorListChanged();this.#s(!0)}if(R.displayReadyCapability)R.displayReadyCapability.reject(A);else if(R.opListReadCapability)R.opListReadCapability.reject(A);else throw A}})};pump()}_abortOperatorList({intentState:A,reason:S,force:E=!1}){if(A.streamReader){if(A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null),!E){if(A.renderTasks.size>0)return;if(S instanceof _display_utils.RenderingCancelledException){let E=RENDERING_CANCELLED_TIMEOUT;S.extraDelay>0&&S.extraDelay<1e3&&(E+=S.extraDelay),A.streamReaderCancelTimeout=setTimeout(()=>{A.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:A,reason:S,force:!0})},E);return}}if(A.streamReader.cancel(new _util.AbortException(S.message)).catch(()=>{}),A.streamReader=null,!this._transport.destroyed){for(let[S,E]of this._intentStates)if(E===A){this._intentStates.delete(S);break}this.cleanup()}}}get stats(){return this._stats}};exports.PDFPageProxy=PDFPageProxy;let LoopbackPort=class LoopbackPort{#a=new Set;#o=Promise.resolve();postMessage(A,S){let E={data:structuredClone(A,S?{transfer:S}:null)};this.#o.then(()=>{for(let A of this.#a)A.call(this,E)})}addEventListener(A,S){this.#a.add(S)}removeEventListener(A,S){this.#a.delete(S)}terminate(){this.#a.clear()}};exports.LoopbackPort=LoopbackPort;let PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_util.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){let pdfjsFilePath=document?.currentScript?.src;pdfjsFilePath&&(PDFWorkerUtil.fallbackWorkerSrc=pdfjsFilePath.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,S){let E;try{if(!(E=new URL(A)).origin||"null"===E.origin)return!1}catch{return!1}let C=new URL(S,E);return E.origin===C.origin},PDFWorkerUtil.createCDNWrapper=function(A){let S=`importScripts("${A}");`;return URL.createObjectURL(new Blob([S]))};let PDFWorker=class PDFWorker{static #l;constructor({name:A=null,port:S=null,verbosity:E=(0,_util.getVerbosityLevel)()}={}){if(this.name=A,this.destroyed=!1,this.verbosity=E,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,S){if(PDFWorker.#l?.has(S))throw Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#l||=new WeakMap).set(S,this),this._initializeFromPort(S);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:A}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));let S=new Worker(A),E=new _message_handler.MessageHandler("main","worker",S),terminateEarly=()=>{S.removeEventListener("error",onWorkerError),E.destroy(),S.terminate(),this.destroyed?this._readyCapability.reject(Error("Worker was destroyed")):this._setupFakeWorker()},onWorkerError=()=>{this._webWorker||terminateEarly()};S.addEventListener("error",onWorkerError),E.on("test",A=>{if(S.removeEventListener("error",onWorkerError),this.destroyed){terminateEarly();return}A?(this._messageHandler=E,this._port=S,this._webWorker=S,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),E.destroy(),S.terminate())}),E.on("ready",A=>{if(S.removeEventListener("error",onWorkerError),this.destroyed){terminateEarly();return}try{sendTest()}catch{this._setupFakeWorker()}});let sendTest=()=>{let A=new Uint8Array;E.send("test",A,[A.buffer])};sendTest();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(Error("Worker was destroyed"));return}let S=new LoopbackPort;this._port=S;let E=`fake${PDFWorkerUtil.fakeWorkerId++}`,C=new _message_handler.MessageHandler(E+"_worker",E,S);A.setup(C,S);let T=new _message_handler.MessageHandler(E,E+"_worker",S);this._messageHandler=T,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#l?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){if(!A?.port)throw Error("PDFWorker.fromPort - invalid method signature.");let S=this.#l?.get(A.port);if(S){if(S._pendingDestroy)throw Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return S}return new PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){let loader=async()=>{let mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS){let worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await (0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};exports.PDFWorker=PDFWorker;let WorkerTransport=class WorkerTransport{#h=new Map;#d=new Map;#c=new Map;#u=null;constructor(A,S,E,C,T){this.messageHandler=A,this.loadingTask=S,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:C.ownerDocument,styleElement:C.styleElement}),this._params=C,this.canvasFactory=T.canvasFactory,this.filterFactory=T.filterFactory,this.cMapReaderFactory=T.cMapReaderFactory,this.standardFontDataFactory=T.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=E,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#p(A,S=null){let E=this.#h.get(A);if(E)return E;let C=this.messageHandler.sendWithPromise(A,S);return this.#h.set(A,C),C}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(A,S=_util.AnnotationMode.ENABLE,E=null,C=!1){let T=_util.RenderingIntentFlag.DISPLAY,P=_annotation_storage.SerializableEmpty;switch(A){case"any":T=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":T=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${A}`)}switch(S){case _util.AnnotationMode.DISABLE:T+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:T+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:T+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE;let M=T&_util.RenderingIntentFlag.PRINT&&E instanceof _annotation_storage.PrintAnnotationStorage?E:this.annotationStorage;P=M.serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${S}`)}return C&&(T+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:T,cacheKey:`${T}_${P.hash}`,annotationStorageSerializable:P}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#u?.reject(Error("Worker was destroyed during onPassword callback"));let A=[];for(let S of this.#d.values())A.push(S._destroy());this.#d.clear(),this.#c.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let S=this.messageHandler.sendWithPromise("Terminate",null);return A.push(S),Promise.all(A).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#h.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:A,loadingTask:S}=this;A.on("GetReader",(A,S)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=A=>{this._lastProgress={loaded:A.loaded,total:A.total}},S.onPull=()=>{this._fullReader.read().then(function({value:A,done:E}){if(E){S.close();return}(0,_util.assert)(A instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),S.enqueue(new Uint8Array(A),1,[A])}).catch(A=>{S.error(A)})},S.onCancel=A=>{this._fullReader.cancel(A),S.ready.catch(A=>{if(!this.destroyed)throw A})}}),A.on("ReaderHeadersReady",A=>{let E=new _util.PromiseCapability,C=this._fullReader;return C.headersReady.then(()=>{C.isStreamingSupported&&C.isRangeSupported||(this._lastProgress&&S.onProgress?.(this._lastProgress),C.onProgress=A=>{S.onProgress?.({loaded:A.loaded,total:A.total})}),E.resolve({isStreamingSupported:C.isStreamingSupported,isRangeSupported:C.isRangeSupported,contentLength:C.contentLength})},E.reject),E.promise}),A.on("GetRangeReader",(A,S)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let E=this._networkStream.getRangeReader(A.begin,A.end);if(!E){S.close();return}S.onPull=()=>{E.read().then(function({value:A,done:E}){if(E){S.close();return}(0,_util.assert)(A instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),S.enqueue(new Uint8Array(A),1,[A])}).catch(A=>{S.error(A)})},S.onCancel=A=>{E.cancel(A),S.ready.catch(A=>{if(!this.destroyed)throw A})}}),A.on("GetDoc",({pdfInfo:A})=>{this._numPages=A.numPages,this._htmlForXfa=A.htmlForXfa,delete A.htmlForXfa,S._capability.resolve(new PDFDocumentProxy(A,this))}),A.on("DocException",function(A){let E;switch(A.name){case"PasswordException":E=new _util.PasswordException(A.message,A.code);break;case"InvalidPDFException":E=new _util.InvalidPDFException(A.message);break;case"MissingPDFException":E=new _util.MissingPDFException(A.message);break;case"UnexpectedResponseException":E=new _util.UnexpectedResponseException(A.message,A.status);break;case"UnknownErrorException":E=new _util.UnknownErrorException(A.message,A.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}S._capability.reject(E)}),A.on("PasswordRequest",A=>{if(this.#u=new _util.PromiseCapability,S.onPassword){let updatePassword=A=>{A instanceof Error?this.#u.reject(A):this.#u.resolve({password:A})};try{S.onPassword(updatePassword,A.code)}catch(A){this.#u.reject(A)}}else this.#u.reject(new _util.PasswordException(A.message,A.code));return this.#u.promise}),A.on("DataLoaded",A=>{S.onProgress?.({loaded:A.length,total:A.length}),this.downloadInfoCapability.resolve(A)}),A.on("StartRenderPage",A=>{if(this.destroyed)return;let S=this.#d.get(A.pageIndex);S._startRenderPage(A.transparency,A.cacheKey)}),A.on("commonobj",([S,E,C])=>{if(!(this.destroyed||this.commonObjs.has(S)))switch(E){case"Font":let T=this._params;if("error"in C){let A=C.error;(0,_util.warn)(`Error during font loading: ${A}`),this.commonObjs.resolve(S,A);break}let P=T.pdfBug&&globalThis.FontInspector?.enabled?(A,S)=>globalThis.FontInspector.fontAdded(A,S):null,M=new _font_loader.FontFaceObject(C,{isEvalSupported:T.isEvalSupported,disableFontFace:T.disableFontFace,ignoreErrors:T.ignoreErrors,inspectFont:P});this.fontLoader.bind(M).catch(E=>A.sendWithPromise("FontFallback",{id:S})).finally(()=>{!T.fontExtraProperties&&M.data&&(M.data=null),this.commonObjs.resolve(S,M)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(S,C);break;default:throw Error(`Got unknown common object type ${E}`)}}),A.on("obj",([A,S,E,C])=>{if(this.destroyed)return;let T=this.#d.get(S);if(!T.objs.has(A))switch(E){case"Image":if(T.objs.resolve(A,C),C){let A;if(C.bitmap){let{width:S,height:E}=C;A=S*E*4}else A=C.data?.length||0;A>_util.MAX_IMAGE_SIZE_TO_CACHE&&(T._maybeCleanupAfterRender=!0)}break;case"Pattern":T.objs.resolve(A,C);break;default:throw Error(`Got unknown object type ${E}`)}}),A.on("DocProgress",A=>{this.destroyed||S.onProgress?.({loaded:A.loaded,total:A.total})}),A.on("FetchBuiltInCMap",A=>this.destroyed?Promise.reject(Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(A):Promise.reject(Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),A.on("FetchStandardFontData",A=>this.destroyed?Promise.reject(Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(A):Promise.reject(Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:A,transfers:S}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:A,filename:this._fullReader?.filename??null},S).finally(()=>{this.annotationStorage.resetModified()})}getPage(A){if(!Number.isInteger(A)||A<=0||A>this._numPages)return Promise.reject(Error("Invalid page request."));let S=A-1,E=this.#c.get(S);if(E)return E;let C=this.messageHandler.sendWithPromise("GetPage",{pageIndex:S}).then(A=>{if(this.destroyed)throw Error("Transport destroyed");let E=new PDFPageProxy(S,A,this,this._params.pdfBug);return this.#d.set(S,E),E});return this.#c.set(S,C),C}getPageIndex(A){return"object"!=typeof A||null===A||!Number.isInteger(A.num)||A.num<0||!Number.isInteger(A.gen)||A.gen<0?Promise.reject(Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:A.num,gen:A.gen})}getAnnotations(A,S){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:A,intent:S})}getFieldObjects(){return this.#p("GetFieldObjects")}hasJSActions(){return this.#p("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(A){return"string"!=typeof A?Promise.reject(Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:A})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#p("GetDocJSActions")}getPageJSActions(A){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:A})}getStructTree(A){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:A})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(A=>new _optional_content_config.OptionalContentConfig(A))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let A="GetMetadata",S=this.#h.get(A);if(S)return S;let E=this.messageHandler.sendWithPromise(A,null).then(A=>({info:A[0],metadata:A[1]?new _metadata.Metadata(A[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#h.set(A,E),E}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(A=!1){if(!this.destroyed){for(let A of(await this.messageHandler.sendWithPromise("Cleanup",null),this.#d.values())){let S=A.cleanup();if(!S)throw Error(`startCleanup: Page ${A.pageNumber} is currently rendering.`)}this.commonObjs.clear(),A||this.fontLoader.clear(),this.#h.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){let{disableAutoFetch:A,enableXfa:S}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:A,enableXfa:S})}};let PDFObjects=class PDFObjects{#f=Object.create(null);#g(A){return this.#f[A]||={capability:new _util.PromiseCapability,data:null}}get(A,S=null){if(S){let E=this.#g(A);return E.capability.promise.then(()=>S(E.data)),null}let E=this.#f[A];if(!E?.capability.settled)throw Error(`Requesting object that isn't resolved yet ${A}.`);return E.data}has(A){let S=this.#f[A];return S?.capability.settled||!1}resolve(A,S=null){let E=this.#g(A);E.data=S,E.capability.resolve()}clear(){for(let A in this.#f){let{data:S}=this.#f[A];S?.bitmap?.close()}this.#f=Object.create(null)}};let RenderTask=class RenderTask{#m=null;constructor(A){this.#m=A,this.onContinue=null}get promise(){return this.#m.capability.promise}cancel(A=0){this.#m.cancel(null,A)}get separateAnnots(){let{separateAnnots:A}=this.#m.operatorList;if(!A)return!1;let{annotationCanvasMap:S}=this.#m;return A.form||A.canvas&&S?.size>0}};exports.RenderTask=RenderTask;let InternalRenderTask=class InternalRenderTask{static #b=new WeakSet;constructor({callback:A,params:S,objs:E,commonObjs:C,annotationCanvasMap:T,operatorList:P,pageIndex:M,canvasFactory:R,filterFactory:F,useRequestAnimationFrame:I=!1,pdfBug:D=!1,pageColors:L=null}){this.callback=A,this.params=S,this.objs=E,this.commonObjs=C,this.annotationCanvasMap=T,this.operatorListIdx=null,this.operatorList=P,this._pageIndex=M,this.canvasFactory=R,this.filterFactory=F,this._pdfBug=D,this.pageColors=L,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===I&&"undefined"!=typeof window,this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=S.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:A=!1,optionalContentConfig:S}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#b.has(this._canvas))throw Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#b.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:E,viewport:C,transform:T,background:P}=this.params;this.gfx=new _canvas.CanvasGraphics(E,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:S},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:T,viewport:C,transparency:A,background:P}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(A=null,S=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#b.delete(this._canvas),this.callback(A||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,S))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){!this.cancelled&&(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#b.delete(this._canvas),this.callback())))}};let version="3.11.174";exports.version=version;let build="ce8716743";exports.build=build},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.SerializableEmpty=S.PrintAnnotationStorage=S.AnnotationStorage=void 0;var C=E(1),T=E(4),P=E(8);let M=Object.freeze({map:null,hash:"",transfers:void 0});S.SerializableEmpty=M;let AnnotationStorage=class AnnotationStorage{#A=!1;#y=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(A,S){let E=this.#y.get(A);return void 0===E?S:Object.assign(S,E)}getRawValue(A){return this.#y.get(A)}remove(A){if(this.#y.delete(A),0===this.#y.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(let A of this.#y.values())if(A instanceof T.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(A,S){let E=this.#y.get(A),C=!1;if(void 0!==E)for(let[A,T]of Object.entries(S))E[A]!==T&&(C=!0,E[A]=T);else C=!0,this.#y.set(A,S);C&&this.#v(),S instanceof T.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(S.constructor._type)}has(A){return this.#y.has(A)}getAll(){return this.#y.size>0?(0,C.objectFromMap)(this.#y):null}setAll(A){for(let[S,E]of Object.entries(A))this.setValue(S,E)}get size(){return this.#y.size}#v(){this.#A||(this.#A=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#A&&(this.#A=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new PrintAnnotationStorage(this)}get serializable(){if(0===this.#y.size)return M;let A=new Map,S=new P.MurmurHash3_64,E=[],C=Object.create(null),R=!1;for(let[E,P]of this.#y){let M=P instanceof T.AnnotationEditor?P.serialize(!1,C):P;M&&(A.set(E,M),S.update(`${E}:${JSON.stringify(M)}`),R||=!!M.bitmap)}if(R)for(let S of A.values())S.bitmap&&E.push(S.bitmap);return A.size>0?{map:A,hash:S.hexdigest(),transfers:E}:M}};S.AnnotationStorage=AnnotationStorage;let PrintAnnotationStorage=class PrintAnnotationStorage extends AnnotationStorage{#_;constructor(A){super();let{map:S,hash:E,transfers:C}=A.serializable,T=structuredClone(S,C?{transfer:C}:null);this.#_={map:T,hash:E,transfers:C}}get print(){(0,C.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#_}};S.PrintAnnotationStorage=PrintAnnotationStorage},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.AnnotationEditor=void 0;var C=E(5),T=E(1),P=E(6);let AnnotationEditor=class AnnotationEditor{#S="";#E=!1;#x=null;#C=null;#w=null;#T=!1;#P=null;#k=this.focusin.bind(this);#M=this.focusout.bind(this);#R=!1;#F=!1;#I=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#D=!1;#L=AnnotationEditor._zIndex++;static _borderLineWidth=-1;static _colorManager=new C.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(A){this.constructor===AnnotationEditor&&(0,T.unreachable)("Cannot initialize AnnotationEditor."),this.parent=A.parent,this.id=A.id,this.width=this.height=null,this.pageIndex=A.parent.pageIndex,this.name=A.name,this.div=null,this._uiManager=A.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=A.isCentered,this._structTreeParentId=null;let{rotation:S,rawDims:{pageWidth:E,pageHeight:C,pageX:P,pageY:M}}=this.parent.viewport;this.rotation=S,this.pageRotation=(360+S-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[E,C],this.pageTranslation=[P,M];let[R,F]=this.parentDimensions;this.x=A.x/R,this.y=A.y/F,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,T.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(A){let S=new FakeEditor({id:A.parent.getNextId(),parent:A.parent,uiManager:A._uiManager});S.annotationElementId=A.annotationElementId,S.deleted=!0,S._uiManager.addToAnnotationStorage(S)}static initialize(A,S=null){if(AnnotationEditor._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(S=>[S,A.get(S)])),S?.strings)for(let E of S.strings)AnnotationEditor._l10nPromise.set(E,A.get(E));if(-1!==AnnotationEditor._borderLineWidth)return;let E=getComputedStyle(document.documentElement);AnnotationEditor._borderLineWidth=parseFloat(E.getPropertyValue("--outline-width"))||0}static updateDefaultParams(A,S){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(A){return!1}static paste(A,S){(0,T.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#D}set _isDraggable(A){this.#D=A,this.div?.classList.toggle("draggable",A)}center(){let[A,S]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*S/(2*A),this.y+=this.width*A/(2*S);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*S/(2*A),this.y-=this.width*A/(2*S);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(A){this._uiManager.addCommands(A)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#L}setParent(A){null!==A&&(this.pageIndex=A.pageIndex,this.pageDimensions=A.pageDimensions),this.parent=A}focusin(A){this._focusEventsAllowed&&(this.#R?this.#R=!1:this.parent.setSelected(this))}focusout(A){if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;let S=A.relatedTarget;!S?.closest(`#${this.id}`)&&(A.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(A,S,E,C){let[T,P]=this.parentDimensions;[E,C]=this.screenToPageTranslation(E,C),this.x=(A+E)/T,this.y=(S+C)/P,this.fixAndSetPosition()}#O([A,S],E,C){[E,C]=this.screenToPageTranslation(E,C),this.x+=E/A,this.y+=C/S,this.fixAndSetPosition()}translate(A,S){this.#O(this.parentDimensions,A,S)}translateInPage(A,S){this.#O(this.pageDimensions,A,S),this.div.scrollIntoView({block:"nearest"})}drag(A,S){let[E,C]=this.parentDimensions;if(this.x+=A/E,this.y+=S/C,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:A,y:S}=this.div.getBoundingClientRect();this.parent.findNewParent(this,A,S)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:T,y:P}=this,[M,R]=this.#B();T+=M,P+=R,this.div.style.left=`${(100*T).toFixed(2)}%`,this.div.style.top=`${(100*P).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#B(){let[A,S]=this.parentDimensions,{_borderLineWidth:E}=AnnotationEditor,C=E/A,T=E/S;switch(this.rotation){case 90:return[-C,T];case 180:return[C,T];case 270:return[C,-T];default:return[-C,-T]}}fixAndSetPosition(){let[A,S]=this.pageDimensions,{x:E,y:C,width:T,height:P}=this;switch(T*=A,P*=S,E*=A,C*=S,this.rotation){case 0:E=Math.max(0,Math.min(A-T,E)),C=Math.max(0,Math.min(S-P,C));break;case 90:E=Math.max(0,Math.min(A-P,E)),C=Math.min(S,Math.max(T,C));break;case 180:E=Math.min(A,Math.max(T,E)),C=Math.min(S,Math.max(P,C));break;case 270:E=Math.min(A,Math.max(P,E)),C=Math.max(0,Math.min(S-T,C))}this.x=E/=A,this.y=C/=S;let[M,R]=this.#B();E+=M,C+=R;let{style:F}=this.div;F.left=`${(100*E).toFixed(2)}%`,F.top=`${(100*C).toFixed(2)}%`,this.moveInDOM()}static #N(A,S,E){switch(E){case 90:return[S,-A];case 180:return[-A,-S];case 270:return[-S,A];default:return[A,S]}}screenToPageTranslation(A,S){return AnnotationEditor.#N(A,S,this.parentRotation)}pageTranslationToScreen(A,S){return AnnotationEditor.#N(A,S,360-this.parentRotation)}#U(A){switch(A){case 90:{let[A,S]=this.pageDimensions;return[0,-A/S,S/A,0]}case 180:return[-1,0,0,-1];case 270:{let[A,S]=this.pageDimensions;return[0,A/S,-S/A,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:A,pageDimensions:[S,E]}=this,C=S*A,P=E*A;return T.FeatureTest.isCSSRoundSupported?[Math.round(C),Math.round(P)]:[C,P]}setDims(A,S){let[E,C]=this.parentDimensions;this.div.style.width=`${(100*A/E).toFixed(2)}%`,this.#T||(this.div.style.height=`${(100*S/C).toFixed(2)}%`),this.#x?.classList.toggle("small",A<AnnotationEditor.SMALL_EDITOR_SIZE||S<AnnotationEditor.SMALL_EDITOR_SIZE)}fixDims(){let{style:A}=this.div,{height:S,width:E}=A,C=E.endsWith("%"),T=!this.#T&&S.endsWith("%");if(C&&T)return;let[P,M]=this.parentDimensions;C||(A.width=`${(100*parseFloat(E)/P).toFixed(2)}%`),this.#T||T||(A.height=`${(100*parseFloat(S)/M).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#j(){if(this.#P)return;this.#P=document.createElement("div"),this.#P.classList.add("resizers");let A=["topLeft","topRight","bottomRight","bottomLeft"];for(let S of(this._willKeepAspectRatio||A.push("topMiddle","middleRight","bottomMiddle","middleLeft"),A)){let A=document.createElement("div");this.#P.append(A),A.classList.add("resizer",S),A.addEventListener("pointerdown",this.#z.bind(this,S)),A.addEventListener("contextmenu",P.noContextMenu)}this.div.prepend(this.#P)}#z(A,S){S.preventDefault();let{isMac:E}=T.FeatureTest.platform;if(0!==S.button||S.ctrlKey&&E)return;let C=this.#H.bind(this,A),P=this._isDraggable;this._isDraggable=!1;let M={passive:!0,capture:!0};window.addEventListener("pointermove",C,M);let R=this.x,F=this.y,I=this.width,D=this.height,L=this.parent.div.style.cursor,O=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(S.target).cursor;let pointerUpCallback=()=>{this._isDraggable=P,window.removeEventListener("pointerup",pointerUpCallback),window.removeEventListener("blur",pointerUpCallback),window.removeEventListener("pointermove",C,M),this.parent.div.style.cursor=L,this.div.style.cursor=O;let A=this.x,S=this.y,E=this.width,T=this.height;(A!==R||S!==F||E!==I||T!==D)&&this.addCommands({cmd:()=>{this.width=E,this.height=T,this.x=A,this.y=S;let[C,P]=this.parentDimensions;this.setDims(C*E,P*T),this.fixAndSetPosition()},undo:()=>{this.width=I,this.height=D,this.x=R,this.y=F;let[A,S]=this.parentDimensions;this.setDims(A*I,S*D),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",pointerUpCallback),window.addEventListener("blur",pointerUpCallback)}#H(A,S){let E,C;let[T,P]=this.parentDimensions,M=this.x,R=this.y,F=this.width,I=this.height,D=AnnotationEditor.MIN_SIZE/T,L=AnnotationEditor.MIN_SIZE/P,round=A=>Math.round(1e4*A)/1e4,O=this.#U(this.rotation),transf=(A,S)=>[O[0]*A+O[2]*S,O[1]*A+O[3]*S],B=this.#U(360-this.rotation),invTransf=(A,S)=>[B[0]*A+B[2]*S,B[1]*A+B[3]*S],N=!1,U=!1;switch(A){case"topLeft":N=!0,E=(A,S)=>[0,0],C=(A,S)=>[A,S];break;case"topMiddle":E=(A,S)=>[A/2,0],C=(A,S)=>[A/2,S];break;case"topRight":N=!0,E=(A,S)=>[A,0],C=(A,S)=>[0,S];break;case"middleRight":U=!0,E=(A,S)=>[A,S/2],C=(A,S)=>[0,S/2];break;case"bottomRight":N=!0,E=(A,S)=>[A,S],C=(A,S)=>[0,0];break;case"bottomMiddle":E=(A,S)=>[A/2,S],C=(A,S)=>[A/2,0];break;case"bottomLeft":N=!0,E=(A,S)=>[0,S],C=(A,S)=>[A,0];break;case"middleLeft":U=!0,E=(A,S)=>[0,S/2],C=(A,S)=>[A,S/2]}let z=E(F,I),H=C(F,I),W=transf(...H),V=round(M+W[0]),$=round(R+W[1]),X=1,K=1,[Y,J]=this.screenToPageTranslation(S.movementX,S.movementY);if([Y,J]=invTransf(Y/T,J/P),N){let A=Math.hypot(F,I);X=K=Math.max(Math.min(Math.hypot(H[0]-z[0]-Y,H[1]-z[1]-J)/A,1/F,1/I),D/F,L/I)}else U?X=Math.max(D,Math.min(1,Math.abs(H[0]-z[0]-Y)))/F:K=Math.max(L,Math.min(1,Math.abs(H[1]-z[1]-J)))/I;let Q=round(F*X),Z=round(I*K);W=transf(...C(Q,Z));let tt=V-W[0],te=$-W[1];this.width=Q,this.height=Z,this.x=tt,this.y=te,this.setDims(T*Q,P*Z),this.fixAndSetPosition()}async addAltTextButton(){if(this.#x)return;let A=this.#x=document.createElement("button");A.className="altText";let S=await AnnotationEditor._l10nPromise.get("editor_alt_text_button_label");if(A.textContent=S,A.setAttribute("aria-label",S),A.tabIndex="0",A.addEventListener("contextmenu",P.noContextMenu),A.addEventListener("pointerdown",A=>A.stopPropagation()),A.addEventListener("click",A=>{A.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),A.addEventListener("keydown",S=>{S.target===A&&"Enter"===S.key&&(S.preventDefault(),this._uiManager.editAltText(this))}),this.#W(),this.div.append(A),!AnnotationEditor.SMALL_EDITOR_SIZE){let S=40;AnnotationEditor.SMALL_EDITOR_SIZE=Math.min(128,Math.round(A.getBoundingClientRect().width*(1+S/100)))}}async #W(){let A=this.#x;if(!A)return;if(!this.#S&&!this.#E){A.classList.remove("done"),this.#C?.remove();return}AnnotationEditor._l10nPromise.get("editor_alt_text_edit_button_label").then(S=>{A.setAttribute("aria-label",S)});let S=this.#C;if(!S){this.#C=S=document.createElement("span"),S.className="tooltip",S.setAttribute("role","tooltip");let E=S.id=`alt-text-tooltip-${this.id}`;A.setAttribute("aria-describedby",E);let C=100;A.addEventListener("mouseenter",()=>{this.#w=setTimeout(()=>{this.#w=null,this.#C.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},C)}),A.addEventListener("mouseleave",()=>{clearTimeout(this.#w),this.#w=null,this.#C?.classList.remove("show")})}A.classList.add("done"),S.innerText=this.#E?await AnnotationEditor._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#S,S.parentNode||A.append(S)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#S,decorative:this.#E}}set altTextData({altText:A,decorative:S}){(this.#S!==A||this.#E!==S)&&(this.#S=A,this.#E=S,this.#W())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#k),this.div.addEventListener("focusout",this.#M);let[A,S]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*S/A).toFixed(2)}%`,this.div.style.maxHeight=`${(100*A/S).toFixed(2)}%`);let[E,T]=this.getInitialTranslation();return this.translate(E,T),(0,C.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(A){let{isMac:S}=T.FeatureTest.platform;if(0!==A.button||A.ctrlKey&&S){A.preventDefault();return}this.#R=!0,this.#G(A)}#G(A){let S,E;if(!this._isDraggable)return;let C=this._uiManager.isSelected(this);this._uiManager.setUpDragSession(),C&&(S={passive:!0,capture:!0},E=A=>{let[S,E]=this.screenToPageTranslation(A.movementX,A.movementY);this._uiManager.dragSelectedEditors(S,E)},window.addEventListener("pointermove",E,S));let pointerUpCallback=()=>{if(window.removeEventListener("pointerup",pointerUpCallback),window.removeEventListener("blur",pointerUpCallback),C&&window.removeEventListener("pointermove",E,S),this.#R=!1,!this._uiManager.endDragSession()){let{isMac:S}=T.FeatureTest.platform;A.ctrlKey&&!S||A.shiftKey||A.metaKey&&S?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",pointerUpCallback),window.addEventListener("blur",pointerUpCallback)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(A,S,E){A.changeParent(this),this.x=S,this.y=E,this.fixAndSetPosition()}getRect(A,S){let E=this.parentScale,[C,T]=this.pageDimensions,[P,M]=this.pageTranslation,R=A/E,F=S/E,I=this.x*C,D=this.y*T,L=this.width*C,O=this.height*T;switch(this.rotation){case 0:return[I+R+P,T-D-F-O+M,I+R+L+P,T-D-F+M];case 90:return[I+F+P,T-D+R+M,I+F+O+P,T-D+R+L+M];case 180:return[I-R-L+P,T-D+F+M,I-R+P,T-D+F+O+M];case 270:return[I-F-O+P,T-D-R-L+M,I-F+P,T-D-R+M];default:throw Error("Invalid rotation")}}getRectInCurrentCoords(A,S){let[E,C,T,P]=A,M=T-E,R=P-C;switch(this.rotation){case 0:return[E,S-P,M,R];case 90:return[E,S-C,R,M];case 180:return[T,S-C,M,R];case 270:return[T,S-P,R,M];default:throw Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#I=!0}disableEditMode(){this.#I=!1}isInEditMode(){return this.#I}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#k),this.div?.addEventListener("focusout",this.#M)}serialize(A=!1,S=null){(0,T.unreachable)("An editor must be serializable")}static deserialize(A,S,E){let C=new this.prototype.constructor({parent:S,id:S.getNextId(),uiManager:E});C.rotation=A.rotation;let[T,P]=C.pageDimensions,[M,R,F,I]=C.getRectInCurrentCoords(A.rect,P);return C.x=M/T,C.y=R/P,C.width=F/T,C.height=I/P,C}remove(){this.div.removeEventListener("focusin",this.#k),this.div.removeEventListener("focusout",this.#M),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#x?.remove(),this.#x=null,this.#C=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#P.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#P?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(A,S){}disableEditing(){this.#x&&(this.#x.hidden=!0)}enableEditing(){this.#x&&(this.#x.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#F}set isEditing(A){this.#F=A,this.parent&&(A?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(A,S){this.#T=!0;let E=A/S,{style:C}=this.div;C.aspectRatio=E,C.height="auto"}static get MIN_SIZE(){return 16}};S.AnnotationEditor=AnnotationEditor;let FakeEditor=class FakeEditor extends AnnotationEditor{constructor(A){super(A),this.annotationElementId=A.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.KeyboardManager=S.CommandManager=S.ColorManager=S.AnnotationEditorUIManager=void 0,S.bindEvents=bindEvents,S.opacityToHex=opacityToHex;var C=E(1),T=E(6);function bindEvents(A,S,E){for(let C of E)S.addEventListener(C,A[C].bind(A))}function opacityToHex(A){return Math.round(Math.min(255,Math.max(1,255*A))).toString(16).padStart(2,"0")}let IdManager=class IdManager{#V=0;getId(){return`${C.AnnotationEditorPrefix}${this.#V++}`}};let ImageManager=class ImageManager{#q=(0,C.getUuid)();#V=0;#$=null;static get _isSVGFittingCanvas(){let A='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',S=new OffscreenCanvas(1,3),E=S.getContext("2d"),T=new Image;T.src=A;let P=T.decode().then(()=>(E.drawImage(T,0,0,1,1,0,0,1,3),0===new Uint32Array(E.getImageData(0,0,1,1).data.buffer)[0]));return(0,C.shadow)(this,"_isSVGFittingCanvas",P)}async #X(A,S){this.#$||=new Map;let E=this.#$.get(A);if(null===E)return null;if(E?.bitmap)return E.refCounter+=1,E;try{let A;if(E||={bitmap:null,id:`image_${this.#q}_${this.#V++}`,refCounter:0,isSvg:!1},"string"==typeof S){E.url=S;let C=await fetch(S);if(!C.ok)throw Error(C.statusText);A=await C.blob()}else A=E.file=S;if("image/svg+xml"===A.type){let S=ImageManager._isSVGFittingCanvas,C=new FileReader,T=new Image,P=new Promise((A,P)=>{T.onload=()=>{E.bitmap=T,E.isSvg=!0,A()},C.onload=async()=>{let A=E.svgUrl=C.result;T.src=await S?`${A}#svgView(preserveAspectRatio(none))`:A},T.onerror=C.onerror=P});C.readAsDataURL(A),await P}else E.bitmap=await createImageBitmap(A);E.refCounter=1}catch(A){console.error(A),E=null}return this.#$.set(A,E),E&&this.#$.set(E.id,E),E}async getFromFile(A){let{lastModified:S,name:E,size:C,type:T}=A;return this.#X(`${S}_${E}_${C}_${T}`,A)}async getFromUrl(A){return this.#X(A,A)}async getFromId(A){this.#$||=new Map;let S=this.#$.get(A);return S?S.bitmap?(S.refCounter+=1,S):S.file?this.getFromFile(S.file):this.getFromUrl(S.url):null}getSvgUrl(A){let S=this.#$.get(A);return S?.isSvg?S.svgUrl:null}deleteId(A){this.#$||=new Map;let S=this.#$.get(A);S&&(S.refCounter-=1,0===S.refCounter&&(S.bitmap=null))}isValidId(A){return A.startsWith(`image_${this.#q}_`)}};let CommandManager=class CommandManager{#K=[];#Y=!1;#J;#Q=-1;constructor(A=128){this.#J=A}add({cmd:A,undo:S,mustExec:E,type:C=NaN,overwriteIfSameType:T=!1,keepUndo:P=!1}){if(E&&A(),this.#Y)return;let M={cmd:A,undo:S,type:C};if(-1===this.#Q){this.#K.length>0&&(this.#K.length=0),this.#Q=0,this.#K.push(M);return}if(T&&this.#K[this.#Q].type===C){P&&(M.undo=this.#K[this.#Q].undo),this.#K[this.#Q]=M;return}let R=this.#Q+1;R===this.#J?this.#K.splice(0,1):(this.#Q=R,R<this.#K.length&&this.#K.splice(R)),this.#K.push(M)}undo(){-1!==this.#Q&&(this.#Y=!0,this.#K[this.#Q].undo(),this.#Y=!1,this.#Q-=1)}redo(){this.#Q<this.#K.length-1&&(this.#Q+=1,this.#Y=!0,this.#K[this.#Q].cmd(),this.#Y=!1)}hasSomethingToUndo(){return -1!==this.#Q}hasSomethingToRedo(){return this.#Q<this.#K.length-1}destroy(){this.#K=null}};S.CommandManager=CommandManager;let KeyboardManager=class KeyboardManager{constructor(A){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:S}=C.FeatureTest.platform;for(let[E,C,T={}]of A)for(let A of E){let E=A.startsWith("mac+");S&&E?(this.callbacks.set(A.slice(4),{callback:C,options:T}),this.allKeys.add(A.split("+").at(-1))):S||E||(this.callbacks.set(A,{callback:C,options:T}),this.allKeys.add(A.split("+").at(-1)))}}#Z(A){A.altKey&&this.buffer.push("alt"),A.ctrlKey&&this.buffer.push("ctrl"),A.metaKey&&this.buffer.push("meta"),A.shiftKey&&this.buffer.push("shift"),this.buffer.push(A.key);let S=this.buffer.join("+");return this.buffer.length=0,S}exec(A,S){if(!this.allKeys.has(S.key))return;let E=this.callbacks.get(this.#Z(S));if(!E)return;let{callback:C,options:{bubbles:T=!1,args:P=[],checker:M=null}}=E;(!M||M(A,S))&&(C.bind(A,...P)(),T||(S.stopPropagation(),S.preventDefault()))}};S.KeyboardManager=KeyboardManager;let ColorManager=class ColorManager{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let A=new Map([["CanvasText",null],["Canvas",null]]);return(0,T.getColorValues)(A),(0,C.shadow)(this,"_colors",A)}convert(A){let S=(0,T.getRGB)(A);if(!window.matchMedia("(forced-colors: active)").matches)return S;for(let[A,E]of this._colors)if(E.every((A,E)=>A===S[E]))return ColorManager._colorsMapping.get(A);return S}getHexCode(A){let S=this._colors.get(A);return S?C.Util.makeHexColor(...S):A}};S.ColorManager=ColorManager;let AnnotationEditorUIManager=class AnnotationEditorUIManager{#tt=null;#te=new Map;#ti=new Map;#tr=null;#tn=null;#ts=new CommandManager;#ta=0;#to=new Set;#tl=null;#th=null;#td=new Set;#tc=null;#tu=new IdManager;#tp=!1;#tf=!1;#tg=null;#tm=C.AnnotationEditorType.NONE;#tb=new Set;#tA=null;#ty=this.blur.bind(this);#tv=this.focus.bind(this);#t_=this.copy.bind(this);#tS=this.cut.bind(this);#tE=this.paste.bind(this);#tx=this.keydown.bind(this);#tC=this.onEditingAction.bind(this);#tw=this.onPageChanging.bind(this);#tT=this.onScaleChanging.bind(this);#tP=this.onRotationChanging.bind(this);#tk={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#tM=[0,0];#tR=null;#tF=null;#tI=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let A=AnnotationEditorUIManager.prototype,arrowChecker=A=>{let{activeElement:S}=document;return S&&A.#tF.contains(S)&&A.hasSomethingToControl()},S=this.TRANSLATE_SMALL,E=this.TRANSLATE_BIG;return(0,C.shadow)(this,"_keyboardManager",new KeyboardManager([[["ctrl+a","mac+meta+a"],A.selectAll],[["ctrl+z","mac+meta+z"],A.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],A.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],A.delete],[["Escape","mac+Escape"],A.unselectAll],[["ArrowLeft","mac+ArrowLeft"],A.translateSelectedEditors,{args:[-S,0],checker:arrowChecker}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],A.translateSelectedEditors,{args:[-E,0],checker:arrowChecker}],[["ArrowRight","mac+ArrowRight"],A.translateSelectedEditors,{args:[S,0],checker:arrowChecker}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],A.translateSelectedEditors,{args:[E,0],checker:arrowChecker}],[["ArrowUp","mac+ArrowUp"],A.translateSelectedEditors,{args:[0,-S],checker:arrowChecker}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],A.translateSelectedEditors,{args:[0,-E],checker:arrowChecker}],[["ArrowDown","mac+ArrowDown"],A.translateSelectedEditors,{args:[0,S],checker:arrowChecker}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],A.translateSelectedEditors,{args:[0,E],checker:arrowChecker}]]))}constructor(A,S,E,C,P,M){this.#tF=A,this.#tI=S,this.#tr=E,this._eventBus=C,this._eventBus._on("editingaction",this.#tC),this._eventBus._on("pagechanging",this.#tw),this._eventBus._on("scalechanging",this.#tT),this._eventBus._on("rotationchanging",this.#tP),this.#tn=P.annotationStorage,this.#tc=P.filterFactory,this.#tA=M,this.viewParameters={realScale:T.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){for(let A of(this.#tD(),this.#tL(),this._eventBus._off("editingaction",this.#tC),this._eventBus._off("pagechanging",this.#tw),this._eventBus._off("scalechanging",this.#tT),this._eventBus._off("rotationchanging",this.#tP),this.#ti.values()))A.destroy();this.#ti.clear(),this.#te.clear(),this.#td.clear(),this.#tt=null,this.#tb.clear(),this.#ts.destroy(),this.#tr.destroy()}get hcmFilter(){return(0,C.shadow)(this,"hcmFilter",this.#tA?this.#tc.addHCMFilter(this.#tA.foreground,this.#tA.background):"none")}get direction(){return(0,C.shadow)(this,"direction",getComputedStyle(this.#tF).direction)}editAltText(A){this.#tr?.editAltText(this,A)}onPageChanging({pageNumber:A}){this.#ta=A-1}focusMainContainer(){this.#tF.focus()}findParent(A,S){for(let E of this.#ti.values()){let{x:C,y:T,width:P,height:M}=E.div.getBoundingClientRect();if(A>=C&&A<=C+P&&S>=T&&S<=T+M)return E}return null}disableUserSelect(A=!1){this.#tI.classList.toggle("noUserSelect",A)}addShouldRescale(A){this.#td.add(A)}removeShouldRescale(A){this.#td.delete(A)}onScaleChanging({scale:A}){for(let S of(this.commitOrRemove(),this.viewParameters.realScale=A*T.PixelsPerInch.PDF_TO_CSS_UNITS,this.#td))S.onScaleChanging()}onRotationChanging({pagesRotation:A}){this.commitOrRemove(),this.viewParameters.rotation=A}addToAnnotationStorage(A){A.isEmpty()||!this.#tn||this.#tn.has(A.id)||this.#tn.setValue(A.id,A)}#tO(){window.addEventListener("focus",this.#tv),window.addEventListener("blur",this.#ty)}#tL(){window.removeEventListener("focus",this.#tv),window.removeEventListener("blur",this.#ty)}blur(){if(!this.hasSelection)return;let{activeElement:A}=document;for(let S of this.#tb)if(S.div.contains(A)){this.#tg=[S,A],S._focusEventsAllowed=!1;break}}focus(){if(!this.#tg)return;let[A,S]=this.#tg;this.#tg=null,S.addEventListener("focusin",()=>{A._focusEventsAllowed=!0},{once:!0}),S.focus()}#tB(){window.addEventListener("keydown",this.#tx,{capture:!0})}#tD(){window.removeEventListener("keydown",this.#tx,{capture:!0})}#tN(){document.addEventListener("copy",this.#t_),document.addEventListener("cut",this.#tS),document.addEventListener("paste",this.#tE)}#tU(){document.removeEventListener("copy",this.#t_),document.removeEventListener("cut",this.#tS),document.removeEventListener("paste",this.#tE)}addEditListeners(){this.#tB(),this.#tN()}removeEditListeners(){this.#tD(),this.#tU()}copy(A){if(A.preventDefault(),this.#tt?.commitOrRemove(),!this.hasSelection)return;let S=[];for(let A of this.#tb){let E=A.serialize(!0);E&&S.push(E)}0!==S.length&&A.clipboardData.setData("application/pdfjs",JSON.stringify(S))}cut(A){this.copy(A),this.delete()}paste(A){A.preventDefault();let{clipboardData:S}=A;for(let A of S.items)for(let S of this.#th)if(S.isHandlingMimeForPasting(A.type)){S.paste(A,this.currentLayer);return}let E=S.getData("application/pdfjs");if(!E)return;try{E=JSON.parse(E)}catch(A){(0,C.warn)(`paste: "${A.message}".`);return}if(!Array.isArray(E))return;this.unselectAll();let T=this.currentLayer;try{let A=[];for(let S of E){let E=T.deserialize(S);if(!E)return;A.push(E)}let cmd=()=>{for(let S of A)this.#tj(S);this.#tz(A)},undo=()=>{for(let S of A)S.remove()};this.addCommands({cmd,undo,mustExec:!0})}catch(A){(0,C.warn)(`paste: "${A.message}".`)}}keydown(A){this.getActive()?.shouldGetKeyboardEvents()||AnnotationEditorUIManager._keyboardManager.exec(this,A)}onEditingAction(A){["undo","redo","delete","selectAll"].includes(A.name)&&this[A.name]()}#tH(A){let S=Object.entries(A).some(([A,S])=>this.#tk[A]!==S);S&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#tk,A)})}#tW(A){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:A})}setEditingState(A){A?(this.#tO(),this.#tB(),this.#tN(),this.#tH({isEditing:this.#tm!==C.AnnotationEditorType.NONE,isEmpty:this.#tG(),hasSomethingToUndo:this.#ts.hasSomethingToUndo(),hasSomethingToRedo:this.#ts.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#tL(),this.#tD(),this.#tU(),this.#tH({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(A){if(!this.#th)for(let S of(this.#th=A,this.#th))this.#tW(S.defaultPropertiesToUpdate)}getId(){return this.#tu.getId()}get currentLayer(){return this.#ti.get(this.#ta)}getLayer(A){return this.#ti.get(A)}get currentPageIndex(){return this.#ta}addLayer(A){this.#ti.set(A.pageIndex,A),this.#tp?A.enable():A.disable()}removeLayer(A){this.#ti.delete(A.pageIndex)}updateMode(A,S=null){if(this.#tm!==A){if(this.#tm=A,A===C.AnnotationEditorType.NONE){this.setEditingState(!1),this.#tV();return}for(let S of(this.setEditingState(!0),this.#tq(),this.unselectAll(),this.#ti.values()))S.updateMode(A);if(S){for(let A of this.#te.values())if(A.annotationElementId===S){this.setSelected(A),A.enterInEditMode();break}}}}updateToolbar(A){A!==this.#tm&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:A})}updateParams(A,S){if(this.#th){if(A===C.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(A);return}for(let E of this.#tb)E.updateParams(A,S);for(let E of this.#th)E.updateDefaultParams(A,S)}}enableWaiting(A=!1){if(this.#tf!==A)for(let S of(this.#tf=A,this.#ti.values()))A?S.disableClick():S.enableClick(),S.div.classList.toggle("waiting",A)}#tq(){if(!this.#tp)for(let A of(this.#tp=!0,this.#ti.values()))A.enable()}#tV(){if(this.unselectAll(),this.#tp)for(let A of(this.#tp=!1,this.#ti.values()))A.disable()}getEditors(A){let S=[];for(let E of this.#te.values())E.pageIndex===A&&S.push(E);return S}getEditor(A){return this.#te.get(A)}addEditor(A){this.#te.set(A.id,A)}removeEditor(A){this.#te.delete(A.id),this.unselect(A),A.annotationElementId&&this.#to.has(A.annotationElementId)||this.#tn?.remove(A.id)}addDeletedAnnotationElement(A){this.#to.add(A.annotationElementId),A.deleted=!0}isDeletedAnnotationElement(A){return this.#to.has(A)}removeDeletedAnnotationElement(A){this.#to.delete(A.annotationElementId),A.deleted=!1}#tj(A){let S=this.#ti.get(A.pageIndex);S?S.addOrRebuild(A):this.addEditor(A)}setActiveEditor(A){this.#tt!==A&&(this.#tt=A,A&&this.#tW(A.propertiesToUpdate))}toggleSelected(A){if(this.#tb.has(A)){this.#tb.delete(A),A.unselect(),this.#tH({hasSelectedEditor:this.hasSelection});return}this.#tb.add(A),A.select(),this.#tW(A.propertiesToUpdate),this.#tH({hasSelectedEditor:!0})}setSelected(A){for(let S of this.#tb)S!==A&&S.unselect();this.#tb.clear(),this.#tb.add(A),A.select(),this.#tW(A.propertiesToUpdate),this.#tH({hasSelectedEditor:!0})}isSelected(A){return this.#tb.has(A)}unselect(A){A.unselect(),this.#tb.delete(A),this.#tH({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#tb.size}undo(){this.#ts.undo(),this.#tH({hasSomethingToUndo:this.#ts.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#tG()})}redo(){this.#ts.redo(),this.#tH({hasSomethingToUndo:!0,hasSomethingToRedo:this.#ts.hasSomethingToRedo(),isEmpty:this.#tG()})}addCommands(A){this.#ts.add(A),this.#tH({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#tG()})}#tG(){if(0===this.#te.size)return!0;if(1===this.#te.size)for(let A of this.#te.values())return A.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let A=[...this.#tb],cmd=()=>{for(let S of A)S.remove()},undo=()=>{for(let S of A)this.#tj(S)};this.addCommands({cmd,undo,mustExec:!0})}commitOrRemove(){this.#tt?.commitOrRemove()}hasSomethingToControl(){return this.#tt||this.hasSelection}#tz(A){for(let S of(this.#tb.clear(),A))S.isEmpty()||(this.#tb.add(S),S.select());this.#tH({hasSelectedEditor:!0})}selectAll(){for(let A of this.#tb)A.commit();this.#tz(this.#te.values())}unselectAll(){if(this.#tt){this.#tt.commitOrRemove();return}if(this.hasSelection){for(let A of this.#tb)A.unselect();this.#tb.clear(),this.#tH({hasSelectedEditor:!1})}}translateSelectedEditors(A,S,E=!1){if(E||this.commitOrRemove(),!this.hasSelection)return;this.#tM[0]+=A,this.#tM[1]+=S;let[C,T]=this.#tM,P=[...this.#tb],M=1e3;for(let E of(this.#tR&&clearTimeout(this.#tR),this.#tR=setTimeout(()=>{this.#tR=null,this.#tM[0]=this.#tM[1]=0,this.addCommands({cmd:()=>{for(let A of P)this.#te.has(A.id)&&A.translateInPage(C,T)},undo:()=>{for(let A of P)this.#te.has(A.id)&&A.translateInPage(-C,-T)},mustExec:!1})},M),P))E.translateInPage(A,S)}setUpDragSession(){if(this.hasSelection)for(let A of(this.disableUserSelect(!0),this.#tl=new Map,this.#tb))this.#tl.set(A,{savedX:A.x,savedY:A.y,savedPageIndex:A.pageIndex,newX:0,newY:0,newPageIndex:-1})}endDragSession(){if(!this.#tl)return!1;this.disableUserSelect(!1);let A=this.#tl;this.#tl=null;let S=!1;for(let[{x:E,y:C,pageIndex:T},P]of A)P.newX=E,P.newY=C,P.newPageIndex=T,S||=E!==P.savedX||C!==P.savedY||T!==P.savedPageIndex;if(!S)return!1;let move=(A,S,E,C)=>{if(this.#te.has(A.id)){let T=this.#ti.get(C);T?A._setParentAndPosition(T,S,E):(A.pageIndex=C,A.x=S,A.y=E)}};return this.addCommands({cmd:()=>{for(let[S,{newX:E,newY:C,newPageIndex:T}]of A)move(S,E,C,T)},undo:()=>{for(let[S,{savedX:E,savedY:C,savedPageIndex:T}]of A)move(S,E,C,T)},mustExec:!0}),!0}dragSelectedEditors(A,S){if(this.#tl)for(let E of this.#tl.keys())E.drag(A,S)}rebuild(A){if(null===A.parent){let S=this.getLayer(A.pageIndex);S?(S.changeParent(A),S.addOrRebuild(A)):(this.addEditor(A),this.addToAnnotationStorage(A),A.rebuild())}else A.parent.addOrRebuild(A)}isActive(A){return this.#tt===A}getActive(){return this.#tt}getMode(){return this.#tm}get imageManager(){return(0,C.shadow)(this,"imageManager",new ImageManager)}};S.AnnotationEditorUIManager=AnnotationEditorUIManager},(A,S,E)=>{let C;Object.defineProperty(S,"__esModule",{value:!0}),S.StatTimer=S.RenderingCancelledException=S.PixelsPerInch=S.PageViewport=S.PDFDateString=S.DOMStandardFontDataFactory=S.DOMSVGFactory=S.DOMFilterFactory=S.DOMCanvasFactory=S.DOMCMapReaderFactory=void 0,S.deprecated=deprecated,S.getColorValues=getColorValues,S.getCurrentTransform=getCurrentTransform,S.getCurrentTransformInverse=getCurrentTransformInverse,S.getFilenameFromUrl=getFilenameFromUrl,S.getPdfFilenameFromUrl=getPdfFilenameFromUrl,S.getRGB=getRGB,S.getXfaPageViewport=getXfaPageViewport,S.isDataScheme=isDataScheme,S.isPdfFile=isPdfFile,S.isValidFetchUrl=isValidFetchUrl,S.loadScript=loadScript,S.noContextMenu=noContextMenu,S.setLayerDimensions=setLayerDimensions;var T=E(7),P=E(1);let M="http://www.w3.org/2000/svg";let PixelsPerInch=class PixelsPerInch{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};S.PixelsPerInch=PixelsPerInch;let DOMFilterFactory=class DOMFilterFactory extends T.BaseFilterFactory{#t$;#tX;#e;#tK;#tY;#tJ;#tQ;#tZ;#t0;#t1;#V=0;constructor({docId:A,ownerDocument:S=globalThis.document}={}){super(),this.#e=A,this.#tK=S}get #$(){return this.#t$||=new Map}get #t2(){if(!this.#tX){let A=this.#tK.createElement("div"),{style:S}=A;S.visibility="hidden",S.contain="strict",S.width=S.height=0,S.position="absolute",S.top=S.left=0,S.zIndex=-1;let E=this.#tK.createElementNS(M,"svg");E.setAttribute("width",0),E.setAttribute("height",0),this.#tX=this.#tK.createElementNS(M,"defs"),A.append(E),E.append(this.#tX),this.#tK.body.append(A)}return this.#tX}addFilter(A){let S,E,C,T;if(!A)return"none";let P=this.#$.get(A);if(P)return P;if(1===A.length){let P=A[0],M=Array(256);for(let A=0;A<256;A++)M[A]=P[A]/255;T=S=E=C=M.join(",")}else{let[P,M,R]=A,F=Array(256),I=Array(256),D=Array(256);for(let A=0;A<256;A++)F[A]=P[A]/255,I[A]=M[A]/255,D[A]=R[A]/255;S=F.join(","),E=I.join(","),C=D.join(","),T=`${S}${E}${C}`}if(P=this.#$.get(T))return this.#$.set(A,P),P;let M=`g_${this.#e}_transfer_map_${this.#V++}`,R=`url(#${M})`;this.#$.set(A,R),this.#$.set(T,R);let F=this.#t3(M);return this.#t5(S,E,C,F),R}addHCMFilter(A,S){let E=`${A}-${S}`;if(this.#tJ===E||(this.#tJ=E,this.#tQ="none",this.#tY?.remove(),!A||!S))return this.#tQ;let C=this.#t8(A);A=P.Util.makeHexColor(...C);let T=this.#t8(S);if(S=P.Util.makeHexColor(...T),this.#t2.style.color="","#000000"===A&&"#ffffff"===S||A===S)return this.#tQ;let M=Array(256);for(let A=0;A<=255;A++){let S=A/255;M[A]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}let R=M.join(","),F=`g_${this.#e}_hcm_filter`,I=this.#tZ=this.#t3(F);this.#t5(R,R,R,I),this.#t6(I);let getSteps=(A,S)=>{let E=C[A]/255,P=T[A]/255,M=Array(S+1);for(let A=0;A<=S;A++)M[A]=E+A/S*(P-E);return M.join(",")};return this.#t5(getSteps(0,5),getSteps(1,5),getSteps(2,5),I),this.#tQ=`url(#${F})`,this.#tQ}addHighlightHCMFilter(A,S,E,C){let T=`${A}-${S}-${E}-${C}`;if(this.#t0===T||(this.#t0=T,this.#t1="none",this.#tZ?.remove(),!A||!S))return this.#t1;let[P,M]=[A,S].map(this.#t8.bind(this)),R=Math.round(.2126*P[0]+.7152*P[1]+.0722*P[2]),F=Math.round(.2126*M[0]+.7152*M[1]+.0722*M[2]),[I,D]=[E,C].map(this.#t8.bind(this));F<R&&([R,F,I,D]=[F,R,D,I]),this.#t2.style.color="";let getSteps=(A,S,E)=>{let C=Array(256),T=(F-R)/E,P=A/255,M=(S-A)/(255*E),I=0;for(let A=0;A<=E;A++){let S=Math.round(R+A*T),E=P+A*M;for(let A=I;A<=S;A++)C[A]=E;I=S+1}for(let A=I;A<256;A++)C[A]=C[I-1];return C.join(",")},L=`g_${this.#e}_hcm_highlight_filter`,O=this.#tZ=this.#t3(L);return this.#t6(O),this.#t5(getSteps(I[0],D[0],5),getSteps(I[1],D[1],5),getSteps(I[2],D[2],5),O),this.#t1=`url(#${L})`,this.#t1}destroy(A=!1){A&&(this.#tQ||this.#t1)||(this.#tX&&(this.#tX.parentNode.parentNode.remove(),this.#tX=null),this.#t$&&(this.#t$.clear(),this.#t$=null),this.#V=0)}#t6(A){let S=this.#tK.createElementNS(M,"feColorMatrix");S.setAttribute("type","matrix"),S.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),A.append(S)}#t3(A){let S=this.#tK.createElementNS(M,"filter");return S.setAttribute("color-interpolation-filters","sRGB"),S.setAttribute("id",A),this.#t2.append(S),S}#t4(A,S,E){let C=this.#tK.createElementNS(M,S);C.setAttribute("type","discrete"),C.setAttribute("tableValues",E),A.append(C)}#t5(A,S,E,C){let T=this.#tK.createElementNS(M,"feComponentTransfer");C.append(T),this.#t4(T,"feFuncR",A),this.#t4(T,"feFuncG",S),this.#t4(T,"feFuncB",E)}#t8(A){return this.#t2.style.color=A,getRGB(getComputedStyle(this.#t2).getPropertyValue("color"))}};S.DOMFilterFactory=DOMFilterFactory;let DOMCanvasFactory=class DOMCanvasFactory extends T.BaseCanvasFactory{constructor({ownerDocument:A=globalThis.document}={}){super(),this._document=A}_createCanvas(A,S){let E=this._document.createElement("canvas");return E.width=A,E.height=S,E}};async function fetchData(A,S=!1){if(isValidFetchUrl(A,document.baseURI)){let E=await fetch(A);if(!E.ok)throw Error(E.statusText);return S?new Uint8Array(await E.arrayBuffer()):(0,P.stringToBytes)(await E.text())}return new Promise((E,C)=>{let T=new XMLHttpRequest;T.open("GET",A,!0),S&&(T.responseType="arraybuffer"),T.onreadystatechange=()=>{if(T.readyState===XMLHttpRequest.DONE){if(200===T.status||0===T.status){let A;if(S&&T.response?A=new Uint8Array(T.response):!S&&T.responseText&&(A=(0,P.stringToBytes)(T.responseText)),A){E(A);return}}C(Error(T.statusText))}},T.send(null)})}S.DOMCanvasFactory=DOMCanvasFactory;let DOMCMapReaderFactory=class DOMCMapReaderFactory extends T.BaseCMapReaderFactory{_fetchData(A,S){return fetchData(A,this.isCompressed).then(A=>({cMapData:A,compressionType:S}))}};S.DOMCMapReaderFactory=DOMCMapReaderFactory;let DOMStandardFontDataFactory=class DOMStandardFontDataFactory extends T.BaseStandardFontDataFactory{_fetchData(A){return fetchData(A,!0)}};S.DOMStandardFontDataFactory=DOMStandardFontDataFactory;let DOMSVGFactory=class DOMSVGFactory extends T.BaseSVGFactory{_createSVG(A){return document.createElementNS(M,A)}};S.DOMSVGFactory=DOMSVGFactory;let PageViewport=class PageViewport{constructor({viewBox:A,scale:S,rotation:E,offsetX:C=0,offsetY:T=0,dontFlip:P=!1}){let M,R,F,I,D,L,O,B;this.viewBox=A,this.scale=S,this.rotation=E,this.offsetX=C,this.offsetY=T;let N=(A[2]+A[0])/2,U=(A[3]+A[1])/2;switch((E%=360)<0&&(E+=360),E){case 180:M=-1,R=0,F=0,I=1;break;case 90:M=0,R=1,F=1,I=0;break;case 270:M=0,R=-1,F=-1,I=0;break;case 0:M=1,R=0,F=0,I=-1;break;default:throw Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}P&&(F=-F,I=-I),0===M?(D=Math.abs(U-A[1])*S+C,L=Math.abs(N-A[0])*S+T,O=(A[3]-A[1])*S,B=(A[2]-A[0])*S):(D=Math.abs(N-A[0])*S+C,L=Math.abs(U-A[1])*S+T,O=(A[2]-A[0])*S,B=(A[3]-A[1])*S),this.transform=[M*S,R*S,F*S,I*S,D-M*S*N-F*S*U,L-R*S*N-I*S*U],this.width=O,this.height=B}get rawDims(){let{viewBox:A}=this;return(0,P.shadow)(this,"rawDims",{pageWidth:A[2]-A[0],pageHeight:A[3]-A[1],pageX:A[0],pageY:A[1]})}clone({scale:A=this.scale,rotation:S=this.rotation,offsetX:E=this.offsetX,offsetY:C=this.offsetY,dontFlip:T=!1}={}){return new PageViewport({viewBox:this.viewBox.slice(),scale:A,rotation:S,offsetX:E,offsetY:C,dontFlip:T})}convertToViewportPoint(A,S){return P.Util.applyTransform([A,S],this.transform)}convertToViewportRectangle(A){let S=P.Util.applyTransform([A[0],A[1]],this.transform),E=P.Util.applyTransform([A[2],A[3]],this.transform);return[S[0],S[1],E[0],E[1]]}convertToPdfPoint(A,S){return P.Util.applyInverseTransform([A,S],this.transform)}};S.PageViewport=PageViewport;let RenderingCancelledException=class RenderingCancelledException extends P.BaseException{constructor(A,S=0){super(A,"RenderingCancelledException"),this.extraDelay=S}};function isDataScheme(A){let S=A.length,E=0;for(;E<S&&""===A[E].trim();)E++;return"data:"===A.substring(E,E+5).toLowerCase()}function isPdfFile(A){return"string"==typeof A&&/\.pdf$/i.test(A)}function getFilenameFromUrl(A,S=!1){return S||([A]=A.split(/[#?]/,1)),A.substring(A.lastIndexOf("/")+1)}function getPdfFilenameFromUrl(A,S="document.pdf"){if("string"!=typeof A)return S;if(isDataScheme(A))return(0,P.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),S;let E=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,C=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,T=E.exec(A),M=C.exec(T[1])||C.exec(T[2])||C.exec(T[3]);if(M&&(M=M[0]).includes("%"))try{M=C.exec(decodeURIComponent(M))[0]}catch{}return M||S}S.RenderingCancelledException=RenderingCancelledException;let StatTimer=class StatTimer{started=Object.create(null);times=[];time(A){A in this.started&&(0,P.warn)(`Timer is already running for ${A}`),this.started[A]=Date.now()}timeEnd(A){A in this.started||(0,P.warn)(`Timer has not been started for ${A}`),this.times.push({name:A,start:this.started[A],end:Date.now()}),delete this.started[A]}toString(){let A=[],S=0;for(let{name:A}of this.times)S=Math.max(A.length,S);for(let{name:E,start:C,end:T}of this.times)A.push(`${E.padEnd(S)} ${T-C}ms
`);return A.join("")}};function isValidFetchUrl(A,S){try{let{protocol:E}=S?new URL(A,S):new URL(A);return"http:"===E||"https:"===E}catch{return!1}}function noContextMenu(A){A.preventDefault()}function loadScript(A,S=!1){return new Promise((E,C)=>{let T=document.createElement("script");T.src=A,T.onload=function(A){S&&T.remove(),E(A)},T.onerror=function(){C(Error(`Cannot load script at: ${T.src}`))},(document.head||document.documentElement).append(T)})}function deprecated(A){console.log("Deprecated API usage: "+A)}S.StatTimer=StatTimer;let PDFDateString=class PDFDateString{static toDateObject(A){if(!A||"string"!=typeof A)return null;C||=RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let S=C.exec(A);if(!S)return null;let E=parseInt(S[1],10),T=parseInt(S[2],10);T=T>=1&&T<=12?T-1:0;let P=parseInt(S[3],10);P=P>=1&&P<=31?P:1;let M=parseInt(S[4],10);M=M>=0&&M<=23?M:0;let R=parseInt(S[5],10);R=R>=0&&R<=59?R:0;let F=parseInt(S[6],10);F=F>=0&&F<=59?F:0;let I=S[7]||"Z",D=parseInt(S[8],10);D=D>=0&&D<=23?D:0;let L=parseInt(S[9],10)||0;return L=L>=0&&L<=59?L:0,"-"===I?(M+=D,R+=L):"+"===I&&(M-=D,R-=L),new Date(Date.UTC(E,T,P,M,R,F))}};function getXfaPageViewport(A,{scale:S=1,rotation:E=0}){let{width:C,height:T}=A.attributes.style,P=[0,0,parseInt(C),parseInt(T)];return new PageViewport({viewBox:P,scale:S,rotation:E})}function getRGB(A){if(A.startsWith("#")){let S=parseInt(A.slice(1),16);return[(16711680&S)>>16,(65280&S)>>8,255&S]}return A.startsWith("rgb(")?A.slice(4,-1).split(",").map(A=>parseInt(A)):A.startsWith("rgba(")?A.slice(5,-1).split(",").map(A=>parseInt(A)).slice(0,3):((0,P.warn)(`Not a valid color format: "${A}"`),[0,0,0])}function getColorValues(A){let S=document.createElement("span");for(let E of(S.style.visibility="hidden",document.body.append(S),A.keys())){S.style.color=E;let C=window.getComputedStyle(S).color;A.set(E,getRGB(C))}S.remove()}function getCurrentTransform(A){let{a:S,b:E,c:C,d:T,e:P,f:M}=A.getTransform();return[S,E,C,T,P,M]}function getCurrentTransformInverse(A){let{a:S,b:E,c:C,d:T,e:P,f:M}=A.getTransform().invertSelf();return[S,E,C,T,P,M]}function setLayerDimensions(A,S,E=!1,C=!0){if(S instanceof PageViewport){let{pageWidth:C,pageHeight:T}=S.rawDims,{style:M}=A,R=P.FeatureTest.isCSSRoundSupported,F=`var(--scale-factor) * ${C}px`,I=`var(--scale-factor) * ${T}px`,D=R?`round(${F}, 1px)`:`calc(${F})`,L=R?`round(${I}, 1px)`:`calc(${I})`;E&&S.rotation%180!=0?(M.width=L,M.height=D):(M.width=D,M.height=L)}C&&A.setAttribute("data-main-rotation",S.rotation)}S.PDFDateString=PDFDateString},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.BaseStandardFontDataFactory=S.BaseSVGFactory=S.BaseFilterFactory=S.BaseCanvasFactory=S.BaseCMapReaderFactory=void 0;var C=E(1);let BaseFilterFactory=class BaseFilterFactory{constructor(){this.constructor===BaseFilterFactory&&(0,C.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(A){return"none"}addHCMFilter(A,S){return"none"}addHighlightHCMFilter(A,S,E,C){return"none"}destroy(A=!1){}};S.BaseFilterFactory=BaseFilterFactory;let BaseCanvasFactory=class BaseCanvasFactory{constructor(){this.constructor===BaseCanvasFactory&&(0,C.unreachable)("Cannot initialize BaseCanvasFactory.")}create(A,S){if(A<=0||S<=0)throw Error("Invalid canvas size");let E=this._createCanvas(A,S);return{canvas:E,context:E.getContext("2d")}}reset(A,S,E){if(!A.canvas)throw Error("Canvas is not specified");if(S<=0||E<=0)throw Error("Invalid canvas size");A.canvas.width=S,A.canvas.height=E}destroy(A){if(!A.canvas)throw Error("Canvas is not specified");A.canvas.width=0,A.canvas.height=0,A.canvas=null,A.context=null}_createCanvas(A,S){(0,C.unreachable)("Abstract method `_createCanvas` called.")}};S.BaseCanvasFactory=BaseCanvasFactory;let BaseCMapReaderFactory=class BaseCMapReaderFactory{constructor({baseUrl:A=null,isCompressed:S=!0}){this.constructor===BaseCMapReaderFactory&&(0,C.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=A,this.isCompressed=S}async fetch({name:A}){if(!this.baseUrl)throw Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!A)throw Error("CMap name must be specified.");let S=this.baseUrl+A+(this.isCompressed?".bcmap":""),E=this.isCompressed?C.CMapCompressionType.BINARY:C.CMapCompressionType.NONE;return this._fetchData(S,E).catch(A=>{throw Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${S}`)})}_fetchData(A,S){(0,C.unreachable)("Abstract method `_fetchData` called.")}};S.BaseCMapReaderFactory=BaseCMapReaderFactory;let BaseStandardFontDataFactory=class BaseStandardFontDataFactory{constructor({baseUrl:A=null}){this.constructor===BaseStandardFontDataFactory&&(0,C.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=A}async fetch({filename:A}){if(!this.baseUrl)throw Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!A)throw Error("Font filename must be specified.");let S=`${this.baseUrl}${A}`;return this._fetchData(S).catch(A=>{throw Error(`Unable to load font data at: ${S}`)})}_fetchData(A){(0,C.unreachable)("Abstract method `_fetchData` called.")}};S.BaseStandardFontDataFactory=BaseStandardFontDataFactory;let BaseSVGFactory=class BaseSVGFactory{constructor(){this.constructor===BaseSVGFactory&&(0,C.unreachable)("Cannot initialize BaseSVGFactory.")}create(A,S,E=!1){if(A<=0||S<=0)throw Error("Invalid SVG dimensions");let C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),E||(C.setAttribute("width",`${A}px`),C.setAttribute("height",`${S}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${A} ${S}`),C}createElement(A){if("string"!=typeof A)throw Error("Invalid SVG element type");return this._createSVG(A)}_createSVG(A){(0,C.unreachable)("Abstract method `_createSVG` called.")}};S.BaseSVGFactory=BaseSVGFactory},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.MurmurHash3_64=void 0;var C=E(1);let T=3285377520,P=4294901760,M=65535;let MurmurHash3_64=class MurmurHash3_64{constructor(A){this.h1=A?4294967295&A:T,this.h2=A?4294967295&A:T}update(A){let S,E;if("string"==typeof A){S=new Uint8Array(2*A.length),E=0;for(let C=0,T=A.length;C<T;C++){let T=A.charCodeAt(C);T<=255?S[E++]=T:(S[E++]=T>>>8,S[E++]=255&T)}}else if((0,C.isArrayBuffer)(A))E=(S=A.slice()).byteLength;else throw Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");let T=E>>2,R=E-4*T,F=new Uint32Array(S.buffer,0,T),I=0,D=0,L=this.h1,O=this.h2,B=3432918353,N=461845907,U=B&M,z=N&M;for(let A=0;A<T;A++)1&A?(L^=I=(I=(I=(I=F[A])*B&P|I*U&M)<<15|I>>>17)*N&P|I*z&M,L=5*(L=L<<13|L>>>19)+3864292196):(O^=D=(D=(D=(D=F[A])*B&P|D*U&M)<<15|D>>>17)*N&P|D*z&M,O=5*(O=O<<13|O>>>19)+3864292196);switch(I=0,R){case 3:I^=S[4*T+2]<<16;case 2:I^=S[4*T+1]<<8;case 1:I^=S[4*T],I=(I=(I=I*B&P|I*U&M)<<15|I>>>17)*N&P|I*z&M,1&T?L^=I:O^=I}this.h1=L,this.h2=O}hexdigest(){let A=this.h1,S=this.h2;return A^=S>>>1,A=3981806797*A&P|36045*A&M,S=4283543511*S&P|((S<<16|A>>>16)*2950163797&P)>>>16,A^=S>>>1,A=444984403*A&P|60499*A&M,S=3301882366*S&P|((S<<16|A>>>16)*3120437893&P)>>>16,((A^=S>>>1)>>>0).toString(16).padStart(8,"0")+(S>>>0).toString(16).padStart(8,"0")}};S.MurmurHash3_64=MurmurHash3_64},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.FontLoader=S.FontFaceObject=void 0;var C=E(1);let FontLoader=class FontLoader{#t7=new Set;constructor({ownerDocument:A=globalThis.document,styleElement:S=null}){this._document=A,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(A){this.nativeFontFaces.add(A),this._document.fonts.add(A)}removeNativeFontFace(A){this.nativeFontFaces.delete(A),this._document.fonts.delete(A)}insertRule(A){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let S=this.styleElement.sheet;S.insertRule(A,S.cssRules.length)}clear(){for(let A of this.nativeFontFaces)this._document.fonts.delete(A);this.nativeFontFaces.clear(),this.#t7.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(A){if(!(!A||this.#t7.has(A.loadedName))){if((0,C.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:S,src:E,style:T}=A,P=new FontFace(S,E,T);this.addNativeFontFace(P);try{await P.load(),this.#t7.add(S)}catch{(0,C.warn)(`Cannot load system font: ${A.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(P)}return}(0,C.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(A){if(A.attached||A.missingFile&&!A.systemFontInfo)return;if(A.attached=!0,A.systemFontInfo){await this.loadSystemFont(A.systemFontInfo);return}if(this.isFontLoadingAPISupported){let S=A.createNativeFontFace();if(S){this.addNativeFontFace(S);try{await S.loaded}catch(E){throw(0,C.warn)(`Failed to load font '${S.family}': '${E}'.`),A.disableFontFace=!0,E}}return}let S=A.createFontFaceRule();if(S){if(this.insertRule(S),this.isSyncFontLoadingSupported)return;await new Promise(S=>{let E=this._queueLoadingCallback(S);this._prepareFontLoadEvent(A,E)})}}get isFontLoadingAPISupported(){let A=!!this._document?.fonts;return(0,C.shadow)(this,"isFontLoadingAPISupported",A)}get isSyncFontLoadingSupported(){let A=!1;return C.isNodeJS?A=!0:"undefined"!=typeof navigator&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent)&&(A=!0),(0,C.shadow)(this,"isSyncFontLoadingSupported",A)}_queueLoadingCallback(A){function completeRequest(){for((0,C.assert)(!E.done,"completeRequest() cannot be called twice."),E.done=!0;S.length>0&&S[0].done;){let A=S.shift();setTimeout(A.callback,0)}}let{loadingRequests:S}=this,E={done:!1,complete:completeRequest,callback:A};return S.push(E),E}get _loadTestFont(){let A=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,C.shadow)(this,"_loadTestFont",A)}_prepareFontLoadEvent(A,S){let E,T;function int32(A,S){return A.charCodeAt(S)<<24|A.charCodeAt(S+1)<<16|A.charCodeAt(S+2)<<8|255&A.charCodeAt(S+3)}function spliceString(A,S,E,C){let T=A.substring(0,S),P=A.substring(S+E);return T+C+P}let P=this._document.createElement("canvas");P.width=1,P.height=1;let M=P.getContext("2d"),R=0;function isFontReady(A,S){if(++R>30){(0,C.warn)("Load test font never loaded."),S();return}M.font="30px "+A,M.fillText(".",0,20);let E=M.getImageData(0,0,1,1);if(E.data[3]>0){S();return}setTimeout(isFontReady.bind(null,A,S))}let F=`lt${Date.now()}${this.loadTestFontId++}`,I=this._loadTestFont,D=976;I=spliceString(I,D,F.length,F);let L=16,O=1482184792,B=int32(I,L);for(E=0,T=F.length-3;E<T;E+=4)B=B-O+int32(F,E)|0;E<F.length&&(B=B-O+int32(F+"XXX",E)|0),I=spliceString(I,L,4,(0,C.string32)(B));let N=`url(data:font/opentype;base64,${btoa(I)});`,U=`@font-face {font-family:"${F}";src:${N}}`;this.insertRule(U);let z=this._document.createElement("div");for(let S of(z.style.visibility="hidden",z.style.width=z.style.height="10px",z.style.position="absolute",z.style.top=z.style.left="0px",[A.loadedName,F])){let A=this._document.createElement("span");A.textContent="Hi",A.style.fontFamily=S,z.append(A)}this._document.body.append(z),isFontReady(F,()=>{z.remove(),S.complete()})}};S.FontLoader=FontLoader;let FontFaceObject=class FontFaceObject{constructor(A,{isEvalSupported:S=!0,disableFontFace:E=!1,ignoreErrors:C=!1,inspectFont:T=null}){for(let S in this.compiledGlyphs=Object.create(null),A)this[S]=A[S];this.isEvalSupported=!1!==S,this.disableFontFace=!0===E,this.ignoreErrors=!0===C,this._inspectFont=T}createNativeFontFace(){let A;if(!this.data||this.disableFontFace)return null;if(this.cssFontInfo){let S={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(S.style=`oblique ${this.cssFontInfo.italicAngle}deg`),A=new FontFace(this.cssFontInfo.fontFamily,this.data,S)}else A=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),A}createFontFaceRule(){let A;if(!this.data||this.disableFontFace)return null;let S=(0,C.bytesToString)(this.data),E=`url(data:${this.mimetype};base64,${btoa(S)});`;if(this.cssFontInfo){let S=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(S+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),A=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${S}src:${E}}`}else A=`@font-face {font-family:"${this.loadedName}";src:${E}}`;return this._inspectFont?.(this,E),A}getPathGenerator(A,S){let E;if(void 0!==this.compiledGlyphs[S])return this.compiledGlyphs[S];try{E=A.get(this.loadedName+"_path_"+S)}catch(A){if(!this.ignoreErrors)throw A;return(0,C.warn)(`getPathGenerator - ignoring character: "${A}".`),this.compiledGlyphs[S]=function(A,S){}}if(this.isEvalSupported&&C.FeatureTest.isEvalSupported){let A=[];for(let S of E){let E=void 0!==S.args?S.args.join(","):"";A.push("c.",S.cmd,"(",E,");\n")}return this.compiledGlyphs[S]=Function("c","size",A.join(""))}return this.compiledGlyphs[S]=function(A,S){for(let C of E)"scale"===C.cmd&&(C.args=[S,-S]),A[C.cmd].apply(A,C.args)}}};S.FontFaceObject=FontFaceObject},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.NodeStandardFontDataFactory=S.NodeFilterFactory=S.NodeCanvasFactory=S.NodeCMapReaderFactory=void 0;var C=E(7);E(1);let fetchData=function(A){return new Promise((S,E)=>{let C=__webpack_require__(172);C.readFile(A,(A,C)=>{if(A||!C){E(Error(A));return}S(new Uint8Array(C))})})};let NodeFilterFactory=class NodeFilterFactory extends C.BaseFilterFactory{};S.NodeFilterFactory=NodeFilterFactory;let NodeCanvasFactory=class NodeCanvasFactory extends C.BaseCanvasFactory{_createCanvas(A,S){let E=__webpack_require__(3414);return E.createCanvas(A,S)}};S.NodeCanvasFactory=NodeCanvasFactory;let NodeCMapReaderFactory=class NodeCMapReaderFactory extends C.BaseCMapReaderFactory{_fetchData(A,S){return fetchData(A).then(A=>({cMapData:A,compressionType:S}))}};S.NodeCMapReaderFactory=NodeCMapReaderFactory;let NodeStandardFontDataFactory=class NodeStandardFontDataFactory extends C.BaseStandardFontDataFactory{_fetchData(A){return fetchData(A)}};S.NodeStandardFontDataFactory=NodeStandardFontDataFactory},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.CanvasGraphics=void 0;var C=E(1),T=E(6),P=E(12),M=E(13);let R=16,F=100,I=4096,D=15,L=10,O=1e3,B=16;function mirrorContextOperations(A,S){if(A._removeMirroring)throw Error("Context is already forwarding operations.");A.__originalSave=A.save,A.__originalRestore=A.restore,A.__originalRotate=A.rotate,A.__originalScale=A.scale,A.__originalTranslate=A.translate,A.__originalTransform=A.transform,A.__originalSetTransform=A.setTransform,A.__originalResetTransform=A.resetTransform,A.__originalClip=A.clip,A.__originalMoveTo=A.moveTo,A.__originalLineTo=A.lineTo,A.__originalBezierCurveTo=A.bezierCurveTo,A.__originalRect=A.rect,A.__originalClosePath=A.closePath,A.__originalBeginPath=A.beginPath,A._removeMirroring=()=>{A.save=A.__originalSave,A.restore=A.__originalRestore,A.rotate=A.__originalRotate,A.scale=A.__originalScale,A.translate=A.__originalTranslate,A.transform=A.__originalTransform,A.setTransform=A.__originalSetTransform,A.resetTransform=A.__originalResetTransform,A.clip=A.__originalClip,A.moveTo=A.__originalMoveTo,A.lineTo=A.__originalLineTo,A.bezierCurveTo=A.__originalBezierCurveTo,A.rect=A.__originalRect,A.closePath=A.__originalClosePath,A.beginPath=A.__originalBeginPath,delete A._removeMirroring},A.save=function(){S.save(),this.__originalSave()},A.restore=function(){S.restore(),this.__originalRestore()},A.translate=function(A,E){S.translate(A,E),this.__originalTranslate(A,E)},A.scale=function(A,E){S.scale(A,E),this.__originalScale(A,E)},A.transform=function(A,E,C,T,P,M){S.transform(A,E,C,T,P,M),this.__originalTransform(A,E,C,T,P,M)},A.setTransform=function(A,E,C,T,P,M){S.setTransform(A,E,C,T,P,M),this.__originalSetTransform(A,E,C,T,P,M)},A.resetTransform=function(){S.resetTransform(),this.__originalResetTransform()},A.rotate=function(A){S.rotate(A),this.__originalRotate(A)},A.clip=function(A){S.clip(A),this.__originalClip(A)},A.moveTo=function(A,E){S.moveTo(A,E),this.__originalMoveTo(A,E)},A.lineTo=function(A,E){S.lineTo(A,E),this.__originalLineTo(A,E)},A.bezierCurveTo=function(A,E,C,T,P,M){S.bezierCurveTo(A,E,C,T,P,M),this.__originalBezierCurveTo(A,E,C,T,P,M)},A.rect=function(A,E,C,T){S.rect(A,E,C,T),this.__originalRect(A,E,C,T)},A.closePath=function(){S.closePath(),this.__originalClosePath()},A.beginPath=function(){S.beginPath(),this.__originalBeginPath()}}let CachedCanvases=class CachedCanvases{constructor(A){this.canvasFactory=A,this.cache=Object.create(null)}getCanvas(A,S,E){let C;return void 0!==this.cache[A]?(C=this.cache[A],this.canvasFactory.reset(C,S,E)):(C=this.canvasFactory.create(S,E),this.cache[A]=C),C}delete(A){delete this.cache[A]}clear(){for(let A in this.cache){let S=this.cache[A];this.canvasFactory.destroy(S),delete this.cache[A]}}};function drawImageAtIntegerCoords(A,S,E,C,P,M,R,F,I,D){let[L,O,B,N,U,z]=(0,T.getCurrentTransform)(A);if(0===O&&0===B){let T=R*L+U,H=Math.round(T),W=F*N+z,V=Math.round(W),$=(R+I)*L+U,X=Math.abs(Math.round($)-H)||1,K=(F+D)*N+z,Y=Math.abs(Math.round(K)-V)||1;return A.setTransform(Math.sign(L),0,0,Math.sign(N),H,V),A.drawImage(S,E,C,P,M,0,0,X,Y),A.setTransform(L,O,B,N,U,z),[X,Y]}if(0===L&&0===N){let T=F*B+U,H=Math.round(T),W=R*O+z,V=Math.round(W),$=(F+D)*B+U,X=Math.abs(Math.round($)-H)||1,K=(R+I)*O+z,Y=Math.abs(Math.round(K)-V)||1;return A.setTransform(0,Math.sign(O),Math.sign(B),0,H,V),A.drawImage(S,E,C,P,M,0,0,Y,X),A.setTransform(L,O,B,N,U,z),[Y,X]}A.drawImage(S,E,C,P,M,R,F,I,D);let H=Math.hypot(L,O),W=Math.hypot(B,N);return[H*I,W*D]}function compileType3Glyph(A){let S,E,C;let{width:T,height:P}=A;if(T>O||P>O)return null;let M=1e3,R=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),F=T+1,I=new Uint8Array(F*(P+1)),D=T+7&-8,L=new Uint8Array(D*P),B=0;for(let S of A.data){let A=128;for(;A>0;)L[B++]=S&A?0:255,A>>=1}let N=0;for(0!==L[B=0]&&(I[0]=1,++N),E=1;E<T;E++)L[B]!==L[B+1]&&(I[E]=L[B]?2:1,++N),B++;for(0!==L[B]&&(I[E]=2,++N),S=1;S<P;S++){B=S*D,C=S*F,L[B-D]!==L[B]&&(I[C]=L[B]?1:8,++N);let A=(L[B]?4:0)+(L[B-D]?8:0);for(E=1;E<T;E++)R[A=(A>>2)+(L[B+1]?4:0)+(L[B-D+1]?8:0)]&&(I[C+E]=R[A],++N),B++;if(L[B-D]!==L[B]&&(I[C+E]=L[B]?2:4,++N),N>M)return null}for(B=D*(P-1),C=S*F,0!==L[B]&&(I[C]=8,++N),E=1;E<T;E++)L[B]!==L[B+1]&&(I[C+E]=L[B]?4:8,++N),B++;if(0!==L[B]&&(I[C+E]=4,++N),N>M)return null;let U=new Int32Array([0,F,-1,0,-F,0,0,0,1]),z=new Path2D;for(S=0;N&&S<=P;S++){let A=S*F,E=A+T;for(;A<E&&!I[A];)A++;if(A===E)continue;z.moveTo(A%F,S);let C=A,P=I[A];do{let S=U[P];do A+=S;while(!I[A]);let E=I[A];5!==E&&10!==E?(P=E,I[A]=0):(P=E&51*P>>4,I[A]&=P>>2|P<<2),z.lineTo(A%F,A/F|0),!I[A]&&--N}while(C!==A);--S}L=null,I=null;let drawOutline=function(A){A.save(),A.scale(1/T,-1/P),A.translate(0,-P),A.fill(z),A.beginPath(),A.restore()};return drawOutline}let CanvasExtraState=class CanvasExtraState{constructor(A,S){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=C.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=C.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=C.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,A,S])}clone(){let A=Object.create(this);return A.clipBox=this.clipBox.slice(),A}setCurrentPoint(A,S){this.x=A,this.y=S}updatePathMinMax(A,S,E){[S,E]=C.Util.applyTransform([S,E],A),this.minX=Math.min(this.minX,S),this.minY=Math.min(this.minY,E),this.maxX=Math.max(this.maxX,S),this.maxY=Math.max(this.maxY,E)}updateRectMinMax(A,S){let E=C.Util.applyTransform(S,A),T=C.Util.applyTransform(S.slice(2),A);this.minX=Math.min(this.minX,E[0],T[0]),this.minY=Math.min(this.minY,E[1],T[1]),this.maxX=Math.max(this.maxX,E[0],T[0]),this.maxY=Math.max(this.maxY,E[1],T[1])}updateScalingPathMinMax(A,S){C.Util.scaleMinMax(A,S),this.minX=Math.min(this.minX,S[0]),this.maxX=Math.max(this.maxX,S[1]),this.minY=Math.min(this.minY,S[2]),this.maxY=Math.max(this.maxY,S[3])}updateCurvePathMinMax(A,S,E,T,P,M,R,F,I,D){let L=C.Util.bezierBoundingBox(S,E,T,P,M,R,F,I);if(D){D[0]=Math.min(D[0],L[0],L[2]),D[1]=Math.max(D[1],L[0],L[2]),D[2]=Math.min(D[2],L[1],L[3]),D[3]=Math.max(D[3],L[1],L[3]);return}this.updateRectMinMax(A,L)}getPathBoundingBox(A=P.PathType.FILL,S=null){let E=[this.minX,this.minY,this.maxX,this.maxY];if(A===P.PathType.STROKE){S||(0,C.unreachable)("Stroke bounding box must include transform.");let A=C.Util.singularValueDecompose2dScale(S),T=A[0]*this.lineWidth/2,P=A[1]*this.lineWidth/2;E[0]-=T,E[1]-=P,E[2]+=T,E[3]+=P}return E}updateClipFromPath(){let A=C.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(A||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(A){this.clipBox=A,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(A=P.PathType.FILL,S=null){return C.Util.intersect(this.clipBox,this.getPathBoundingBox(A,S))}};function putBinaryImageData(A,S){let E,T,P,M;if("undefined"!=typeof ImageData&&S instanceof ImageData){A.putImageData(S,0,0);return}let R=S.height,F=S.width,I=R%B,D=(R-I)/B,L=0===I?D:D+1,O=A.createImageData(F,B),N=0,U,z=S.data,H=O.data;if(S.kind===C.ImageKind.GRAYSCALE_1BPP){let S=z.byteLength,M=new Uint32Array(H.buffer,0,H.byteLength>>2),R=M.length,W=F+7>>3,V=4294967295,$=C.FeatureTest.isLittleEndian?4278190080:255;for(E=0;E<L;E++){for(T=0,P=E<D?B:I,U=0;T<P;T++){let A=S-N,E=0,C=A>W?F:8*A-7,T=-8&C,P=0,R=0;for(;E<T;E+=8)R=z[N++],M[U++]=128&R?V:$,M[U++]=64&R?V:$,M[U++]=32&R?V:$,M[U++]=16&R?V:$,M[U++]=8&R?V:$,M[U++]=4&R?V:$,M[U++]=2&R?V:$,M[U++]=1&R?V:$;for(;E<C;E++)0===P&&(R=z[N++],P=128),M[U++]=R&P?V:$,P>>=1}for(;U<R;)M[U++]=0;A.putImageData(O,0,E*B)}}else if(S.kind===C.ImageKind.RGBA_32BPP){for(E=0,T=0,M=F*B*4;E<D;E++)H.set(z.subarray(N,N+M)),N+=M,A.putImageData(O,0,T),T+=B;E<L&&(M=F*I*4,H.set(z.subarray(N,N+M)),A.putImageData(O,0,T))}else if(S.kind===C.ImageKind.RGB_24BPP)for(E=0,M=F*(P=B);E<L;E++){for(E>=D&&(M=F*(P=I)),U=0,T=M;T--;)H[U++]=z[N++],H[U++]=z[N++],H[U++]=z[N++],H[U++]=255;A.putImageData(O,0,E*B)}else throw Error(`bad image kind: ${S.kind}`)}function putBinaryImageMask(A,S){if(S.bitmap){A.drawImage(S.bitmap,0,0);return}let E=S.height,C=S.width,T=E%B,P=(E-T)/B,R=0===T?P:P+1,F=A.createImageData(C,B),I=0,D=S.data,L=F.data;for(let S=0;S<R;S++){let E=S<P?B:T;({srcPos:I}=(0,M.convertBlackAndWhiteToRGBA)({src:D,srcPos:I,dest:L,width:C,height:E,nonBlackColor:0})),A.putImageData(F,0,S*B)}}function copyCtxState(A,S){let E=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let C of E)void 0!==A[C]&&(S[C]=A[C]);void 0!==A.setLineDash&&(S.setLineDash(A.getLineDash()),S.lineDashOffset=A.lineDashOffset)}function resetCtxToDefault(A){if(A.strokeStyle=A.fillStyle="#000000",A.fillRule="nonzero",A.globalAlpha=1,A.lineWidth=1,A.lineCap="butt",A.lineJoin="miter",A.miterLimit=10,A.globalCompositeOperation="source-over",A.font="10px sans-serif",void 0!==A.setLineDash&&(A.setLineDash([]),A.lineDashOffset=0),!C.isNodeJS){let{filter:S}=A;"none"!==S&&""!==S&&(A.filter="none")}}function composeSMaskBackdrop(A,S,E,C){let T=A.length;for(let P=3;P<T;P+=4){let T=A[P];if(0===T)A[P-3]=S,A[P-2]=E,A[P-1]=C;else if(T<255){let M=255-T;A[P-3]=A[P-3]*T+S*M>>8,A[P-2]=A[P-2]*T+E*M>>8,A[P-1]=A[P-1]*T+C*M>>8}}}function composeSMaskAlpha(A,S,E){let C=A.length,T=1/255;for(let P=3;P<C;P+=4){let C=E?E[A[P]]:A[P];S[P]=S[P]*C*T|0}}function composeSMaskLuminosity(A,S,E){let C=A.length;for(let T=3;T<C;T+=4){let C=77*A[T-3]+152*A[T-2]+28*A[T-1];S[T]=E?S[T]*E[C>>8]>>8:S[T]*C>>16}}function genericComposeSMask(A,S,E,C,T,P,M,R,F,I,D){let L=!!P,O=L?P[0]:0,B=L?P[1]:0,N=L?P[2]:0,U="Luminosity"===T?composeSMaskLuminosity:composeSMaskAlpha,z=1048576,H=Math.min(C,Math.ceil(z/E));for(let T=0;T<C;T+=H){let P=Math.min(H,C-T),z=A.getImageData(R-I,T+(F-D),E,P),W=S.getImageData(R,T+F,E,P);L&&composeSMaskBackdrop(z.data,O,B,N),U(z.data,W.data,M),S.putImageData(W,R,T+F)}}function composeSMask(A,S,E,C){let T=C[0],P=C[1],M=C[2]-T,R=C[3]-P;0!==M&&0!==R&&(genericComposeSMask(S.context,E,M,R,S.subtype,S.backdrop,S.transferMap,T,P,S.offsetX,S.offsetY),A.save(),A.globalAlpha=1,A.globalCompositeOperation="source-over",A.setTransform(1,0,0,1,0,0),A.drawImage(E.canvas,0,0),A.restore())}function getImageSmoothingEnabled(A,S){let E=C.Util.singularValueDecompose2dScale(A);E[0]=Math.fround(E[0]),E[1]=Math.fround(E[1]);let P=Math.fround((globalThis.devicePixelRatio||1)*T.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==S?S:E[0]<=P||E[1]<=P}let N=["butt","round","square"],U=["miter","round","bevel"],z={},H={};let CanvasGraphics=class CanvasGraphics{constructor(A,S,E,C,T,{optionalContentConfig:P,markedContentStack:M=null},R,F){this.ctx=A,this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=S,this.objs=E,this.canvasFactory=C,this.filterFactory=T,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=M||[],this.optionalContentConfig=P,this.cachedCanvases=new CachedCanvases(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=R,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=F,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(A,S=null){return"string"==typeof A?A.startsWith("g_")?this.commonObjs.get(A):this.objs.get(A):S}beginDrawing({transform:A,viewport:S,transparency:E=!1,background:C=null}){let P=this.ctx.canvas.width,M=this.ctx.canvas.height,R=this.ctx.fillStyle;if(this.ctx.fillStyle=C||"#ffffff",this.ctx.fillRect(0,0,P,M),this.ctx.fillStyle=R,E){let A=this.cachedCanvases.getCanvas("transparent",P,M);this.compositeCtx=this.ctx,this.transparentCanvas=A.canvas,this.ctx=A.context,this.ctx.save(),this.ctx.transform(...(0,T.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),resetCtxToDefault(this.ctx),A&&(this.ctx.transform(...A),this.outputScaleX=A[0],this.outputScaleY=A[0]),this.ctx.transform(...S.transform),this.viewportScale=S.scale,this.baseTransform=(0,T.getCurrentTransform)(this.ctx)}executeOperatorList(A,S,E,T){let P;let M=A.argsArray,R=A.fnArray,F=S||0,I=M.length;if(I===F)return F;let O=I-F>L&&"function"==typeof E,B=O?Date.now()+D:0,N=0,U=this.commonObjs,z=this.objs;for(;;){if(void 0!==T&&F===T.nextBreakPoint)return T.breakIt(F,E),F;if((P=R[F])!==C.OPS.dependency)this[P].apply(this,M[F]);else for(let A of M[F]){let S=A.startsWith("g_")?U:z;if(!S.has(A))return S.get(A,E),F}if(++F===I)return F;if(O&&++N>L){if(Date.now()>B)return E(),F;N=0}}}#t9(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){for(let A of(this.#t9(),this.cachedCanvases.clear(),this.cachedPatterns.clear(),this._cachedBitmapsMap.values())){for(let S of A.values())"undefined"!=typeof HTMLCanvasElement&&S instanceof HTMLCanvasElement&&(S.width=S.height=0);A.clear()}this._cachedBitmapsMap.clear(),this.#et()}#et(){if(this.pageColors){let A=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==A){let S=this.ctx.filter;this.ctx.filter=A,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=S}}}_scaleImage(A,S){let E,C;let T=A.width,P=A.height,M=Math.max(Math.hypot(S[0],S[1]),1),R=Math.max(Math.hypot(S[2],S[3]),1),F=T,I=P,D="prescale1";for(;M>2&&F>1||R>2&&I>1;){let S=F,T=I;M>2&&F>1&&(S=F>=16384?Math.floor(F/2)-1||1:Math.ceil(F/2),M/=F/S),R>2&&I>1&&(T=I>=16384?Math.floor(I/2)-1||1:Math.ceil(I)/2,R/=I/T),(C=(E=this.cachedCanvases.getCanvas(D,S,T)).context).clearRect(0,0,S,T),C.drawImage(A,0,0,F,I,0,0,S,T),A=E.canvas,F=S,I=T,D="prescale1"===D?"prescale2":"prescale1"}return{img:A,paintWidth:F,paintHeight:I}}_createMaskCanvas(A){let S,E,M,R;let F=this.ctx,{width:I,height:D}=A,L=this.current.fillColor,O=this.current.patternFill,B=(0,T.getCurrentTransform)(F);if((A.bitmap||A.data)&&A.count>1){let C=A.bitmap||A.data.buffer;E=JSON.stringify(O?B:[B.slice(0,4),L]),(S=this._cachedBitmapsMap.get(C))||(S=new Map,this._cachedBitmapsMap.set(C,S));let T=S.get(E);if(T&&!O){let A=Math.round(Math.min(B[0],B[2])+B[4]),S=Math.round(Math.min(B[1],B[3])+B[5]);return{canvas:T,offsetX:A,offsetY:S}}M=T}M||putBinaryImageMask((R=this.cachedCanvases.getCanvas("maskCanvas",I,D)).context,A);let N=C.Util.transform(B,[1/I,0,0,-1/D,0,0]);N=C.Util.transform(N,[1,0,0,1,0,-D]);let U=C.Util.applyTransform([0,0],N),z=C.Util.applyTransform([I,D],N),H=C.Util.normalizeRect([U[0],U[1],z[0],z[1]]),W=Math.round(H[2]-H[0])||1,V=Math.round(H[3]-H[1])||1,$=this.cachedCanvases.getCanvas("fillCanvas",W,V),X=$.context,K=Math.min(U[0],z[0]),Y=Math.min(U[1],z[1]);X.translate(-K,-Y),X.transform(...N),!M&&(M=(M=this._scaleImage(R.canvas,(0,T.getCurrentTransformInverse)(X))).img,S&&O&&S.set(E,M)),X.imageSmoothingEnabled=getImageSmoothingEnabled((0,T.getCurrentTransform)(X),A.interpolate),drawImageAtIntegerCoords(X,M,0,0,M.width,M.height,0,0,I,D),X.globalCompositeOperation="source-in";let J=C.Util.transform((0,T.getCurrentTransformInverse)(X),[1,0,0,1,-K,-Y]);return X.fillStyle=O?L.getPattern(F,this,J,P.PathType.FILL):L,X.fillRect(0,0,I,D),S&&!O&&(this.cachedCanvases.delete("fillCanvas"),S.set(E,$.canvas)),{canvas:$.canvas,offsetX:Math.round(K),offsetY:Math.round(Y)}}setLineWidth(A){A!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=A,this.ctx.lineWidth=A}setLineCap(A){this.ctx.lineCap=N[A]}setLineJoin(A){this.ctx.lineJoin=U[A]}setMiterLimit(A){this.ctx.miterLimit=A}setDash(A,S){let E=this.ctx;void 0!==E.setLineDash&&(E.setLineDash(A),E.lineDashOffset=S)}setRenderingIntent(A){}setFlatness(A){}setGState(A){for(let[S,E]of A)switch(S){case"LW":this.setLineWidth(E);break;case"LC":this.setLineCap(E);break;case"LJ":this.setLineJoin(E);break;case"ML":this.setMiterLimit(E);break;case"D":this.setDash(E[0],E[1]);break;case"RI":this.setRenderingIntent(E);break;case"FL":this.setFlatness(E);break;case"Font":this.setFont(E[0],E[1]);break;case"CA":this.current.strokeAlpha=E;break;case"ca":this.current.fillAlpha=E,this.ctx.globalAlpha=E;break;case"BM":this.ctx.globalCompositeOperation=E;break;case"SMask":this.current.activeSMask=E?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(E)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let A=this.inSMaskMode;this.current.activeSMask&&!A?this.beginSMaskMode():!this.current.activeSMask&&A&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw Error("beginSMaskMode called while already in smask mode");let A=this.ctx.canvas.width,S=this.ctx.canvas.height,E="smaskGroupAt"+this.groupLevel,C=this.cachedCanvases.getCanvas(E,A,S);this.suspendedCtx=this.ctx,this.ctx=C.context;let P=this.ctx;P.setTransform(...(0,T.getCurrentTransform)(this.suspendedCtx)),copyCtxState(this.suspendedCtx,P),mirrorContextOperations(P,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),copyCtxState(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(A){if(!this.current.activeSMask)return;A?(A[0]=Math.floor(A[0]),A[1]=Math.floor(A[1]),A[2]=Math.ceil(A[2]),A[3]=Math.ceil(A[3])):A=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let S=this.current.activeSMask,E=this.suspendedCtx;composeSMask(E,S,this.ctx,A),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(copyCtxState(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let A=this.current;this.stateStack.push(A),this.current=A.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),copyCtxState(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(A,S,E,C,T,P){this.ctx.transform(A,S,E,C,T,P),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(A,S,E){let P,M;let R=this.ctx,F=this.current,I=F.x,D=F.y,L=(0,T.getCurrentTransform)(R),O=0===L[0]&&0===L[3]||0===L[1]&&0===L[2],B=O?E.slice(0):null;for(let E=0,T=0,N=A.length;E<N;E++)switch(0|A[E]){case C.OPS.rectangle:I=S[T++],D=S[T++];let N=S[T++],U=S[T++],z=I+N,H=D+U;R.moveTo(I,D),0===N||0===U?R.lineTo(z,H):(R.lineTo(z,D),R.lineTo(z,H),R.lineTo(I,H)),O||F.updateRectMinMax(L,[I,D,z,H]),R.closePath();break;case C.OPS.moveTo:I=S[T++],D=S[T++],R.moveTo(I,D),O||F.updatePathMinMax(L,I,D);break;case C.OPS.lineTo:I=S[T++],D=S[T++],R.lineTo(I,D),O||F.updatePathMinMax(L,I,D);break;case C.OPS.curveTo:P=I,M=D,I=S[T+4],D=S[T+5],R.bezierCurveTo(S[T],S[T+1],S[T+2],S[T+3],I,D),F.updateCurvePathMinMax(L,P,M,S[T],S[T+1],S[T+2],S[T+3],I,D,B),T+=6;break;case C.OPS.curveTo2:P=I,M=D,R.bezierCurveTo(I,D,S[T],S[T+1],S[T+2],S[T+3]),F.updateCurvePathMinMax(L,P,M,I,D,S[T],S[T+1],S[T+2],S[T+3],B),I=S[T+2],D=S[T+3],T+=4;break;case C.OPS.curveTo3:P=I,M=D,I=S[T+2],D=S[T+3],R.bezierCurveTo(S[T],S[T+1],I,D,I,D),F.updateCurvePathMinMax(L,P,M,S[T],S[T+1],I,D,I,D,B),T+=4;break;case C.OPS.closePath:R.closePath()}O&&F.updateScalingPathMinMax(L,B),F.setCurrentPoint(I,D)}closePath(){this.ctx.closePath()}stroke(A=!0){let S=this.ctx,E=this.current.strokeColor;S.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof E&&E?.getPattern?(S.save(),S.strokeStyle=E.getPattern(S,this,(0,T.getCurrentTransformInverse)(S),P.PathType.STROKE),this.rescaleAndStroke(!1),S.restore()):this.rescaleAndStroke(!0)),A&&this.consumePath(this.current.getClippedPathBoundingBox()),S.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(A=!0){let S=this.ctx,E=this.current.fillColor,C=this.current.patternFill,M=!1;C&&(S.save(),S.fillStyle=E.getPattern(S,this,(0,T.getCurrentTransformInverse)(S),P.PathType.FILL),M=!0);let R=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==R&&(this.pendingEOFill?(S.fill("evenodd"),this.pendingEOFill=!1):S.fill()),M&&S.restore(),A&&this.consumePath(R)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=z}eoClip(){this.pendingClip=H}beginText(){this.current.textMatrix=C.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let A=this.pendingTextPaths,S=this.ctx;if(void 0===A){S.beginPath();return}for(let E of(S.save(),S.beginPath(),A))S.setTransform(...E.transform),S.translate(E.x,E.y),E.addToPath(S,E.fontSize);S.restore(),S.clip(),S.beginPath(),delete this.pendingTextPaths}setCharSpacing(A){this.current.charSpacing=A}setWordSpacing(A){this.current.wordSpacing=A}setHScale(A){this.current.textHScale=A/100}setLeading(A){this.current.leading=-A}setFont(A,S){let E=this.commonObjs.get(A),T=this.current;if(!E)throw Error(`Can't find font for ${A}`);if(T.fontMatrix=E.fontMatrix||C.FONT_IDENTITY_MATRIX,(0===T.fontMatrix[0]||0===T.fontMatrix[3])&&(0,C.warn)("Invalid font matrix for font "+A),S<0?(S=-S,T.fontDirection=-1):T.fontDirection=1,this.current.font=E,this.current.fontSize=S,E.isType3Font)return;let P=E.loadedName||"sans-serif",M=E.systemFontInfo?.css||`"${P}", ${E.fallbackName}`,I="normal";E.black?I="900":E.bold&&(I="bold");let D=E.italic?"italic":"normal",L=S;S<R?L=R:S>F&&(L=F),this.current.fontSizeScale=S/L,this.ctx.font=`${D} ${I} ${L}px ${M}`}setTextRenderingMode(A){this.current.textRenderingMode=A}setTextRise(A){this.current.textRise=A}moveText(A,S){this.current.x=this.current.lineX+=A,this.current.y=this.current.lineY+=S}setLeadingMoveText(A,S){this.setLeading(-S),this.moveText(A,S)}setTextMatrix(A,S,E,C,T,P){this.current.textMatrix=[A,S,E,C,T,P],this.current.textMatrixScale=Math.hypot(A,S),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(A,S,E,P){let M;let R=this.ctx,F=this.current,I=F.font,D=F.textRenderingMode,L=F.fontSize/F.fontSizeScale,O=D&C.TextRenderingMode.FILL_STROKE_MASK,B=!!(D&C.TextRenderingMode.ADD_TO_PATH_FLAG),N=F.patternFill&&!I.missingFile;if((I.disableFontFace||B||N)&&(M=I.getPathGenerator(this.commonObjs,A)),I.disableFontFace||N?(R.save(),R.translate(S,E),R.beginPath(),M(R,L),P&&R.setTransform(...P),(O===C.TextRenderingMode.FILL||O===C.TextRenderingMode.FILL_STROKE)&&R.fill(),(O===C.TextRenderingMode.STROKE||O===C.TextRenderingMode.FILL_STROKE)&&R.stroke(),R.restore()):((O===C.TextRenderingMode.FILL||O===C.TextRenderingMode.FILL_STROKE)&&R.fillText(A,S,E),(O===C.TextRenderingMode.STROKE||O===C.TextRenderingMode.FILL_STROKE)&&R.strokeText(A,S,E)),B){let A=this.pendingTextPaths||=[];A.push({transform:(0,T.getCurrentTransform)(R),x:S,y:E,fontSize:L,addToPath:M})}}get isFontSubpixelAAEnabled(){let{context:A}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);A.scale(1.5,1),A.fillText("I",0,10);let S=A.getImageData(0,0,10,10).data,E=!1;for(let A=3;A<S.length;A+=4)if(S[A]>0&&S[A]<255){E=!0;break}return(0,C.shadow)(this,"isFontSubpixelAAEnabled",E)}showText(A){let S;let E=this.current,M=E.font;if(M.isType3Font)return this.showType3Text(A);let R=E.fontSize;if(0===R)return;let F=this.ctx,I=E.fontSizeScale,D=E.charSpacing,L=E.wordSpacing,O=E.fontDirection,B=E.textHScale*O,N=A.length,U=M.vertical,z=U?1:-1,H=M.defaultVMetrics,W=R*E.fontMatrix[0],V=E.textRenderingMode===C.TextRenderingMode.FILL&&!M.disableFontFace&&!E.patternFill;if(F.save(),F.transform(...E.textMatrix),F.translate(E.x,E.y+E.textRise),O>0?F.scale(B,-1):F.scale(B,1),E.patternFill){F.save();let A=E.fillColor.getPattern(F,this,(0,T.getCurrentTransformInverse)(F),P.PathType.FILL);S=(0,T.getCurrentTransform)(F),F.restore(),F.fillStyle=A}let $=E.lineWidth,X=E.textMatrixScale;if(0===X||0===$){let A=E.textRenderingMode&C.TextRenderingMode.FILL_STROKE_MASK;(A===C.TextRenderingMode.STROKE||A===C.TextRenderingMode.FILL_STROKE)&&($=this.getSinglePixelWidth())}else $/=X;if(1!==I&&(F.scale(I,I),$/=I),F.lineWidth=$,M.isInvalidPDFjsFont){let S=[],C=0;for(let E of A)S.push(E.unicode),C+=E.width;F.fillText(S.join(""),0,0),E.x+=C*W*B,F.restore(),this.compose();return}let K=0,Y;for(Y=0;Y<N;++Y){let E,C;let T=A[Y];if("number"==typeof T){K+=z*T*R/1e3;continue}let P=!1,B=(T.isSpace?L:0)+D,N=T.fontChar,$=T.accent,X=T.width;if(U){let A=T.vmetric||H,S=-(T.vmetric?A[1]:.5*X)*W,P=A[2]*W;X=A?-A[0]:X,E=S/I,C=(K+P)/I}else E=K/I,C=0;if(M.remeasure&&X>0){let A=1e3*F.measureText(N).width/R*I;if(X<A&&this.isFontSubpixelAAEnabled){let S=X/A;P=!0,F.save(),F.scale(S,1),E/=S}else X!==A&&(E+=(X-A)/2e3*R/I)}if(this.contentVisible&&(T.isInFont||M.missingFile)){if(V&&!$)F.fillText(N,E,C);else if(this.paintChar(N,E,C,S),$){let A=E+R*$.offset.x/I,T=C-R*$.offset.y/I;this.paintChar($.fontChar,A,T,S)}}let J=U?X*W-B*O:X*W+B*O;K+=J,P&&F.restore()}U?E.y-=K:E.x+=K*B,F.restore(),this.compose()}showType3Text(A){let S,E,T,P;let M=this.ctx,R=this.current,F=R.font,I=R.fontSize,D=R.fontDirection,L=F.vertical?1:-1,O=R.charSpacing,B=R.wordSpacing,N=R.textHScale*D,U=R.fontMatrix||C.FONT_IDENTITY_MATRIX,z=A.length,H=R.textRenderingMode===C.TextRenderingMode.INVISIBLE;if(!H&&0!==I){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,M.save(),M.transform(...R.textMatrix),M.translate(R.x,R.y),M.scale(N,D),S=0;S<z;++S){if("number"==typeof(E=A[S])){P=L*E*I/1e3,this.ctx.translate(P,0),R.x+=P*N;continue}let D=(E.isSpace?B:0)+O,z=F.charProcOperatorList[E.operatorListId];if(!z){(0,C.warn)(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),M.scale(I,I),M.transform(...U),this.executeOperatorList(z),this.restore());let H=C.Util.applyTransform([E.width,0],U);T=H[0]*I+D,M.translate(T,0),R.x+=T*N}M.restore(),this.processingType3=null}}setCharWidth(A,S){}setCharWidthAndBounds(A,S,E,C,T,P){this.ctx.rect(E,C,T-E,P-C),this.ctx.clip(),this.endPath()}getColorN_Pattern(A){let S;if("TilingPattern"===A[0]){let E=A[1],C=this.baseTransform||(0,T.getCurrentTransform)(this.ctx),M={createCanvasGraphics:A=>new CanvasGraphics(A,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};S=new P.TilingPattern(A,E,this.ctx,M,C)}else S=this._getPattern(A[1],A[2]);return S}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(A,S,E){let T=C.Util.makeHexColor(A,S,E);this.ctx.strokeStyle=T,this.current.strokeColor=T}setFillRGBColor(A,S,E){let T=C.Util.makeHexColor(A,S,E);this.ctx.fillStyle=T,this.current.fillColor=T,this.current.patternFill=!1}_getPattern(A,S=null){let E;return this.cachedPatterns.has(A)?E=this.cachedPatterns.get(A):(E=(0,P.getShadingPattern)(this.getObject(A)),this.cachedPatterns.set(A,E)),S&&(E.matrix=S),E}shadingFill(A){if(!this.contentVisible)return;let S=this.ctx;this.save();let E=this._getPattern(A);S.fillStyle=E.getPattern(S,this,(0,T.getCurrentTransformInverse)(S),P.PathType.SHADING);let M=(0,T.getCurrentTransformInverse)(S);if(M){let{width:A,height:E}=S.canvas,[T,P,R,F]=C.Util.getAxialAlignedBoundingBox([0,0,A,E],M);this.ctx.fillRect(T,P,R-T,F-P)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,C.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,C.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(A,S){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(A)&&6===A.length&&this.transform(...A),this.baseTransform=(0,T.getCurrentTransform)(this.ctx),S)){let A=S[2]-S[0],E=S[3]-S[1];this.ctx.rect(S[0],S[1],A,E),this.current.updateRectMinMax((0,T.getCurrentTransform)(this.ctx),S),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(A){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let S=this.ctx;A.isolated||(0,C.info)("TODO: Support non-isolated groups."),A.knockout&&(0,C.warn)("Knockout groups not supported.");let E=(0,T.getCurrentTransform)(S);if(A.matrix&&S.transform(...A.matrix),!A.bbox)throw Error("Bounding box is required.");let P=C.Util.getAxialAlignedBoundingBox(A.bbox,(0,T.getCurrentTransform)(S)),M=[0,0,S.canvas.width,S.canvas.height];P=C.Util.intersect(P,M)||[0,0,0,0];let R=Math.floor(P[0]),F=Math.floor(P[1]),D=Math.max(Math.ceil(P[2])-R,1),L=Math.max(Math.ceil(P[3])-F,1),O=1,B=1;D>I&&(O=D/I,D=I),L>I&&(B=L/I,L=I),this.current.startNewPathAndClipBox([0,0,D,L]);let N="groupAt"+this.groupLevel;A.smask&&(N+="_smask_"+this.smaskCounter++%2);let U=this.cachedCanvases.getCanvas(N,D,L),z=U.context;z.scale(1/O,1/B),z.translate(-R,-F),z.transform(...E),A.smask?this.smaskStack.push({canvas:U.canvas,context:z,offsetX:R,offsetY:F,scaleX:O,scaleY:B,subtype:A.smask.subtype,backdrop:A.smask.backdrop,transferMap:A.smask.transferMap||null,startTransformInverse:null}):(S.setTransform(1,0,0,1,0,0),S.translate(R,F),S.scale(O,B),S.save()),copyCtxState(S,z),this.ctx=z,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(S),this.groupLevel++}endGroup(A){if(!this.contentVisible)return;this.groupLevel--;let S=this.ctx,E=this.groupStack.pop();if(this.ctx=E,this.ctx.imageSmoothingEnabled=!1,A.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let A=(0,T.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...A);let E=C.Util.getAxialAlignedBoundingBox([0,0,S.canvas.width,S.canvas.height],A);this.ctx.drawImage(S.canvas,0,0),this.ctx.restore(),this.compose(E)}}beginAnnotation(A,S,E,P,M){if(this.#t9(),resetCtxToDefault(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(S)&&4===S.length){let P=S[2]-S[0],R=S[3]-S[1];if(M&&this.annotationCanvasMap){E=E.slice(),E[4]-=S[0],E[5]-=S[1],(S=S.slice())[0]=S[1]=0,S[2]=P,S[3]=R;let[M,F]=C.Util.singularValueDecompose2dScale((0,T.getCurrentTransform)(this.ctx)),{viewportScale:I}=this,D=Math.ceil(P*this.outputScaleX*I),L=Math.ceil(R*this.outputScaleY*I);this.annotationCanvas=this.canvasFactory.create(D,L);let{canvas:O,context:B}=this.annotationCanvas;this.annotationCanvasMap.set(A,O),this.annotationCanvas.savedCtx=this.ctx,this.ctx=B,this.ctx.save(),this.ctx.setTransform(M,0,0,-F,0,R*F),resetCtxToDefault(this.ctx)}else resetCtxToDefault(this.ctx),this.ctx.rect(S[0],S[1],P,R),this.ctx.clip(),this.endPath()}this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...E),this.transform(...P)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#et(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(A){if(!this.contentVisible)return;let S=A.count;(A=this.getObject(A.data,A)).count=S;let E=this.ctx,C=this.processingType3;if(C&&(void 0===C.compiled&&(C.compiled=compileType3Glyph(A)),C.compiled)){C.compiled(E);return}let T=this._createMaskCanvas(A),P=T.canvas;E.save(),E.setTransform(1,0,0,1,0,0),E.drawImage(P,T.offsetX,T.offsetY),E.restore(),this.compose()}paintImageMaskXObjectRepeat(A,S,E=0,P=0,M,R){if(!this.contentVisible)return;A=this.getObject(A.data,A);let F=this.ctx;F.save();let I=(0,T.getCurrentTransform)(F);F.transform(S,E,P,M,0,0);let D=this._createMaskCanvas(A);F.setTransform(1,0,0,1,D.offsetX-I[4],D.offsetY-I[5]);for(let A=0,T=R.length;A<T;A+=2){let T=C.Util.transform(I,[S,E,P,M,R[A],R[A+1]]),[L,O]=C.Util.applyTransform([0,0],T);F.drawImage(D.canvas,L,O)}F.restore(),this.compose()}paintImageMaskXObjectGroup(A){if(!this.contentVisible)return;let S=this.ctx,E=this.current.fillColor,C=this.current.patternFill;for(let M of A){let{data:A,width:R,height:F,transform:I}=M,D=this.cachedCanvases.getCanvas("maskCanvas",R,F),L=D.context;L.save();let O=this.getObject(A,M);putBinaryImageMask(L,O),L.globalCompositeOperation="source-in",L.fillStyle=C?E.getPattern(L,this,(0,T.getCurrentTransformInverse)(S),P.PathType.FILL):E,L.fillRect(0,0,R,F),L.restore(),S.save(),S.transform(...I),S.scale(1,-1),drawImageAtIntegerCoords(S,D.canvas,0,0,R,F,0,-1,1,1),S.restore()}this.compose()}paintImageXObject(A){if(!this.contentVisible)return;let S=this.getObject(A);if(!S){(0,C.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(S)}paintImageXObjectRepeat(A,S,E,T){if(!this.contentVisible)return;let P=this.getObject(A);if(!P){(0,C.warn)("Dependent image isn't ready yet");return}let M=P.width,R=P.height,F=[];for(let A=0,C=T.length;A<C;A+=2)F.push({transform:[S,0,0,E,T[A],T[A+1]],x:0,y:0,w:M,h:R});this.paintInlineImageXObjectGroup(P,F)}applyTransferMapsToCanvas(A){return"none"!==this.current.transferMaps&&(A.filter=this.current.transferMaps,A.drawImage(A.canvas,0,0),A.filter="none"),A.canvas}applyTransferMapsToBitmap(A){if("none"===this.current.transferMaps)return A.bitmap;let{bitmap:S,width:E,height:C}=A,T=this.cachedCanvases.getCanvas("inlineImage",E,C),P=T.context;return P.filter=this.current.transferMaps,P.drawImage(S,0,0),P.filter="none",T.canvas}paintInlineImageXObject(A){let S;if(!this.contentVisible)return;let E=A.width,P=A.height,M=this.ctx;if(this.save(),!C.isNodeJS){let{filter:A}=M;"none"!==A&&""!==A&&(M.filter="none")}if(M.scale(1/E,-1/P),A.bitmap)S=this.applyTransferMapsToBitmap(A);else if("function"==typeof HTMLElement&&A instanceof HTMLElement||!A.data)S=A;else{let C=this.cachedCanvases.getCanvas("inlineImage",E,P),T=C.context;putBinaryImageData(T,A),S=this.applyTransferMapsToCanvas(T)}let R=this._scaleImage(S,(0,T.getCurrentTransformInverse)(M));M.imageSmoothingEnabled=getImageSmoothingEnabled((0,T.getCurrentTransform)(M),A.interpolate),drawImageAtIntegerCoords(M,R.img,0,0,R.paintWidth,R.paintHeight,0,-P,E,P),this.compose(),this.restore()}paintInlineImageXObjectGroup(A,S){let E;if(!this.contentVisible)return;let C=this.ctx;if(A.bitmap)E=A.bitmap;else{let S=A.width,C=A.height,T=this.cachedCanvases.getCanvas("inlineImage",S,C),P=T.context;putBinaryImageData(P,A),E=this.applyTransferMapsToCanvas(P)}for(let A of S)C.save(),C.transform(...A.transform),C.scale(1,-1),drawImageAtIntegerCoords(C,E,A.x,A.y,A.w,A.h,0,-1,1,1),C.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(A){}markPointProps(A,S){}beginMarkedContent(A){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(A,S){"OC"===A?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(S)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(A){let S=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(A);let E=this.ctx;this.pendingClip&&(S||(this.pendingClip===H?E.clip("evenodd"):E.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),E.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let A=(0,T.getCurrentTransform)(this.ctx);if(0===A[1]&&0===A[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(A[0]),Math.abs(A[3]));else{let S=Math.abs(A[0]*A[3]-A[2]*A[1]),E=Math.hypot(A[0],A[2]),C=Math.hypot(A[1],A[3]);this._cachedGetSinglePixelWidth=Math.max(E,C)/S}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){let A,S;let{lineWidth:E}=this.current,{a:C,b:T,c:P,d:M}=this.ctx.getTransform();if(0===T&&0===P){let T=Math.abs(C),P=Math.abs(M);if(T===P){if(0===E)A=S=1/T;else{let C=T*E;A=S=C<1?1/C:1}}else if(0===E)A=1/T,S=1/P;else{let C=T*E,M=P*E;A=C<1?1/C:1,S=M<1?1/M:1}}else{let R=Math.abs(C*M-T*P),F=Math.hypot(C,T),I=Math.hypot(P,M);if(0===E)A=I/R,S=F/R;else{let C=E*R;A=I>C?I/C:1,S=F>C?F/C:1}}this._cachedScaleForStroking[0]=A,this._cachedScaleForStroking[1]=S}return this._cachedScaleForStroking}rescaleAndStroke(A){let{ctx:S}=this,{lineWidth:E}=this.current,[C,T]=this.getScaleForStroking();if(S.lineWidth=E||1,1===C&&1===T){S.stroke();return}let P=S.getLineDash();if(A&&S.save(),S.scale(C,T),P.length>0){let A=Math.max(C,T);S.setLineDash(P.map(S=>S/A)),S.lineDashOffset/=A}S.stroke(),A&&S.restore()}isContentVisible(){for(let A=this.markedContentStack.length-1;A>=0;A--)if(!this.markedContentStack[A].visible)return!1;return!0}};for(let A in S.CanvasGraphics=CanvasGraphics,C.OPS)void 0!==CanvasGraphics.prototype[A]&&(CanvasGraphics.prototype[C.OPS[A]]=CanvasGraphics.prototype[A])},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.TilingPattern=S.PathType=void 0,S.getShadingPattern=getShadingPattern;var C=E(1),T=E(6);let P={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function applyBoundingBox(A,S){if(!S)return;let E=S[2]-S[0],C=S[3]-S[1],T=new Path2D;T.rect(S[0],S[1],E,C),A.clip(T)}S.PathType=P;let BaseShadingPattern=class BaseShadingPattern{constructor(){this.constructor===BaseShadingPattern&&(0,C.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,C.unreachable)("Abstract method `getPattern` called.")}};let RadialAxialShadingPattern=class RadialAxialShadingPattern extends BaseShadingPattern{constructor(A){super(),this._type=A[1],this._bbox=A[2],this._colorStops=A[3],this._p0=A[4],this._p1=A[5],this._r0=A[6],this._r1=A[7],this.matrix=null}_createGradient(A){let S;for(let E of("axial"===this._type?S=A.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(S=A.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1)),this._colorStops))S.addColorStop(E[0],E[1]);return S}getPattern(A,S,E,M){let R;if(M===P.STROKE||M===P.FILL){let P=S.current.getClippedPathBoundingBox(M,(0,T.getCurrentTransform)(A))||[0,0,0,0],F=Math.ceil(P[2]-P[0])||1,I=Math.ceil(P[3]-P[1])||1,D=S.cachedCanvases.getCanvas("pattern",F,I,!0),L=D.context;L.clearRect(0,0,L.canvas.width,L.canvas.height),L.beginPath(),L.rect(0,0,L.canvas.width,L.canvas.height),L.translate(-P[0],-P[1]),E=C.Util.transform(E,[1,0,0,1,P[0],P[1]]),L.transform(...S.baseTransform),this.matrix&&L.transform(...this.matrix),applyBoundingBox(L,this._bbox),L.fillStyle=this._createGradient(L),L.fill(),R=A.createPattern(D.canvas,"no-repeat");let O=new DOMMatrix(E);R.setTransform(O)}else applyBoundingBox(A,this._bbox),R=this._createGradient(A);return R}};function drawTriangle(A,S,E,C,T,P,M,R){let F,I,D,L,O,B,N,U,z;let H=S.coords,W=S.colors,V=A.data,$=4*A.width;H[E+1]>H[C+1]&&(F=E,E=C,C=F,F=P,P=M,M=F),H[C+1]>H[T+1]&&(F=C,C=T,T=F,F=M,M=R,R=F),H[E+1]>H[C+1]&&(F=E,E=C,C=F,F=P,P=M,M=F);let X=(H[E]+S.offsetX)*S.scaleX,K=(H[E+1]+S.offsetY)*S.scaleY,Y=(H[C]+S.offsetX)*S.scaleX,J=(H[C+1]+S.offsetY)*S.scaleY,Q=(H[T]+S.offsetX)*S.scaleX,Z=(H[T+1]+S.offsetY)*S.scaleY;if(K>=Z)return;let tt=W[P],te=W[P+1],ti=W[P+2],tr=W[M],tn=W[M+1],ts=W[M+2],ta=W[R],to=W[R+1],tl=W[R+2],th=Math.round(K),td=Math.round(Z);for(let A=th;A<=td;A++){let S;if(A<J){let S=A<K?0:(K-A)/(K-J);I=X-(X-Y)*S,D=tt-(tt-tr)*S,L=te-(te-tn)*S,O=ti-(ti-ts)*S}else{let S;I=Y-(Y-Q)*(S=A>Z?1:J===Z?0:(J-A)/(J-Z)),D=tr-(tr-ta)*S,L=tn-(tn-to)*S,O=ts-(ts-tl)*S}B=X-(X-Q)*(S=A<K?0:A>Z?1:(K-A)/(K-Z)),N=tt-(tt-ta)*S,U=te-(te-to)*S,z=ti-(ti-tl)*S;let E=Math.round(Math.min(I,B)),C=Math.round(Math.max(I,B)),T=$*A+4*E;for(let A=E;A<=C;A++)(S=(I-A)/(I-B))<0?S=0:S>1&&(S=1),V[T++]=D-(D-N)*S|0,V[T++]=L-(L-U)*S|0,V[T++]=O-(O-z)*S|0,V[T++]=255}}function drawFigure(A,S,E){let C,T;let P=S.coords,M=S.colors;switch(S.type){case"lattice":let R=S.verticesPerRow,F=Math.floor(P.length/R)-1,I=R-1;for(C=0;C<F;C++){let S=C*R;for(let C=0;C<I;C++,S++)drawTriangle(A,E,P[S],P[S+1],P[S+R],M[S],M[S+1],M[S+R]),drawTriangle(A,E,P[S+R+1],P[S+1],P[S+R],M[S+R+1],M[S+1],M[S+R])}break;case"triangles":for(C=0,T=P.length;C<T;C+=3)drawTriangle(A,E,P[C],P[C+1],P[C+2],M[C],M[C+1],M[C+2]);break;default:throw Error("illegal figure")}}let MeshShadingPattern=class MeshShadingPattern extends BaseShadingPattern{constructor(A){super(),this._coords=A[2],this._colors=A[3],this._figures=A[4],this._bounds=A[5],this._bbox=A[7],this._background=A[8],this.matrix=null}_createMeshCanvas(A,S,E){let C=1.1,T=3e3,P=2,M=Math.floor(this._bounds[0]),R=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-M,I=Math.ceil(this._bounds[3])-R,D=Math.min(Math.ceil(Math.abs(F*A[0]*C)),T),L=Math.min(Math.ceil(Math.abs(I*A[1]*C)),T),O=F/D,B=I/L,N={coords:this._coords,colors:this._colors,offsetX:-M,offsetY:-R,scaleX:1/O,scaleY:1/B},U=D+2*P,z=L+2*P,H=E.getCanvas("mesh",U,z,!1),W=H.context,V=W.createImageData(D,L);if(S){let A=V.data;for(let E=0,C=A.length;E<C;E+=4)A[E]=S[0],A[E+1]=S[1],A[E+2]=S[2],A[E+3]=255}for(let A of this._figures)drawFigure(V,A,N);W.putImageData(V,P,P);let $=H.canvas;return{canvas:$,offsetX:M-P*O,offsetY:R-P*B,scaleX:O,scaleY:B}}getPattern(A,S,E,M){let R;if(applyBoundingBox(A,this._bbox),M===P.SHADING)R=C.Util.singularValueDecompose2dScale((0,T.getCurrentTransform)(A));else if(R=C.Util.singularValueDecompose2dScale(S.baseTransform),this.matrix){let A=C.Util.singularValueDecompose2dScale(this.matrix);R=[R[0]*A[0],R[1]*A[1]]}let F=this._createMeshCanvas(R,M===P.SHADING?null:this._background,S.cachedCanvases);return M!==P.SHADING&&(A.setTransform(...S.baseTransform),this.matrix&&A.transform(...this.matrix)),A.translate(F.offsetX,F.offsetY),A.scale(F.scaleX,F.scaleY),A.createPattern(F.canvas,"no-repeat")}};let DummyShadingPattern=class DummyShadingPattern extends BaseShadingPattern{getPattern(){return"hotpink"}};function getShadingPattern(A){switch(A[0]){case"RadialAxial":return new RadialAxialShadingPattern(A);case"Mesh":return new MeshShadingPattern(A);case"Dummy":return new DummyShadingPattern}throw Error(`Unknown IR type: ${A[0]}`)}let M={COLORED:1,UNCOLORED:2};let TilingPattern=class TilingPattern{static MAX_PATTERN_SIZE=3e3;constructor(A,S,E,C,T){this.operatorList=A[2],this.matrix=A[3]||[1,0,0,1,0,0],this.bbox=A[4],this.xstep=A[5],this.ystep=A[6],this.paintType=A[7],this.tilingType=A[8],this.color=S,this.ctx=E,this.canvasGraphicsFactory=C,this.baseTransform=T}createPatternCanvas(A){let S=this.operatorList,E=this.bbox,P=this.xstep,M=this.ystep,R=this.paintType,F=this.tilingType,I=this.color,D=this.canvasGraphicsFactory;(0,C.info)("TilingType: "+F);let L=E[0],O=E[1],B=E[2],N=E[3],U=C.Util.singularValueDecompose2dScale(this.matrix),z=C.Util.singularValueDecompose2dScale(this.baseTransform),H=[U[0]*z[0],U[1]*z[1]],W=this.getSizeAndScale(P,this.ctx.canvas.width,H[0]),V=this.getSizeAndScale(M,this.ctx.canvas.height,H[1]),$=A.cachedCanvases.getCanvas("pattern",W.size,V.size,!0),X=$.context,K=D.createCanvasGraphics(X);K.groupLevel=A.groupLevel,this.setFillAndStrokeStyleToContext(K,R,I);let Y=L,J=O,Q=B,Z=N;return L<0&&(Y=0,Q+=Math.abs(L)),O<0&&(J=0,Z+=Math.abs(O)),X.translate(-(W.scale*Y),-(V.scale*J)),K.transform(W.scale,0,0,V.scale,0,0),X.save(),this.clipBbox(K,Y,J,Q,Z),K.baseTransform=(0,T.getCurrentTransform)(K.ctx),K.executeOperatorList(S),K.endDrawing(),{canvas:$.canvas,scaleX:W.scale,scaleY:V.scale,offsetX:Y,offsetY:J}}getSizeAndScale(A,S,E){A=Math.abs(A);let C=Math.max(TilingPattern.MAX_PATTERN_SIZE,S),T=Math.ceil(A*E);return T>=C?T=C:E=T/A,{scale:E,size:T}}clipBbox(A,S,E,C,P){let M=C-S,R=P-E;A.ctx.rect(S,E,M,R),A.current.updateRectMinMax((0,T.getCurrentTransform)(A.ctx),[S,E,C,P]),A.clip(),A.endPath()}setFillAndStrokeStyleToContext(A,S,E){let T=A.ctx,P=A.current;switch(S){case M.COLORED:let R=this.ctx;T.fillStyle=R.fillStyle,T.strokeStyle=R.strokeStyle,P.fillColor=R.fillStyle,P.strokeColor=R.strokeStyle;break;case M.UNCOLORED:let F=C.Util.makeHexColor(E[0],E[1],E[2]);T.fillStyle=F,T.strokeStyle=F,P.fillColor=F,P.strokeColor=F;break;default:throw new C.FormatError(`Unsupported paint type: ${S}`)}}getPattern(A,S,E,T){let M=E;T!==P.SHADING&&(M=C.Util.transform(M,S.baseTransform),this.matrix&&(M=C.Util.transform(M,this.matrix)));let R=this.createPatternCanvas(S),F=new DOMMatrix(M);F=(F=F.translate(R.offsetX,R.offsetY)).scale(1/R.scaleX,1/R.scaleY);let I=A.createPattern(R.canvas,"repeat");return I.setTransform(F),I}};S.TilingPattern=TilingPattern},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.convertBlackAndWhiteToRGBA=convertBlackAndWhiteToRGBA,S.convertToRGBA=convertToRGBA,S.grayToRGBA=grayToRGBA;var C=E(1);function convertToRGBA(A){switch(A.kind){case C.ImageKind.GRAYSCALE_1BPP:return convertBlackAndWhiteToRGBA(A);case C.ImageKind.RGB_24BPP:return convertRGBToRGBA(A)}return null}function convertBlackAndWhiteToRGBA({src:A,srcPos:S=0,dest:E,width:T,height:P,nonBlackColor:M=4294967295,inverseDecode:R=!1}){let F=C.FeatureTest.isLittleEndian?4278190080:255,[I,D]=R?[M,F]:[F,M],L=T>>3,O=7&T,B=A.length;E=new Uint32Array(E.buffer);let N=0;for(let C=0;C<P;C++){for(let C=S+L;S<C;S++){let C=S<B?A[S]:255;E[N++]=128&C?D:I,E[N++]=64&C?D:I,E[N++]=32&C?D:I,E[N++]=16&C?D:I,E[N++]=8&C?D:I,E[N++]=4&C?D:I,E[N++]=2&C?D:I,E[N++]=1&C?D:I}if(0===O)continue;let C=S<B?A[S++]:255;for(let A=0;A<O;A++)E[N++]=C&1<<7-A?D:I}return{srcPos:S,destPos:N}}function convertRGBToRGBA({src:A,srcPos:S=0,dest:E,destPos:T=0,width:P,height:M}){let R=0,F=A.length>>2,I=new Uint32Array(A.buffer,S,F);if(C.FeatureTest.isLittleEndian){for(;R<F-2;R+=3,T+=4){let A=I[R],S=I[R+1],C=I[R+2];E[T]=4278190080|A,E[T+1]=A>>>24|S<<8|4278190080,E[T+2]=S>>>16|C<<16|4278190080,E[T+3]=C>>>8|4278190080}for(let S=4*R,C=A.length;S<C;S+=3)E[T++]=A[S]|A[S+1]<<8|A[S+2]<<16|4278190080}else{for(;R<F-2;R+=3,T+=4){let A=I[R],S=I[R+1],C=I[R+2];E[T]=255|A,E[T+1]=A<<24|S>>>8|255,E[T+2]=S<<16|C>>>16|255,E[T+3]=C<<8|255}for(let S=4*R,C=A.length;S<C;S+=3)E[T++]=A[S]<<24|A[S+1]<<16|A[S+2]<<8|255}return{srcPos:S,destPos:T}}function grayToRGBA(A,S){if(C.FeatureTest.isLittleEndian)for(let E=0,C=A.length;E<C;E++)S[E]=65793*A[E]|4278190080;else for(let E=0,C=A.length;E<C;E++)S[E]=16843008*A[E]|255}},(A,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.GlobalWorkerOptions=void 0;let E=Object.create(null);S.GlobalWorkerOptions=E,E.workerPort=null,E.workerSrc=""},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.MessageHandler=void 0;var C=E(1);let T={DATA:1,ERROR:2},P={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function wrapReason(A){switch(A instanceof Error||"object"==typeof A&&null!==A||(0,C.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),A.name){case"AbortException":return new C.AbortException(A.message);case"MissingPDFException":return new C.MissingPDFException(A.message);case"PasswordException":return new C.PasswordException(A.message,A.code);case"UnexpectedResponseException":return new C.UnexpectedResponseException(A.message,A.status);case"UnknownErrorException":return new C.UnknownErrorException(A.message,A.details);default:return new C.UnknownErrorException(A.message,A.toString())}}let MessageHandler=class MessageHandler{constructor(A,S,E){this.sourceName=A,this.targetName=S,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=A=>{let S=A.data;if(S.targetName!==this.sourceName)return;if(S.stream){this.#ee(S);return}if(S.callback){let A=S.callbackId,E=this.callbackCapabilities[A];if(!E)throw Error(`Cannot resolve callback ${A}`);if(delete this.callbackCapabilities[A],S.callback===T.DATA)E.resolve(S.data);else if(S.callback===T.ERROR)E.reject(wrapReason(S.reason));else throw Error("Unexpected callback case");return}let C=this.actionHandler[S.action];if(!C)throw Error(`Unknown action from worker: ${S.action}`);if(S.callbackId){let A=this.sourceName,P=S.sourceName;new Promise(function(A){A(C(S.data))}).then(function(C){E.postMessage({sourceName:A,targetName:P,callback:T.DATA,callbackId:S.callbackId,data:C})},function(C){E.postMessage({sourceName:A,targetName:P,callback:T.ERROR,callbackId:S.callbackId,reason:wrapReason(C)})});return}if(S.streamId){this.#ei(S);return}C(S.data)},E.addEventListener("message",this._onComObjOnMessage)}on(A,S){let E=this.actionHandler;if(E[A])throw Error(`There is already an actionName called "${A}"`);E[A]=S}send(A,S,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,data:S},E)}sendWithPromise(A,S,E){let T=this.callbackId++,P=new C.PromiseCapability;this.callbackCapabilities[T]=P;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,callbackId:T,data:S},E)}catch(A){P.reject(A)}return P.promise}sendWithStream(A,S,E,T){let M=this.streamId++,R=this.sourceName,F=this.targetName,I=this.comObj;return new ReadableStream({start:E=>{let P=new C.PromiseCapability;return this.streamControllers[M]={controller:E,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},I.postMessage({sourceName:R,targetName:F,action:A,streamId:M,data:S,desiredSize:E.desiredSize},T),P.promise},pull:A=>{let S=new C.PromiseCapability;return this.streamControllers[M].pullCall=S,I.postMessage({sourceName:R,targetName:F,stream:P.PULL,streamId:M,desiredSize:A.desiredSize}),S.promise},cancel:A=>{(0,C.assert)(A instanceof Error,"cancel must have a valid reason");let S=new C.PromiseCapability;return this.streamControllers[M].cancelCall=S,this.streamControllers[M].isClosed=!0,I.postMessage({sourceName:R,targetName:F,stream:P.CANCEL,streamId:M,reason:wrapReason(A)}),S.promise}},E)}#ei(A){let S=A.streamId,E=this.sourceName,T=A.sourceName,M=this.comObj,R=this,F=this.actionHandler[A.action],I={enqueue(A,R=1,F){if(this.isCancelled)return;let I=this.desiredSize;this.desiredSize-=R,I>0&&this.desiredSize<=0&&(this.sinkCapability=new C.PromiseCapability,this.ready=this.sinkCapability.promise),M.postMessage({sourceName:E,targetName:T,stream:P.ENQUEUE,streamId:S,chunk:A},F)},close(){this.isCancelled||(this.isCancelled=!0,M.postMessage({sourceName:E,targetName:T,stream:P.CLOSE,streamId:S}),delete R.streamSinks[S])},error(A){(0,C.assert)(A instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,M.postMessage({sourceName:E,targetName:T,stream:P.ERROR,streamId:S,reason:wrapReason(A)}))},sinkCapability:new C.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:A.desiredSize,ready:null};I.sinkCapability.resolve(),I.ready=I.sinkCapability.promise,this.streamSinks[S]=I,new Promise(function(S){S(F(A.data,I))}).then(function(){M.postMessage({sourceName:E,targetName:T,stream:P.START_COMPLETE,streamId:S,success:!0})},function(A){M.postMessage({sourceName:E,targetName:T,stream:P.START_COMPLETE,streamId:S,reason:wrapReason(A)})})}#ee(A){let S=A.streamId,E=this.sourceName,T=A.sourceName,M=this.comObj,R=this.streamControllers[S],F=this.streamSinks[S];switch(A.stream){case P.START_COMPLETE:A.success?R.startCall.resolve():R.startCall.reject(wrapReason(A.reason));break;case P.PULL_COMPLETE:A.success?R.pullCall.resolve():R.pullCall.reject(wrapReason(A.reason));break;case P.PULL:if(!F){M.postMessage({sourceName:E,targetName:T,stream:P.PULL_COMPLETE,streamId:S,success:!0});break}F.desiredSize<=0&&A.desiredSize>0&&F.sinkCapability.resolve(),F.desiredSize=A.desiredSize,new Promise(function(A){A(F.onPull?.())}).then(function(){M.postMessage({sourceName:E,targetName:T,stream:P.PULL_COMPLETE,streamId:S,success:!0})},function(A){M.postMessage({sourceName:E,targetName:T,stream:P.PULL_COMPLETE,streamId:S,reason:wrapReason(A)})});break;case P.ENQUEUE:if((0,C.assert)(R,"enqueue should have stream controller"),R.isClosed)break;R.controller.enqueue(A.chunk);break;case P.CLOSE:if((0,C.assert)(R,"close should have stream controller"),R.isClosed)break;R.isClosed=!0,R.controller.close(),this.#er(R,S);break;case P.ERROR:(0,C.assert)(R,"error should have stream controller"),R.controller.error(wrapReason(A.reason)),this.#er(R,S);break;case P.CANCEL_COMPLETE:A.success?R.cancelCall.resolve():R.cancelCall.reject(wrapReason(A.reason)),this.#er(R,S);break;case P.CANCEL:if(!F)break;new Promise(function(S){S(F.onCancel?.(wrapReason(A.reason)))}).then(function(){M.postMessage({sourceName:E,targetName:T,stream:P.CANCEL_COMPLETE,streamId:S,success:!0})},function(A){M.postMessage({sourceName:E,targetName:T,stream:P.CANCEL_COMPLETE,streamId:S,reason:wrapReason(A)})}),F.sinkCapability.reject(wrapReason(A.reason)),F.isCancelled=!0,delete this.streamSinks[S];break;default:throw Error("Unexpected stream case")}}async #er(A,S){await Promise.allSettled([A.startCall?.promise,A.pullCall?.promise,A.cancelCall?.promise]),delete this.streamControllers[S]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}};S.MessageHandler=MessageHandler},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.Metadata=void 0;var C=E(1);let Metadata=class Metadata{#en;#es;constructor({parsedData:A,rawData:S}){this.#en=A,this.#es=S}getRaw(){return this.#es}get(A){return this.#en.get(A)??null}getAll(){return(0,C.objectFromMap)(this.#en)}has(A){return this.#en.has(A)}};S.Metadata=Metadata},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.OptionalContentConfig=void 0;var C=E(1),T=E(8);let P=Symbol("INTERNAL");let OptionalContentGroup=class OptionalContentGroup{#ea=!0;constructor(A,S){this.name=A,this.intent=S}get visible(){return this.#ea}_setVisible(A,S){A!==P&&(0,C.unreachable)("Internal method `_setVisible` called."),this.#ea=S}};let OptionalContentConfig=class OptionalContentConfig{#eo=null;#el=new Map;#eh=null;#ed=null;constructor(A){if(this.name=null,this.creator=null,null===A)return;for(let S of(this.name=A.name,this.creator=A.creator,this.#ed=A.order,A.groups))this.#el.set(S.id,new OptionalContentGroup(S.name,S.intent));if("OFF"===A.baseState)for(let A of this.#el.values())A._setVisible(P,!1);for(let S of A.on)this.#el.get(S)._setVisible(P,!0);for(let S of A.off)this.#el.get(S)._setVisible(P,!1);this.#eh=this.getHash()}#ec(A){let S=A.length;if(S<2)return!0;let E=A[0];for(let T=1;T<S;T++){let S;let P=A[T];if(Array.isArray(P))S=this.#ec(P);else{if(!this.#el.has(P))return(0,C.warn)(`Optional content group not found: ${P}`),!0;S=this.#el.get(P).visible}switch(E){case"And":if(!S)return!1;break;case"Or":if(S)return!0;break;case"Not":return!S;default:return!0}}return"And"===E}isVisible(A){if(0===this.#el.size)return!0;if(!A)return(0,C.warn)("Optional content group not defined."),!0;if("OCG"===A.type)return this.#el.has(A.id)?this.#el.get(A.id).visible:((0,C.warn)(`Optional content group not found: ${A.id}`),!0);if("OCMD"===A.type){if(A.expression)return this.#ec(A.expression);if(A.policy&&"AnyOn"!==A.policy){if("AllOn"===A.policy){for(let S of A.ids){if(!this.#el.has(S)){(0,C.warn)(`Optional content group not found: ${S}`);break}if(!this.#el.get(S).visible)return!1}return!0}if("AnyOff"===A.policy){for(let S of A.ids){if(!this.#el.has(S))return(0,C.warn)(`Optional content group not found: ${S}`),!0;if(!this.#el.get(S).visible)return!0}return!1}if("AllOff"===A.policy){for(let S of A.ids){if(!this.#el.has(S)){(0,C.warn)(`Optional content group not found: ${S}`);break}if(this.#el.get(S).visible)return!1}return!0}}else{for(let S of A.ids){if(!this.#el.has(S))return(0,C.warn)(`Optional content group not found: ${S}`),!0;if(this.#el.get(S).visible)return!0}return!1}return(0,C.warn)(`Unknown optional content policy ${A.policy}.`),!0}return(0,C.warn)(`Unknown group type ${A.type}.`),!0}setVisibility(A,S=!0){if(!this.#el.has(A)){(0,C.warn)(`Optional content group not found: ${A}`);return}this.#el.get(A)._setVisible(P,!!S),this.#eo=null}get hasInitialVisibility(){return null===this.#eh||this.getHash()===this.#eh}getOrder(){return this.#el.size?this.#ed?this.#ed.slice():[...this.#el.keys()]:null}getGroups(){return this.#el.size>0?(0,C.objectFromMap)(this.#el):null}getGroup(A){return this.#el.get(A)||null}getHash(){if(null!==this.#eo)return this.#eo;let A=new T.MurmurHash3_64;for(let[S,E]of this.#el)A.update(`${S}:${E.visible}`);return this.#eo=A.hexdigest()}};S.OptionalContentConfig=OptionalContentConfig},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFDataTransportStream=void 0;var C=E(1),T=E(6);let PDFDataTransportStream=class PDFDataTransportStream{constructor({length:A,initialData:S,progressiveDone:E=!1,contentDispositionFilename:T=null,disableRange:P=!1,disableStream:M=!1},R){if((0,C.assert)(R,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=E,this._contentDispositionFilename=T,S?.length>0){let A=S instanceof Uint8Array&&S.byteLength===S.buffer.byteLength?S.buffer:new Uint8Array(S).buffer;this._queuedChunks.push(A)}this._pdfDataRangeTransport=R,this._isStreamingSupported=!M,this._isRangeSupported=!P,this._contentLength=A,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((A,S)=>{this._onReceiveData({begin:A,chunk:S})}),this._pdfDataRangeTransport.addProgressListener((A,S)=>{this._onProgress({loaded:A,total:S})}),this._pdfDataRangeTransport.addProgressiveReadListener(A=>{this._onReceiveData({chunk:A})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:A,chunk:S}){let E=S instanceof Uint8Array&&S.byteLength===S.buffer.byteLength?S.buffer:new Uint8Array(S).buffer;if(void 0===A)this._fullRequestReader?this._fullRequestReader._enqueue(E):this._queuedChunks.push(E);else{let S=this._rangeReaders.some(function(S){return S._begin===A&&(S._enqueue(E),!0)});(0,C.assert)(S,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(A){void 0===A.total?this._rangeReaders[0]?.onProgress?.({loaded:A.loaded}):this._fullRequestReader?.onProgress?.({loaded:A.loaded,total:A.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(A){let S=this._rangeReaders.indexOf(A);S>=0&&this._rangeReaders.splice(S,1)}getFullReader(){(0,C.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let A=this._queuedChunks;return this._queuedChunks=null,new PDFDataTransportStreamReader(this,A,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(A,S){if(S<=this._progressiveDataLength)return null;let E=new PDFDataTransportStreamRangeReader(this,A,S);return this._pdfDataRangeTransport.requestDataRange(A,S),this._rangeReaders.push(E),E}cancelAllRequests(A){for(let S of(this._fullRequestReader?.cancel(A),this._rangeReaders.slice(0)))S.cancel(A);this._pdfDataRangeTransport.abort()}};S.PDFDataTransportStream=PDFDataTransportStream;let PDFDataTransportStreamReader=class PDFDataTransportStreamReader{constructor(A,S,E=!1,C=null){for(let P of(this._stream=A,this._done=E||!1,this._filename=(0,T.isPdfFile)(C)?C:null,this._queuedChunks=S||[],this._loaded=0,this._queuedChunks))this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),A._fullRequestReader=this,this.onProgress=null}_enqueue(A){if(!this._done){if(this._requests.length>0){let S=this._requests.shift();S.resolve({value:A,done:!1})}else this._queuedChunks.push(A);this._loaded+=A.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){let A=this._queuedChunks.shift();return{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};let A=new C.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){for(let A of(this._done=!0,this._requests))A.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}};let PDFDataTransportStreamRangeReader=class PDFDataTransportStreamRangeReader{constructor(A,S,E){this._stream=A,this._begin=S,this._end=E,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(A){if(!this._done){if(0===this._requests.length)this._queuedChunk=A;else{let S=this._requests.shift();for(let E of(S.resolve({value:A,done:!1}),this._requests))E.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){let A=this._queuedChunk;return this._queuedChunk=null,{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};let A=new C.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){for(let A of(this._done=!0,this._requests))A.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFFetchStream=void 0;var C=E(1),T=E(20);function createFetchOptions(A,S,E){return{method:"GET",headers:A,signal:E.signal,mode:"cors",credentials:S?"include":"same-origin",redirect:"follow"}}function createHeaders(A){let S=new Headers;for(let E in A){let C=A[E];void 0!==C&&S.append(E,C)}return S}function getArrayBuffer(A){return A instanceof Uint8Array?A.buffer:A instanceof ArrayBuffer?A:((0,C.warn)(`getArrayBuffer - unexpected data format: ${A}`),new Uint8Array(A).buffer)}let PDFFetchStream=class PDFFetchStream{constructor(A){this.source=A,this.isHttp=/^https?:/i.test(A.url),this.httpHeaders=this.isHttp&&A.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,C.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PDFFetchStreamReader(this),this._fullRequestReader}getRangeReader(A,S){if(S<=this._progressiveDataLength)return null;let E=new PDFFetchStreamRangeReader(this,A,S);return this._rangeRequestReaders.push(E),E}cancelAllRequests(A){for(let S of(this._fullRequestReader?.cancel(A),this._rangeRequestReaders.slice(0)))S.cancel(A)}};S.PDFFetchStream=PDFFetchStream;let PDFFetchStreamReader=class PDFFetchStreamReader{constructor(A){this._stream=A,this._reader=null,this._loaded=0,this._filename=null;let S=A.source;this._withCredentials=S.withCredentials||!1,this._contentLength=S.length,this._headersCapability=new C.PromiseCapability,this._disableRange=S.disableRange||!1,this._rangeChunkSize=S.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!S.disableStream,this._isRangeSupported=!S.disableRange,this._headers=createHeaders(this._stream.httpHeaders);let E=S.url;fetch(E,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,T.validateResponseStatus)(A.status))throw(0,T.createResponseStatusError)(A.status,E);this._reader=A.body.getReader(),this._headersCapability.resolve();let getResponseHeader=S=>A.headers.get(S),{allowRangeRequests:S,suggestedLength:P}=(0,T.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=S,this._contentLength=P||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(getResponseHeader),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new C.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;let{value:A,done:S}=await this._reader.read();return S?{value:A,done:S}:(this._loaded+=A.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:getArrayBuffer(A),done:!1})}cancel(A){this._reader?.cancel(A),this._abortController.abort()}};let PDFFetchStreamRangeReader=class PDFFetchStreamRangeReader{constructor(A,S,E){this._stream=A,this._reader=null,this._loaded=0;let P=A.source;this._withCredentials=P.withCredentials||!1,this._readCapability=new C.PromiseCapability,this._isStreamingSupported=!P.disableStream,this._abortController=new AbortController,this._headers=createHeaders(this._stream.httpHeaders),this._headers.append("Range",`bytes=${S}-${E-1}`);let M=P.url;fetch(M,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,T.validateResponseStatus)(A.status))throw(0,T.createResponseStatusError)(A.status,M);this._readCapability.resolve(),this._reader=A.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;let{value:A,done:S}=await this._reader.read();return S?{value:A,done:S}:(this._loaded+=A.byteLength,this.onProgress?.({loaded:this._loaded}),{value:getArrayBuffer(A),done:!1})}cancel(A){this._reader?.cancel(A),this._abortController.abort()}}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.createResponseStatusError=createResponseStatusError,S.extractFilenameFromHeader=extractFilenameFromHeader,S.validateRangeRequestCapabilities=validateRangeRequestCapabilities,S.validateResponseStatus=validateResponseStatus;var C=E(1),T=E(21),P=E(6);function validateRangeRequestCapabilities({getResponseHeader:A,isHttp:S,rangeChunkSize:E,disableRange:C}){let T={allowRangeRequests:!1,suggestedLength:void 0},P=parseInt(A("Content-Length"),10);if(!Number.isInteger(P)||(T.suggestedLength=P,P<=2*E||C||!S||"bytes"!==A("Accept-Ranges")))return T;let M=A("Content-Encoding")||"identity";return"identity"!==M||(T.allowRangeRequests=!0),T}function extractFilenameFromHeader(A){let S=A("Content-Disposition");if(S){let A=(0,T.getFilenameFromContentDispositionHeader)(S);if(A.includes("%"))try{A=decodeURIComponent(A)}catch{}if((0,P.isPdfFile)(A))return A}return null}function createResponseStatusError(A,S){return 404===A||0===A&&S.startsWith("file:")?new C.MissingPDFException('Missing PDF "'+S+'".'):new C.UnexpectedResponseException(`Unexpected server response (${A}) while retrieving PDF "${S}".`,A)}function validateResponseStatus(A){return 200===A||206===A}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.getFilenameFromContentDispositionHeader=getFilenameFromContentDispositionHeader;var C=E(1);function getFilenameFromContentDispositionHeader(A){let S=!0,E=toParamRegExp("filename\\*","i").exec(A);if(E){let A=rfc2616unquote(E=E[1]);return fixupEncoding(A=rfc2047decode(A=rfc5987decode(A=unescape(A))))}if(E=rfc2231getparam(A)){let A=rfc2047decode(E);return fixupEncoding(A)}if(E=toParamRegExp("filename","i").exec(A)){let A=rfc2616unquote(E=E[1]);return fixupEncoding(A=rfc2047decode(A))}function toParamRegExp(A,S){return RegExp("(?:^|;)\\s*"+A+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',S)}function textdecode(A,E){if(A){if(!/^[\x00-\xFF]+$/.test(E))return E;try{let T=new TextDecoder(A,{fatal:!0}),P=(0,C.stringToBytes)(E);E=T.decode(P),S=!1}catch{}}return E}function fixupEncoding(A){return S&&/[\x80-\xff]/.test(A)&&(A=textdecode("utf-8",A),S&&(A=textdecode("iso-8859-1",A))),A}function rfc2231getparam(A){let S;let E=[],C=toParamRegExp("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(S=C.exec(A));){let[,A,C,T]=S;if((A=parseInt(A,10))in E){if(0===A)break;continue}E[A]=[C,T]}let T=[];for(let A=0;A<E.length&&(A in E);++A){let[S,C]=E[A];C=rfc2616unquote(C),S&&(C=unescape(C),0===A&&(C=rfc5987decode(C))),T.push(C)}return T.join("")}function rfc2616unquote(A){if(A.startsWith('"')){let S=A.slice(1).split('\\"');for(let A=0;A<S.length;++A){let E=S[A].indexOf('"');-1!==E&&(S[A]=S[A].slice(0,E),S.length=A+1),S[A]=S[A].replaceAll(/\\(.)/g,"$1")}A=S.join('"')}return A}function rfc5987decode(A){let S=A.indexOf("'");if(-1===S)return A;let E=A.slice(0,S),C=A.slice(S+1),T=C.replace(/^[^']*'/,"");return textdecode(E,T)}function rfc2047decode(A){return!A.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(A)?A:A.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(A,S,E,C){if("q"===E||"Q"===E)return textdecode(S,C=(C=C.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(A,S){return String.fromCharCode(parseInt(S,16))}));try{C=atob(C)}catch{}return textdecode(S,C)})}return""}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFNetworkStream=void 0;var C=E(1),T=E(20);let P=200,M=206;function getArrayBuffer(A){let S=A.response;return"string"!=typeof S?S:(0,C.stringToBytes)(S).buffer}let NetworkManager=class NetworkManager{constructor(A,S={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&S.httpHeaders||Object.create(null),this.withCredentials=S.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,S,E){let C={begin:A,end:S};for(let A in E)C[A]=E[A];return this.request(C)}requestFull(A){return this.request(A)}request(A){let S=new XMLHttpRequest,E=this.currXhrId++,C=this.pendingRequests[E]={xhr:S};for(let A in S.open("GET",this.url),S.withCredentials=this.withCredentials,this.httpHeaders){let E=this.httpHeaders[A];void 0!==E&&S.setRequestHeader(A,E)}return this.isHttp&&"begin"in A&&"end"in A?(S.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),C.expectedStatus=M):C.expectedStatus=P,S.responseType="arraybuffer",A.onError&&(S.onerror=function(E){A.onError(S.status)}),S.onreadystatechange=this.onStateChange.bind(this,E),S.onprogress=this.onProgress.bind(this,E),C.onHeadersReceived=A.onHeadersReceived,C.onDone=A.onDone,C.onError=A.onError,C.onProgress=A.onProgress,S.send(null),E}onProgress(A,S){let E=this.pendingRequests[A];E&&E.onProgress?.(S)}onStateChange(A,S){let E=this.pendingRequests[A];if(!E)return;let C=E.xhr;if(C.readyState>=2&&E.onHeadersReceived&&(E.onHeadersReceived(),delete E.onHeadersReceived),4!==C.readyState||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],0===C.status&&this.isHttp){E.onError?.(C.status);return}let T=C.status||P,R=T===P&&E.expectedStatus===M;if(!R&&T!==E.expectedStatus){E.onError?.(C.status);return}let F=getArrayBuffer(C);if(T===M){let A=C.getResponseHeader("Content-Range"),S=/bytes (\d+)-(\d+)\/(\d+)/.exec(A);E.onDone({begin:parseInt(S[1],10),chunk:F})}else F?E.onDone({begin:0,chunk:F}):E.onError?.(C.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){let S=this.pendingRequests[A].xhr;delete this.pendingRequests[A],S.abort()}};let PDFNetworkStream=class PDFNetworkStream{constructor(A){this._source=A,this._manager=new NetworkManager(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){let S=this._rangeRequestReaders.indexOf(A);S>=0&&this._rangeRequestReaders.splice(S,1)}getFullReader(){return(0,C.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source),this._fullRequestReader}getRangeReader(A,S){let E=new PDFNetworkStreamRangeRequestReader(this._manager,A,S);return E.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(E),E}cancelAllRequests(A){for(let S of(this._fullRequestReader?.cancel(A),this._rangeRequestReaders.slice(0)))S.cancel(A)}};S.PDFNetworkStream=PDFNetworkStream;let PDFNetworkStreamFullRequestReader=class PDFNetworkStreamFullRequestReader{constructor(A,S){this._manager=A;let E={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=S.url,this._fullRequestId=A.requestFull(E),this._headersReceivedCapability=new C.PromiseCapability,this._disableRange=S.disableRange||!1,this._contentLength=S.length,this._rangeChunkSize=S.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let A=this._fullRequestId,S=this._manager.getRequestXhr(A),getResponseHeader=A=>S.getResponseHeader(A),{allowRangeRequests:E,suggestedLength:C}=(0,T.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=C||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(getResponseHeader),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A){if(this._requests.length>0){let S=this._requests.shift();S.resolve({value:A.chunk,done:!1})}else this._cachedChunks.push(A.chunk)}if(this._done=!0,!(this._cachedChunks.length>0)){for(let A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){for(let S of(this._storedError=(0,T.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError),this._requests))S.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){this.onProgress?.({loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){let A=this._cachedChunks.shift();return{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};let A=new C.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){for(let S of(this._done=!0,this._headersReceivedCapability.reject(A),this._requests))S.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}};let PDFNetworkStreamRangeRequestReader=class PDFNetworkStreamRangeRequestReader{constructor(A,S,E){this._manager=A;let C={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(S,E,C),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(A){let S=A.chunk;if(this._requests.length>0){let A=this._requests.shift();A.resolve({value:S,done:!1})}else this._queuedChunk=S;for(let A of(this._done=!0,this._requests))A.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){for(let S of(this._storedError=(0,T.createResponseStatusError)(A,this._url),this._requests))S.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){this.isStreamingSupported||this.onProgress?.({loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){let A=this._queuedChunk;return this._queuedChunk=null,{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};let A=new C.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){for(let A of(this._done=!0,this._requests))A.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFNodeStream=void 0;var C=E(1),T=E(20);let P=/^file:\/\/\/[a-zA-Z]:\//;function parseUrl(A){let S=__webpack_require__(1987),E=S.parse(A);return"file:"===E.protocol||E.host?E:/^[a-z]:[/\\]/i.test(A)?S.parse(`file:///${A}`):(E.host||(E.protocol="file:"),E)}let PDFNodeStream=class PDFNodeStream{constructor(A){this.source=A,this.url=parseUrl(A.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&A.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,C.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new PDFNodeStreamFsFullReader(this):new PDFNodeStreamFullReader(this),this._fullRequestReader}getRangeReader(A,S){if(S<=this._progressiveDataLength)return null;let E=this.isFsUrl?new PDFNodeStreamFsRangeReader(this,A,S):new PDFNodeStreamRangeReader(this,A,S);return this._rangeRequestReaders.push(E),E}cancelAllRequests(A){for(let S of(this._fullRequestReader?.cancel(A),this._rangeRequestReaders.slice(0)))S.cancel(A)}};S.PDFNodeStream=PDFNodeStream;let BaseFullReader=class BaseFullReader{constructor(A){this._url=A.url,this._done=!1,this._storedError=null,this.onProgress=null;let S=A.source;this._contentLength=S.length,this._loaded=0,this._filename=null,this._disableRange=S.disableRange||!1,this._rangeChunkSize=S.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!S.disableStream,this._isRangeSupported=!S.disableRange,this._readableStream=null,this._readCapability=new C.PromiseCapability,this._headersCapability=new C.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let A=this._readableStream.read();if(null===A)return this._readCapability=new C.PromiseCapability,this.read();this._loaded+=A.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});let S=new Uint8Array(A).buffer;return{value:S,done:!1}}cancel(A){if(!this._readableStream){this._error(A);return}this._readableStream.destroy(A)}_error(A){this._storedError=A,this._readCapability.resolve()}_setReadableStream(A){this._readableStream=A,A.on("readable",()=>{this._readCapability.resolve()}),A.on("end",()=>{A.destroy(),this._done=!0,this._readCapability.resolve()}),A.on("error",A=>{this._error(A)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new C.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}};let BaseRangeReader=class BaseRangeReader{constructor(A){this._url=A.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new C.PromiseCapability;let S=A.source;this._isStreamingSupported=!S.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let A=this._readableStream.read();if(null===A)return this._readCapability=new C.PromiseCapability,this.read();this._loaded+=A.length,this.onProgress?.({loaded:this._loaded});let S=new Uint8Array(A).buffer;return{value:S,done:!1}}cancel(A){if(!this._readableStream){this._error(A);return}this._readableStream.destroy(A)}_error(A){this._storedError=A,this._readCapability.resolve()}_setReadableStream(A){this._readableStream=A,A.on("readable",()=>{this._readCapability.resolve()}),A.on("end",()=>{A.destroy(),this._done=!0,this._readCapability.resolve()}),A.on("error",A=>{this._error(A)}),this._storedError&&this._readableStream.destroy(this._storedError)}};function createRequestOptions(A,S){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:S}}let PDFNodeStreamFullReader=class PDFNodeStreamFullReader extends BaseFullReader{constructor(A){super(A);let handleResponse=S=>{if(404===S.statusCode){let A=new C.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A,this._headersCapability.reject(A);return}this._headersCapability.resolve(),this._setReadableStream(S);let getResponseHeader=A=>this._readableStream.headers[A.toLowerCase()],{allowRangeRequests:E,suggestedLength:P}=(0,T.validateRangeRequestCapabilities)({getResponseHeader,isHttp:A.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=E,this._contentLength=P||this._contentLength,this._filename=(0,T.extractFilenameFromHeader)(getResponseHeader)};if(this._request=null,"http:"===this._url.protocol){let S=__webpack_require__(2001);this._request=S.request(createRequestOptions(this._url,A.httpHeaders),handleResponse)}else{let S=__webpack_require__(3779);this._request=S.request(createRequestOptions(this._url,A.httpHeaders),handleResponse)}this._request.on("error",A=>{this._storedError=A,this._headersCapability.reject(A)}),this._request.end()}};let PDFNodeStreamRangeReader=class PDFNodeStreamRangeReader extends BaseRangeReader{constructor(A,S,E){for(let S in super(A),this._httpHeaders={},A.httpHeaders){let E=A.httpHeaders[S];void 0!==E&&(this._httpHeaders[S]=E)}this._httpHeaders.Range=`bytes=${S}-${E-1}`;let handleResponse=A=>{if(404===A.statusCode){let A=new C.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A;return}this._setReadableStream(A)};if(this._request=null,"http:"===this._url.protocol){let A=__webpack_require__(2001);this._request=A.request(createRequestOptions(this._url,this._httpHeaders),handleResponse)}else{let A=__webpack_require__(3779);this._request=A.request(createRequestOptions(this._url,this._httpHeaders),handleResponse)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}};let PDFNodeStreamFsFullReader=class PDFNodeStreamFsFullReader extends BaseFullReader{constructor(A){super(A);let S=decodeURIComponent(this._url.path);P.test(this._url.href)&&(S=S.replace(/^\//,""));let E=__webpack_require__(172);E.lstat(S,(A,T)=>{if(A){"ENOENT"===A.code&&(A=new C.MissingPDFException(`Missing PDF "${S}".`)),this._storedError=A,this._headersCapability.reject(A);return}this._contentLength=T.size,this._setReadableStream(E.createReadStream(S)),this._headersCapability.resolve()})}};let PDFNodeStreamFsRangeReader=class PDFNodeStreamFsRangeReader extends BaseRangeReader{constructor(A,S,E){super(A);let C=decodeURIComponent(this._url.path);P.test(this._url.href)&&(C=C.replace(/^\//,""));let T=__webpack_require__(172);this._setReadableStream(T.createReadStream(C,{start:S,end:E-1}))}}},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.SVGGraphics=void 0;var C=E(6),T=E(1);let P={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},M="http://www.w3.org/XML/1998/namespace",R="http://www.w3.org/1999/xlink",F=["butt","round","square"],I=["miter","round","bevel"],createObjectURL=function(A,S="",E=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!E)return URL.createObjectURL(new Blob([A],{type:S}));let C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=`data:${S};base64,`;for(let S=0,E=A.length;S<E;S+=3){let P=255&A[S],M=255&A[S+1],R=255&A[S+2],F=P>>2,I=(3&P)<<4|M>>4,D=S+1<E?(15&M)<<2|R>>6:64,L=S+2<E?63&R:64;T+=C[F]+C[I]+C[D]+C[L]}return T},D=function(){let A=new Uint8Array([137,80,78,71,13,10,26,10]),S=12,E=new Int32Array(256);for(let A=0;A<256;A++){let S=A;for(let A=0;A<8;A++)S=1&S?3988292384^S>>1&2147483647:S>>1&2147483647;E[A]=S}function crc32(A,S,C){let T=-1;for(let P=S;P<C;P++){let S=(T^A[P])&255,C=E[S];T=T>>>8^C}return -1^T}function writePngChunk(A,S,E,C){let T=C,P=S.length;E[T]=P>>24&255,E[T+1]=P>>16&255,E[T+2]=P>>8&255,E[T+3]=255&P,E[T+=4]=255&A.charCodeAt(0),E[T+1]=255&A.charCodeAt(1),E[T+2]=255&A.charCodeAt(2),E[T+3]=255&A.charCodeAt(3),T+=4,E.set(S,T),T+=S.length;let M=crc32(E,C+4,T);E[T]=M>>24&255,E[T+1]=M>>16&255,E[T+2]=M>>8&255,E[T+3]=255&M}function adler32(A,S,E){let C=1,T=0;for(let P=S;P<E;++P)T=(T+(C=(C+(255&A[P]))%65521))%65521;return T<<16|C}function deflateSync(A){if(!T.isNodeJS)return deflateSyncUncompressed(A);try{let S=parseInt(process.versions.node)>=8?A:Buffer.from(A),E=__webpack_require__(2258).deflateSync(S,{level:9});return E instanceof Uint8Array?E:new Uint8Array(E)}catch(A){(0,T.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+A)}return deflateSyncUncompressed(A)}function deflateSyncUncompressed(A){let S=A.length,E=65535,C=Math.ceil(S/E),T=new Uint8Array(2+S+5*C+4),P=0;T[P++]=120,T[P++]=156;let M=0;for(;S>E;)T[P++]=0,T[P++]=255,T[P++]=255,T[P++]=0,T[P++]=0,T.set(A.subarray(M,M+E),P),P+=E,M+=E,S-=E;T[P++]=1,T[P++]=255&S,T[P++]=S>>8&255,T[P++]=255&~S,T[P++]=(65535&~S)>>8&255,T.set(A.subarray(M),P),P+=A.length-M;let R=adler32(A,0,A.length);return T[P++]=R>>24&255,T[P++]=R>>16&255,T[P++]=R>>8&255,T[P++]=255&R,T}function encode(E,C,P,M){let R,F,I;let D=E.width,L=E.height,O=E.data;switch(C){case T.ImageKind.GRAYSCALE_1BPP:F=0,R=1,I=D+7>>3;break;case T.ImageKind.RGB_24BPP:F=2,R=8,I=3*D;break;case T.ImageKind.RGBA_32BPP:F=6,R=8,I=4*D;break;default:throw Error("invalid format")}let B=new Uint8Array((1+I)*L),N=0,U=0;for(let A=0;A<L;++A)B[N++]=0,B.set(O.subarray(U,U+I),N),U+=I,N+=I;if(C===T.ImageKind.GRAYSCALE_1BPP&&M){N=0;for(let A=0;A<L;A++){N++;for(let A=0;A<I;A++)B[N++]^=255}}let z=new Uint8Array([D>>24&255,D>>16&255,D>>8&255,255&D,L>>24&255,L>>16&255,L>>8&255,255&L,R,F,0,0,0]),H=deflateSync(B),W=A.length+3*S+z.length+H.length,V=new Uint8Array(W),$=0;return V.set(A,$),writePngChunk("IHDR",z,V,$+=A.length),writePngChunk("IDATA",H,V,$+=S+z.length),$+=S+H.length,writePngChunk("IEND",new Uint8Array(0),V,$),createObjectURL(V,"image/png",P)}return function(A,S,E){let C=void 0===A.kind?T.ImageKind.GRAYSCALE_1BPP:A.kind;return encode(A,C,S,E)}}();let SVGExtraState=class SVGExtraState{constructor(){this.fontSizeScale=1,this.fontWeight=P.fontWeight,this.fontSize=0,this.textMatrix=T.IDENTITY_MATRIX,this.fontMatrix=T.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=T.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=P.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(A,S){this.x=A,this.y=S}};function opListToTree(A){let S=[],E=[];for(let C of A){if("save"===C.fn){S.push({fnId:92,fn:"group",items:[]}),E.push(S),S=S.at(-1).items;continue}"restore"===C.fn?S=E.pop():S.push(C)}return S}function pf(A){if(Number.isInteger(A))return A.toString();let S=A.toFixed(10),E=S.length-1;if("0"!==S[E])return S;do E--;while("0"===S[E]);return S.substring(0,"."===S[E]?E:E+1)}function pm(A){if(0===A[4]&&0===A[5]){if(0===A[1]&&0===A[2])return 1===A[0]&&1===A[3]?"":`scale(${pf(A[0])} ${pf(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){let S=180*Math.acos(A[0])/Math.PI;return`rotate(${pf(S)})`}}else if(1===A[0]&&0===A[1]&&0===A[2]&&1===A[3])return`translate(${pf(A[4])} ${pf(A[5])})`;return`matrix(${pf(A[0])} ${pf(A[1])} ${pf(A[2])} ${pf(A[3])} ${pf(A[4])} ${pf(A[5])})`}let L=0,O=0,B=0;let SVGGraphics=class SVGGraphics{constructor(A,S,E=!1){for(let P in(0,C.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new C.DOMSVGFactory,this.current=new SVGExtraState,this.transformMatrix=T.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=A,this.objs=S,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!E,this._operatorIdMapping=[],T.OPS)this._operatorIdMapping[T.OPS[P]]=P}getObject(A,S=null){return"string"==typeof A?A.startsWith("g_")?this.commonObjs.get(A):this.objs.get(A):S}save(){this.transformStack.push(this.transformMatrix);let A=this.current;this.extraStack.push(A),this.current=A.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(A){this.save(),this.executeOpTree(A),this.restore()}loadDependencies(A){let S=A.fnArray,E=A.argsArray;for(let A=0,C=S.length;A<C;A++)if(S[A]===T.OPS.dependency)for(let S of E[A]){let A=S.startsWith("g_")?this.commonObjs:this.objs,E=new Promise(E=>{A.get(S,E)});this.current.dependencies.push(E)}return Promise.all(this.current.dependencies)}transform(A,S,E,C,P,M){let R=[A,S,E,C,P,M];this.transformMatrix=T.Util.transform(this.transformMatrix,R),this.tgrp=null}getSVG(A,S){this.viewport=S;let E=this._initialize(S);return this.loadDependencies(A).then(()=>(this.transformMatrix=T.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(A)),E))}convertOpList(A){let S=this._operatorIdMapping,E=A.argsArray,C=A.fnArray,T=[];for(let A=0,P=C.length;A<P;A++){let P=C[A];T.push({fnId:P,fn:S[P],args:E[A]})}return opListToTree(T)}executeOpTree(A){for(let S of A){let A=S.fn,E=S.fnId,C=S.args;switch(0|E){case T.OPS.beginText:this.beginText();break;case T.OPS.dependency:break;case T.OPS.setLeading:this.setLeading(C);break;case T.OPS.setLeadingMoveText:this.setLeadingMoveText(C[0],C[1]);break;case T.OPS.setFont:this.setFont(C);break;case T.OPS.showText:case T.OPS.showSpacedText:this.showText(C[0]);break;case T.OPS.endText:this.endText();break;case T.OPS.moveText:this.moveText(C[0],C[1]);break;case T.OPS.setCharSpacing:this.setCharSpacing(C[0]);break;case T.OPS.setWordSpacing:this.setWordSpacing(C[0]);break;case T.OPS.setHScale:this.setHScale(C[0]);break;case T.OPS.setTextMatrix:this.setTextMatrix(C[0],C[1],C[2],C[3],C[4],C[5]);break;case T.OPS.setTextRise:this.setTextRise(C[0]);break;case T.OPS.setTextRenderingMode:this.setTextRenderingMode(C[0]);break;case T.OPS.setLineWidth:this.setLineWidth(C[0]);break;case T.OPS.setLineJoin:this.setLineJoin(C[0]);break;case T.OPS.setLineCap:this.setLineCap(C[0]);break;case T.OPS.setMiterLimit:this.setMiterLimit(C[0]);break;case T.OPS.setFillRGBColor:this.setFillRGBColor(C[0],C[1],C[2]);break;case T.OPS.setStrokeRGBColor:this.setStrokeRGBColor(C[0],C[1],C[2]);break;case T.OPS.setStrokeColorN:this.setStrokeColorN(C);break;case T.OPS.setFillColorN:this.setFillColorN(C);break;case T.OPS.shadingFill:this.shadingFill(C[0]);break;case T.OPS.setDash:this.setDash(C[0],C[1]);break;case T.OPS.setRenderingIntent:this.setRenderingIntent(C[0]);break;case T.OPS.setFlatness:this.setFlatness(C[0]);break;case T.OPS.setGState:this.setGState(C[0]);break;case T.OPS.fill:this.fill();break;case T.OPS.eoFill:this.eoFill();break;case T.OPS.stroke:this.stroke();break;case T.OPS.fillStroke:this.fillStroke();break;case T.OPS.eoFillStroke:this.eoFillStroke();break;case T.OPS.clip:this.clip("nonzero");break;case T.OPS.eoClip:this.clip("evenodd");break;case T.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case T.OPS.paintImageXObject:this.paintImageXObject(C[0]);break;case T.OPS.paintInlineImageXObject:this.paintInlineImageXObject(C[0]);break;case T.OPS.paintImageMaskXObject:this.paintImageMaskXObject(C[0]);break;case T.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(C[0],C[1]);break;case T.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case T.OPS.closePath:this.closePath();break;case T.OPS.closeStroke:this.closeStroke();break;case T.OPS.closeFillStroke:this.closeFillStroke();break;case T.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case T.OPS.nextLine:this.nextLine();break;case T.OPS.transform:this.transform(C[0],C[1],C[2],C[3],C[4],C[5]);break;case T.OPS.constructPath:this.constructPath(C[0],C[1]);break;case T.OPS.endPath:this.endPath();break;case 92:this.group(S.items);break;default:(0,T.warn)(`Unimplemented operator ${A}`)}}}setWordSpacing(A){this.current.wordSpacing=A}setCharSpacing(A){this.current.charSpacing=A}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(A,S,E,C,T,P){let M=this.current;M.textMatrix=M.lineMatrix=[A,S,E,C,T,P],M.textMatrixScale=Math.hypot(A,S),M.x=M.lineX=0,M.y=M.lineY=0,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${pf(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",pf(-M.y)),M.txtElement=this.svgFactory.createElement("svg:text"),M.txtElement.append(M.tspan)}beginText(){let A=this.current;A.x=A.lineX=0,A.y=A.lineY=0,A.textMatrix=T.IDENTITY_MATRIX,A.lineMatrix=T.IDENTITY_MATRIX,A.textMatrixScale=1,A.tspan=this.svgFactory.createElement("svg:tspan"),A.txtElement=this.svgFactory.createElement("svg:text"),A.txtgrp=this.svgFactory.createElement("svg:g"),A.xcoords=[],A.ycoords=[]}moveText(A,S){let E=this.current;E.x=E.lineX+=A,E.y=E.lineY+=S,E.xcoords=[],E.ycoords=[],E.tspan=this.svgFactory.createElement("svg:tspan"),E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${pf(E.fontSize)}px`),E.tspan.setAttributeNS(null,"y",pf(-E.y))}showText(A){let S=this.current,E=S.font,C=S.fontSize;if(0===C)return;let R=S.fontSizeScale,F=S.charSpacing,I=S.wordSpacing,D=S.fontDirection,L=S.textHScale*D,O=E.vertical,B=O?1:-1,N=E.defaultVMetrics,U=C*S.fontMatrix[0],z=0;for(let T of A){let A,P;if(null===T){z+=D*I;continue}if("number"==typeof T){z+=B*T*C/1e3;continue}let M=(T.isSpace?I:0)+F,L=T.fontChar,H=T.width;if(O){let S;let E=T.vmetric||N;S=-(S=T.vmetric?E[1]:.5*H)*U;let C=E[2]*U;H=E?-E[0]:H,A=S/R,P=(z+C)/R}else A=z/R,P=0;(T.isInFont||E.missingFile)&&(S.xcoords.push(S.x+A),O&&S.ycoords.push(-S.y+P),S.tspan.textContent+=L);let W=O?H*U-M*D:H*U+M*D;z+=W}S.tspan.setAttributeNS(null,"x",S.xcoords.map(pf).join(" ")),O?S.tspan.setAttributeNS(null,"y",S.ycoords.map(pf).join(" ")):S.tspan.setAttributeNS(null,"y",pf(-S.y)),O?S.y-=z:S.x+=z*L,S.tspan.setAttributeNS(null,"font-family",S.fontFamily),S.tspan.setAttributeNS(null,"font-size",`${pf(S.fontSize)}px`),S.fontStyle!==P.fontStyle&&S.tspan.setAttributeNS(null,"font-style",S.fontStyle),S.fontWeight!==P.fontWeight&&S.tspan.setAttributeNS(null,"font-weight",S.fontWeight);let H=S.textRenderingMode&T.TextRenderingMode.FILL_STROKE_MASK;if(H===T.TextRenderingMode.FILL||H===T.TextRenderingMode.FILL_STROKE?(S.fillColor!==P.fillColor&&S.tspan.setAttributeNS(null,"fill",S.fillColor),S.fillAlpha<1&&S.tspan.setAttributeNS(null,"fill-opacity",S.fillAlpha)):S.textRenderingMode===T.TextRenderingMode.ADD_TO_PATH?S.tspan.setAttributeNS(null,"fill","transparent"):S.tspan.setAttributeNS(null,"fill","none"),H===T.TextRenderingMode.STROKE||H===T.TextRenderingMode.FILL_STROKE){let A=1/(S.textMatrixScale||1);this._setStrokeAttributes(S.tspan,A)}let W=S.textMatrix;0!==S.textRise&&(W=W.slice(),W[5]+=S.textRise),S.txtElement.setAttributeNS(null,"transform",`${pm(W)} scale(${pf(L)}, -1)`),S.txtElement.setAttributeNS(M,"xml:space","preserve"),S.txtElement.append(S.tspan),S.txtgrp.append(S.txtElement),this._ensureTransformGroup().append(S.txtElement)}setLeadingMoveText(A,S){this.setLeading(-S),this.moveText(A,S)}addFontStyle(A){if(!A.data)throw Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));let S=createObjectURL(A.data,A.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${A.loadedName}"; src: url(${S}); }
`}setFont(A){let S=this.current,E=this.commonObjs.get(A[0]),C=A[1];S.font=E,!this.embedFonts||E.missingFile||this.embeddedFonts[E.loadedName]||(this.addFontStyle(E),this.embeddedFonts[E.loadedName]=E),S.fontMatrix=E.fontMatrix||T.FONT_IDENTITY_MATRIX;let P="normal";E.black?P="900":E.bold&&(P="bold");let M=E.italic?"italic":"normal";C<0?(C=-C,S.fontDirection=-1):S.fontDirection=1,S.fontSize=C,S.fontFamily=E.loadedName,S.fontWeight=P,S.fontStyle=M,S.tspan=this.svgFactory.createElement("svg:tspan"),S.tspan.setAttributeNS(null,"y",pf(-S.y)),S.xcoords=[],S.ycoords=[]}endText(){let A=this.current;A.textRenderingMode&T.TextRenderingMode.ADD_TO_PATH_FLAG&&A.txtElement?.hasChildNodes()&&(A.element=A.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(A){A>0&&(this.current.lineWidth=A)}setLineCap(A){this.current.lineCap=F[A]}setLineJoin(A){this.current.lineJoin=I[A]}setMiterLimit(A){this.current.miterLimit=A}setStrokeAlpha(A){this.current.strokeAlpha=A}setStrokeRGBColor(A,S,E){this.current.strokeColor=T.Util.makeHexColor(A,S,E)}setFillAlpha(A){this.current.fillAlpha=A}setFillRGBColor(A,S,E){this.current.fillColor=T.Util.makeHexColor(A,S,E),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(A){this.current.strokeColor=this._makeColorN_Pattern(A)}setFillColorN(A){this.current.fillColor=this._makeColorN_Pattern(A)}shadingFill(A){let{width:S,height:E}=this.viewport,C=T.Util.inverseTransform(this.transformMatrix),[P,M,R,F]=T.Util.getAxialAlignedBoundingBox([0,0,S,E],C),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",P),I.setAttributeNS(null,"y",M),I.setAttributeNS(null,"width",R-P),I.setAttributeNS(null,"height",F-M),I.setAttributeNS(null,"fill",this._makeShadingPattern(A)),this.current.fillAlpha<1&&I.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(I)}_makeColorN_Pattern(A){return"TilingPattern"===A[0]?this._makeTilingPattern(A):this._makeShadingPattern(A)}_makeTilingPattern(A){let S=A[1],E=A[2],C=A[3]||T.IDENTITY_MATRIX,[P,M,R,F]=A[4],I=A[5],D=A[6],L=A[7],O=`shading${B++}`,[N,U,z,H]=T.Util.normalizeRect([...T.Util.applyTransform([P,M],C),...T.Util.applyTransform([R,F],C)]),[W,V]=T.Util.singularValueDecompose2dScale(C),$=I*W,X=D*V,K=this.svgFactory.createElement("svg:pattern");K.setAttributeNS(null,"id",O),K.setAttributeNS(null,"patternUnits","userSpaceOnUse"),K.setAttributeNS(null,"width",$),K.setAttributeNS(null,"height",X),K.setAttributeNS(null,"x",`${N}`),K.setAttributeNS(null,"y",`${U}`);let Y=this.svg,J=this.transformMatrix,Q=this.current.fillColor,Z=this.current.strokeColor,tt=this.svgFactory.create(z-N,H-U);if(this.svg=tt,this.transformMatrix=C,2===L){let A=T.Util.makeHexColor(...S);this.current.fillColor=A,this.current.strokeColor=A}return this.executeOpTree(this.convertOpList(E)),this.svg=Y,this.transformMatrix=J,this.current.fillColor=Q,this.current.strokeColor=Z,K.append(tt.childNodes[0]),this.defs.append(K),`url(#${O})`}_makeShadingPattern(A){switch("string"==typeof A&&(A=this.objs.get(A)),A[0]){case"RadialAxial":let S;let E=`shading${B++}`,C=A[3];switch(A[1]){case"axial":let P=A[4],M=A[5];(S=this.svgFactory.createElement("svg:linearGradient")).setAttributeNS(null,"id",E),S.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),S.setAttributeNS(null,"x1",P[0]),S.setAttributeNS(null,"y1",P[1]),S.setAttributeNS(null,"x2",M[0]),S.setAttributeNS(null,"y2",M[1]);break;case"radial":let R=A[4],F=A[5],I=A[6],D=A[7];(S=this.svgFactory.createElement("svg:radialGradient")).setAttributeNS(null,"id",E),S.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),S.setAttributeNS(null,"cx",F[0]),S.setAttributeNS(null,"cy",F[1]),S.setAttributeNS(null,"r",D),S.setAttributeNS(null,"fx",R[0]),S.setAttributeNS(null,"fy",R[1]),S.setAttributeNS(null,"fr",I);break;default:throw Error(`Unknown RadialAxial type: ${A[1]}`)}for(let A of C){let E=this.svgFactory.createElement("svg:stop");E.setAttributeNS(null,"offset",A[0]),E.setAttributeNS(null,"stop-color",A[1]),S.append(E)}return this.defs.append(S),`url(#${E})`;case"Mesh":return(0,T.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw Error(`Unknown IR type: ${A[0]}`)}}setDash(A,S){this.current.dashArray=A,this.current.dashPhase=S}constructPath(A,S){let E=this.current,C=E.x,P=E.y,M=[],R=0;for(let E of A)switch(0|E){case T.OPS.rectangle:C=S[R++],P=S[R++];let A=S[R++],F=S[R++],I=C+A,D=P+F;M.push("M",pf(C),pf(P),"L",pf(I),pf(P),"L",pf(I),pf(D),"L",pf(C),pf(D),"Z");break;case T.OPS.moveTo:C=S[R++],P=S[R++],M.push("M",pf(C),pf(P));break;case T.OPS.lineTo:C=S[R++],P=S[R++],M.push("L",pf(C),pf(P));break;case T.OPS.curveTo:C=S[R+4],P=S[R+5],M.push("C",pf(S[R]),pf(S[R+1]),pf(S[R+2]),pf(S[R+3]),pf(C),pf(P)),R+=6;break;case T.OPS.curveTo2:M.push("C",pf(C),pf(P),pf(S[R]),pf(S[R+1]),pf(S[R+2]),pf(S[R+3])),C=S[R+2],P=S[R+3],R+=4;break;case T.OPS.curveTo3:C=S[R+2],P=S[R+3],M.push("C",pf(S[R]),pf(S[R+1]),pf(C),pf(P),pf(C),pf(P)),R+=4;break;case T.OPS.closePath:M.push("Z")}M=M.join(" "),E.path&&A.length>0&&A[0]!==T.OPS.rectangle&&A[0]!==T.OPS.moveTo?M=E.path.getAttributeNS(null,"d")+M:(E.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(E.path)),E.path.setAttributeNS(null,"d",M),E.path.setAttributeNS(null,"fill","none"),E.element=E.path,E.setCurrentPoint(C,P)}endPath(){let A=this.current;if(A.path=null,!this.pendingClip)return;if(!A.element){this.pendingClip=null;return}let S=`clippath${L++}`,E=this.svgFactory.createElement("svg:clipPath");E.setAttributeNS(null,"id",S),E.setAttributeNS(null,"transform",pm(this.transformMatrix));let C=A.element.cloneNode(!0);if("evenodd"===this.pendingClip?C.setAttributeNS(null,"clip-rule","evenodd"):C.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,E.append(C),this.defs.append(E),A.activeClipUrl){for(let S of(A.clipGroup=null,this.extraStack))S.clipGroup=null;E.setAttributeNS(null,"clip-path",A.activeClipUrl)}A.activeClipUrl=`url(#${S})`,this.tgrp=null}clip(A){this.pendingClip=A}closePath(){let A=this.current;if(A.path){let S=`${A.path.getAttributeNS(null,"d")}Z`;A.path.setAttributeNS(null,"d",S)}}setLeading(A){this.current.leading=-A}setTextRise(A){this.current.textRise=A}setTextRenderingMode(A){this.current.textRenderingMode=A}setHScale(A){this.current.textHScale=A/100}setRenderingIntent(A){}setFlatness(A){}setGState(A){for(let[S,E]of A)switch(S){case"LW":this.setLineWidth(E);break;case"LC":this.setLineCap(E);break;case"LJ":this.setLineJoin(E);break;case"ML":this.setMiterLimit(E);break;case"D":this.setDash(E[0],E[1]);break;case"RI":this.setRenderingIntent(E);break;case"FL":this.setFlatness(E);break;case"Font":this.setFont(E);break;case"CA":this.setStrokeAlpha(E);break;case"ca":this.setFillAlpha(E);break;default:(0,T.warn)(`Unimplemented graphic state operator ${S}`)}}fill(){let A=this.current;A.element&&(A.element.setAttributeNS(null,"fill",A.fillColor),A.element.setAttributeNS(null,"fill-opacity",A.fillAlpha),this.endPath())}stroke(){let A=this.current;A.element&&(this._setStrokeAttributes(A.element),A.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(A,S=1){let E=this.current,C=E.dashArray;1!==S&&C.length>0&&(C=C.map(function(A){return S*A})),A.setAttributeNS(null,"stroke",E.strokeColor),A.setAttributeNS(null,"stroke-opacity",E.strokeAlpha),A.setAttributeNS(null,"stroke-miterlimit",pf(E.miterLimit)),A.setAttributeNS(null,"stroke-linecap",E.lineCap),A.setAttributeNS(null,"stroke-linejoin",E.lineJoin),A.setAttributeNS(null,"stroke-width",pf(S*E.lineWidth)+"px"),A.setAttributeNS(null,"stroke-dasharray",C.map(pf).join(" ")),A.setAttributeNS(null,"stroke-dashoffset",pf(S*E.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){let A=this.svgFactory.createElement("svg:rect");A.setAttributeNS(null,"x","0"),A.setAttributeNS(null,"y","0"),A.setAttributeNS(null,"width","1px"),A.setAttributeNS(null,"height","1px"),A.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(A)}paintImageXObject(A){let S=this.getObject(A);if(!S){(0,T.warn)(`Dependent image with object ID ${A} is not ready yet`);return}this.paintInlineImageXObject(S)}paintInlineImageXObject(A,S){let E=A.width,C=A.height,T=D(A,this.forceDataSchema,!!S),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",pf(E)),P.setAttributeNS(null,"height",pf(C)),this.current.element=P,this.clip("nonzero");let M=this.svgFactory.createElement("svg:image");M.setAttributeNS(R,"xlink:href",T),M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y",pf(-C)),M.setAttributeNS(null,"width",pf(E)+"px"),M.setAttributeNS(null,"height",pf(C)+"px"),M.setAttributeNS(null,"transform",`scale(${pf(1/E)} ${pf(-1/C)})`),S?S.append(M):this._ensureTransformGroup().append(M)}paintImageMaskXObject(A){let S=this.getObject(A.data,A);if(S.bitmap){(0,T.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}let E=this.current,C=S.width,P=S.height,M=E.fillColor;E.maskId=`mask${O++}`;let R=this.svgFactory.createElement("svg:mask");R.setAttributeNS(null,"id",E.maskId);let F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",pf(C)),F.setAttributeNS(null,"height",pf(P)),F.setAttributeNS(null,"fill",M),F.setAttributeNS(null,"mask",`url(#${E.maskId})`),this.defs.append(R),this._ensureTransformGroup().append(F),this.paintInlineImageXObject(S,R)}paintFormXObjectBegin(A,S){if(Array.isArray(A)&&6===A.length&&this.transform(A[0],A[1],A[2],A[3],A[4],A[5]),S){let A=S[2]-S[0],E=S[3]-S[1],C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x",S[0]),C.setAttributeNS(null,"y",S[1]),C.setAttributeNS(null,"width",pf(A)),C.setAttributeNS(null,"height",pf(E)),this.current.element=C,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(A){let S=this.svgFactory.create(A.width,A.height),E=this.svgFactory.createElement("svg:defs");S.append(E),this.defs=E;let C=this.svgFactory.createElement("svg:g");return C.setAttributeNS(null,"transform",pm(A.transform)),S.append(C),this.svg=C,S}_ensureClipGroup(){if(!this.current.clipGroup){let A=this.svgFactory.createElement("svg:g");A.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(A),this.current.clipGroup=A}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",pm(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}};S.SVGGraphics=SVGGraphics},(A,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.XfaText=void 0;let XfaText=class XfaText{static textContent(A){let S=[],E={items:S,styles:Object.create(null)};function walk(A){if(!A)return;let E=null,C=A.name;if("#text"===C)E=A.value;else{if(!XfaText.shouldBuildText(C))return;A?.attributes?.textContent?E=A.attributes.textContent:A.value&&(E=A.value)}if(null!==E&&S.push({str:E}),A.children)for(let S of A.children)walk(S)}return walk(A),E}static shouldBuildText(A){return!("textarea"===A||"input"===A||"option"===A||"select"===A)}};S.XfaText=XfaText},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.TextLayerRenderTask=void 0,S.renderTextLayer=renderTextLayer,S.updateTextLayer=updateTextLayer;var C=E(1),T=E(6);let P=1e5,M=30,R=.8,F=new Map;function getCtx(A,S){let E;if(S&&C.FeatureTest.isOffscreenCanvasSupported)E=new OffscreenCanvas(A,A).getContext("2d",{alpha:!1});else{let S=document.createElement("canvas");S.width=S.height=A,E=S.getContext("2d",{alpha:!1})}return E}function getAscent(A,S){let E=F.get(A);if(E)return E;let C=getCtx(M,S);C.font=`${M}px ${A}`;let T=C.measureText(""),P=T.fontBoundingBoxAscent,I=Math.abs(T.fontBoundingBoxDescent);if(P){let S=P/(P+I);return F.set(A,S),C.canvas.width=C.canvas.height=0,S}C.strokeStyle="red",C.clearRect(0,0,M,M),C.strokeText("g",0,0);let D=C.getImageData(0,0,M,M).data;I=0;for(let A=D.length-1-3;A>=0;A-=4)if(D[A]>0){I=Math.ceil(A/4/M);break}C.clearRect(0,0,M,M),C.strokeText("A",0,M),D=C.getImageData(0,0,M,M).data,P=0;for(let A=0,S=D.length;A<S;A+=4)if(D[A]>0){P=M-Math.floor(A/4/M);break}if(C.canvas.width=C.canvas.height=0,P){let S=P/(P+I);return F.set(A,S),S}return F.set(A,R),R}function appendText(A,S,E){let T,P;let M=document.createElement("span"),R={angle:0,canvasWidth:0,hasText:""!==S.str,hasEOL:S.hasEOL,fontSize:0};A._textDivs.push(M);let F=C.Util.transform(A._transform,S.transform),I=Math.atan2(F[1],F[0]),D=E[S.fontName];D.vertical&&(I+=Math.PI/2);let L=Math.hypot(F[2],F[3]),O=L*getAscent(D.fontFamily,A._isOffscreenCanvasSupported);0===I?(T=F[4],P=F[5]-O):(T=F[4]+O*Math.sin(I),P=F[5]-O*Math.cos(I));let B="calc(var(--scale-factor)*",N=M.style;A._container===A._rootContainer?(N.left=`${(100*T/A._pageWidth).toFixed(2)}%`,N.top=`${(100*P/A._pageHeight).toFixed(2)}%`):(N.left=`${B}${T.toFixed(2)}px)`,N.top=`${B}${P.toFixed(2)}px)`),N.fontSize=`${B}${L.toFixed(2)}px)`,N.fontFamily=D.fontFamily,R.fontSize=L,M.setAttribute("role","presentation"),M.textContent=S.str,M.dir=S.dir,A._fontInspectorEnabled&&(M.dataset.fontName=S.fontName),0!==I&&(R.angle=I*(180/Math.PI));let U=!1;if(S.str.length>1)U=!0;else if(" "!==S.str&&S.transform[0]!==S.transform[3]){let A=Math.abs(S.transform[0]),E=Math.abs(S.transform[3]);A!==E&&Math.max(A,E)/Math.min(A,E)>1.5&&(U=!0)}U&&(R.canvasWidth=D.vertical?S.height:S.width),A._textDivProperties.set(M,R),A._isReadableStream&&A._layoutText(M)}function layout(A){let{div:S,scale:E,properties:C,ctx:T,prevFontSize:P,prevFontFamily:M}=A,{style:R}=S,F="";if(0!==C.canvasWidth&&C.hasText){let{fontFamily:I}=R,{canvasWidth:D,fontSize:L}=C;(P!==L||M!==I)&&(T.font=`${L*E}px ${I}`,A.prevFontSize=L,A.prevFontFamily=I);let{width:O}=T.measureText(S.textContent);O>0&&(F=`scaleX(${D*E/O})`)}0!==C.angle&&(F=`rotate(${C.angle}deg) ${F}`),F.length>0&&(R.transform=F)}function render(A){if(A._canceled)return;let S=A._textDivs,E=A._capability,C=S.length;if(C>P){E.resolve();return}if(!A._isReadableStream)for(let E of S)A._layoutText(E);E.resolve()}let TextLayerRenderTask=class TextLayerRenderTask{constructor({textContentSource:A,container:S,viewport:E,textDivs:P,textDivProperties:M,textContentItemsStr:R,isOffscreenCanvasSupported:F}){this._textContentSource=A,this._isReadableStream=A instanceof ReadableStream,this._container=this._rootContainer=S,this._textDivs=P||[],this._textContentItemsStr=R||[],this._isOffscreenCanvasSupported=F,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=M||new WeakMap,this._canceled=!1,this._capability=new C.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:getCtx(0,F)};let{pageWidth:I,pageHeight:D,pageX:L,pageY:O}=E.rawDims;this._transform=[1,0,0,-1,-L,O+D],this._pageWidth=I,this._pageHeight=D,(0,T.setLayerDimensions)(S,E),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new C.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new C.AbortException("TextLayer task cancelled."))}_processItems(A,S){for(let E of A){if(void 0===E.str){if("beginMarkedContentProps"===E.type||"beginMarkedContent"===E.type){let A=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==E.id&&this._container.setAttribute("id",`${E.id}`),A.append(this._container)}else"endMarkedContent"===E.type&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(E.str),appendText(this,E,S)}}_layoutText(A){let S=this._layoutTextParams.properties=this._textDivProperties.get(A);if(this._layoutTextParams.div=A,layout(this._layoutTextParams),S.hasText&&this._container.append(A),S.hasEOL){let A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){let A=new C.PromiseCapability,S=Object.create(null);if(this._isReadableStream){let pump=()=>{this._reader.read().then(({value:E,done:C})=>{if(C){A.resolve();return}Object.assign(S,E.styles),this._processItems(E.items,S),pump()},A.reject)};this._reader=this._textContentSource.getReader(),pump()}else if(this._textContentSource){let{items:S,styles:E}=this._textContentSource;this._processItems(S,E),A.resolve()}else throw Error('No "textContentSource" parameter specified.');A.promise.then(()=>{S=null,render(this)},this._capability.reject)}};function renderTextLayer(A){!A.textContentSource&&(A.textContent||A.textContentStream)&&((0,T.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),A.textContentSource=A.textContent||A.textContentStream);let{container:S,viewport:E}=A,C=getComputedStyle(S),P=C.getPropertyValue("visibility"),M=parseFloat(C.getPropertyValue("--scale-factor"));"visible"===P&&(!M||Math.abs(M-E.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");let R=new TextLayerRenderTask(A);return R._render(),R}function updateTextLayer({container:A,viewport:S,textDivs:E,textDivProperties:C,isOffscreenCanvasSupported:P,mustRotate:M=!0,mustRescale:R=!0}){if(M&&(0,T.setLayerDimensions)(A,{rotation:S.rotation}),R){let A=getCtx(0,P),T=S.scale*(globalThis.devicePixelRatio||1),M={prevFontSize:null,prevFontFamily:null,div:null,scale:T,properties:null,ctx:A};for(let A of E)M.properties=C.get(A),M.div=A,layout(M)}}S.TextLayerRenderTask=TextLayerRenderTask},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.AnnotationEditorLayer=void 0;var C=E(1),T=E(4),P=E(28),M=E(33),R=E(6),F=E(34);let AnnotationEditorLayer=class AnnotationEditorLayer{#eu;#ep=!1;#ef=null;#eg=this.pointerup.bind(this);#em=this.pointerdown.bind(this);#eb=new Map;#eA=!1;#ey=!1;#ev=!1;#e_;static _initialized=!1;constructor({uiManager:A,pageIndex:S,div:E,accessibilityManager:C,annotationLayer:T,viewport:R,l10n:I}){let D=[P.FreeTextEditor,M.InkEditor,F.StampEditor];if(!AnnotationEditorLayer._initialized)for(let A of(AnnotationEditorLayer._initialized=!0,D))A.initialize(I);A.registerEditorTypes(D),this.#e_=A,this.pageIndex=S,this.div=E,this.#eu=C,this.#ef=T,this.viewport=R,this.#e_.addLayer(this)}get isEmpty(){return 0===this.#eb.size}updateToolbar(A){this.#e_.updateToolbar(A)}updateMode(A=this.#e_.getMode()){this.#eS(),A===C.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),A!==C.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",A===C.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",A===C.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",A===C.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(A){if(!A&&this.#e_.getMode()!==C.AnnotationEditorType.INK)return;if(!A){for(let A of this.#eb.values())if(A.isEmpty()){A.setInBackground();return}}let S=this.#eE({offsetX:0,offsetY:0},!1);S.setInBackground()}setEditingState(A){this.#e_.setEditingState(A)}addCommands(A){this.#e_.addCommands(A)}enable(){this.div.style.pointerEvents="auto";let A=new Set;for(let S of this.#eb.values())S.enableEditing(),S.annotationElementId&&A.add(S.annotationElementId);if(!this.#ef)return;let S=this.#ef.getEditableAnnotations();for(let E of S){if(E.hide(),this.#e_.isDeletedAnnotationElement(E.data.id)||A.has(E.data.id))continue;let S=this.deserialize(E);S&&(this.addOrRebuild(S),S.enableEditing())}}disable(){this.#ev=!0,this.div.style.pointerEvents="none";let A=new Set;for(let S of this.#eb.values()){if(S.disableEditing(),!S.annotationElementId||null!==S.serialize()){A.add(S.annotationElementId);continue}this.getEditableAnnotation(S.annotationElementId)?.show(),S.remove()}if(this.#ef){let S=this.#ef.getEditableAnnotations();for(let E of S){let{id:S}=E.data;A.has(S)||this.#e_.isDeletedAnnotationElement(S)||E.show()}}this.#eS(),this.isEmpty&&(this.div.hidden=!0),this.#ev=!1}getEditableAnnotation(A){return this.#ef?.getEditableAnnotation(A)||null}setActiveEditor(A){let S=this.#e_.getActive();S!==A&&this.#e_.setActiveEditor(A)}enableClick(){this.div.addEventListener("pointerdown",this.#em),this.div.addEventListener("pointerup",this.#eg)}disableClick(){this.div.removeEventListener("pointerdown",this.#em),this.div.removeEventListener("pointerup",this.#eg)}attach(A){this.#eb.set(A.id,A);let{annotationElementId:S}=A;S&&this.#e_.isDeletedAnnotationElement(S)&&this.#e_.removeDeletedAnnotationElement(A)}detach(A){this.#eb.delete(A.id),this.#eu?.removePointerInTextLayer(A.contentDiv),!this.#ev&&A.annotationElementId&&this.#e_.addDeletedAnnotationElement(A)}remove(A){this.detach(A),this.#e_.removeEditor(A),A.div.contains(document.activeElement)&&setTimeout(()=>{this.#e_.focusMainContainer()},0),A.div.remove(),A.isAttachedToDOM=!1,this.#ey||this.addInkEditorIfNeeded(!1)}changeParent(A){A.parent!==this&&(A.annotationElementId&&(this.#e_.addDeletedAnnotationElement(A.annotationElementId),T.AnnotationEditor.deleteAnnotationElement(A),A.annotationElementId=null),this.attach(A),A.parent?.detach(A),A.setParent(this),A.div&&A.isAttachedToDOM&&(A.div.remove(),this.div.append(A.div)))}add(A){if(this.changeParent(A),this.#e_.addEditor(A),this.attach(A),!A.isAttachedToDOM){let S=A.render();this.div.append(S),A.isAttachedToDOM=!0}A.fixAndSetPosition(),A.onceAdded(),this.#e_.addToAnnotationStorage(A)}moveEditorInDOM(A){if(!A.isAttachedToDOM)return;let{activeElement:S}=document;A.div.contains(S)&&(A._focusEventsAllowed=!1,setTimeout(()=>{A.div.contains(document.activeElement)?A._focusEventsAllowed=!0:(A.div.addEventListener("focusin",()=>{A._focusEventsAllowed=!0},{once:!0}),S.focus())},0)),A._structTreeParentId=this.#eu?.moveElementInDOM(this.div,A.div,A.contentDiv,!0)}addOrRebuild(A){A.needsToBeRebuilt()?A.rebuild():this.add(A)}addUndoableEditor(A){let cmd=()=>A._uiManager.rebuild(A),undo=()=>{A.remove()};this.addCommands({cmd,undo,mustExec:!1})}getNextId(){return this.#e_.getId()}#ex(A){switch(this.#e_.getMode()){case C.AnnotationEditorType.FREETEXT:return new P.FreeTextEditor(A);case C.AnnotationEditorType.INK:return new M.InkEditor(A);case C.AnnotationEditorType.STAMP:return new F.StampEditor(A)}return null}pasteEditor(A,S){this.#e_.updateToolbar(A),this.#e_.updateMode(A);let{offsetX:E,offsetY:C}=this.#eC(),T=this.getNextId(),P=this.#ex({parent:this,id:T,x:E,y:C,uiManager:this.#e_,isCentered:!0,...S});P&&this.add(P)}deserialize(A){switch(A.annotationType??A.annotationEditorType){case C.AnnotationEditorType.FREETEXT:return P.FreeTextEditor.deserialize(A,this,this.#e_);case C.AnnotationEditorType.INK:return M.InkEditor.deserialize(A,this,this.#e_);case C.AnnotationEditorType.STAMP:return F.StampEditor.deserialize(A,this,this.#e_)}return null}#eE(A,S){let E=this.getNextId(),C=this.#ex({parent:this,id:E,x:A.offsetX,y:A.offsetY,uiManager:this.#e_,isCentered:S});return C&&this.add(C),C}#eC(){let{x:A,y:S,width:E,height:C}=this.div.getBoundingClientRect(),T=Math.max(0,A),P=Math.max(0,S),M=Math.min(window.innerWidth,A+E),R=Math.min(window.innerHeight,S+C),F=(T+M)/2-A,I=(P+R)/2-S,[D,L]=this.viewport.rotation%180==0?[F,I]:[I,F];return{offsetX:D,offsetY:L}}addNewEditor(){this.#eE(this.#eC(),!0)}setSelected(A){this.#e_.setSelected(A)}toggleSelected(A){this.#e_.toggleSelected(A)}isSelected(A){return this.#e_.isSelected(A)}unselect(A){this.#e_.unselect(A)}pointerup(A){let{isMac:S}=C.FeatureTest.platform;if(0===A.button&&(!A.ctrlKey||!S)&&A.target===this.div&&this.#eA){if(this.#eA=!1,!this.#ep){this.#ep=!0;return}if(this.#e_.getMode()===C.AnnotationEditorType.STAMP){this.#e_.unselectAll();return}this.#eE(A,!1)}}pointerdown(A){if(this.#eA){this.#eA=!1;return}let{isMac:S}=C.FeatureTest.platform;if(0!==A.button||A.ctrlKey&&S||A.target!==this.div)return;this.#eA=!0;let E=this.#e_.getActive();this.#ep=!E||E.isEmpty()}findNewParent(A,S,E){let C=this.#e_.findParent(S,E);return null!==C&&C!==this&&(C.changeParent(A),!0)}destroy(){for(let A of(this.#e_.getActive()?.parent===this&&(this.#e_.commitOrRemove(),this.#e_.setActiveEditor(null)),this.#eb.values()))this.#eu?.removePointerInTextLayer(A.contentDiv),A.setParent(null),A.isAttachedToDOM=!1,A.div.remove();this.div=null,this.#eb.clear(),this.#e_.removeLayer(this)}#eS(){for(let A of(this.#ey=!0,this.#eb.values()))A.isEmpty()&&A.remove();this.#ey=!1}render({viewport:A}){for(let S of(this.viewport=A,(0,R.setLayerDimensions)(this.div,A),this.#e_.getEditors(this.pageIndex)))this.add(S);this.updateMode()}update({viewport:A}){this.#e_.commitOrRemove(),this.viewport=A,(0,R.setLayerDimensions)(this.div,{rotation:A.rotation}),this.updateMode()}get pageDimensions(){let{pageWidth:A,pageHeight:S}=this.viewport.rawDims;return[A,S]}};S.AnnotationEditorLayer=AnnotationEditorLayer},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.FreeTextEditor=void 0;var C=E(1),T=E(5),P=E(4),M=E(29);let FreeTextEditor=class FreeTextEditor extends P.AnnotationEditor{#ew=this.editorDivBlur.bind(this);#eT=this.editorDivFocus.bind(this);#eP=this.editorDivInput.bind(this);#ek=this.editorDivKeydown.bind(this);#eM;#eR="";#eF=`${this.id}-editor`;#eI;#eD=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let A=FreeTextEditor.prototype,arrowChecker=A=>A.isEmpty(),S=T.AnnotationEditorUIManager.TRANSLATE_SMALL,E=T.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,C.shadow)(this,"_keyboardManager",new T.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],A.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],A.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],A._translateEmpty,{args:[-S,0],checker:arrowChecker}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],A._translateEmpty,{args:[-E,0],checker:arrowChecker}],[["ArrowRight","mac+ArrowRight"],A._translateEmpty,{args:[S,0],checker:arrowChecker}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],A._translateEmpty,{args:[E,0],checker:arrowChecker}],[["ArrowUp","mac+ArrowUp"],A._translateEmpty,{args:[0,-S],checker:arrowChecker}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],A._translateEmpty,{args:[0,-E],checker:arrowChecker}],[["ArrowDown","mac+ArrowDown"],A._translateEmpty,{args:[0,S],checker:arrowChecker}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],A._translateEmpty,{args:[0,E],checker:arrowChecker}]]))}static _type="freetext";constructor(A){super({...A,name:"freeTextEditor"}),this.#eM=A.color||FreeTextEditor._defaultColor||P.AnnotationEditor._defaultLineColor,this.#eI=A.fontSize||FreeTextEditor._defaultFontSize}static initialize(A){P.AnnotationEditor.initialize(A,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});let S=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(S.getPropertyValue("--freetext-padding"))}static updateDefaultParams(A,S){switch(A){case C.AnnotationEditorParamsType.FREETEXT_SIZE:FreeTextEditor._defaultFontSize=S;break;case C.AnnotationEditorParamsType.FREETEXT_COLOR:FreeTextEditor._defaultColor=S}}updateParams(A,S){switch(A){case C.AnnotationEditorParamsType.FREETEXT_SIZE:this.#eL(S);break;case C.AnnotationEditorParamsType.FREETEXT_COLOR:this.#eO(S)}}static get defaultPropertiesToUpdate(){return[[C.AnnotationEditorParamsType.FREETEXT_SIZE,FreeTextEditor._defaultFontSize],[C.AnnotationEditorParamsType.FREETEXT_COLOR,FreeTextEditor._defaultColor||P.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[C.AnnotationEditorParamsType.FREETEXT_SIZE,this.#eI],[C.AnnotationEditorParamsType.FREETEXT_COLOR,this.#eM]]}#eL(A){let setFontsize=A=>{this.editorDiv.style.fontSize=`calc(${A}px * var(--scale-factor))`,this.translate(0,-(A-this.#eI)*this.parentScale),this.#eI=A,this.#eB()},S=this.#eI;this.addCommands({cmd:()=>{setFontsize(A)},undo:()=>{setFontsize(S)},mustExec:!0,type:C.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#eO(A){let S=this.#eM;this.addCommands({cmd:()=>{this.#eM=this.editorDiv.style.color=A},undo:()=>{this.#eM=this.editorDiv.style.color=S},mustExec:!0,type:C.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(A,S){this._uiManager.translateSelectedEditors(A,S,!0)}getInitialTranslation(){let A=this.parentScale;return[-FreeTextEditor._internalPadding*A,-(FreeTextEditor._internalPadding+this.#eI)*A]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(C.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#ek),this.editorDiv.addEventListener("focus",this.#eT),this.editorDiv.addEventListener("blur",this.#ew),this.editorDiv.addEventListener("input",this.#eP))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#eF),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#ek),this.editorDiv.removeEventListener("focus",this.#eT),this.editorDiv.removeEventListener("blur",this.#ew),this.editorDiv.removeEventListener("input",this.#eP),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(A){this._focusEventsAllowed&&(super.focusin(A),A.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#eN();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#eU(){let A=this.editorDiv.getElementsByTagName("div");if(0===A.length)return this.editorDiv.innerText;let S=[];for(let E of A)S.push(E.innerText.replace(/\r\n?|\n/,""));return S.join("\n")}#eB(){let A;let[S,E]=this.parentDimensions;if(this.isAttachedToDOM)A=this.div.getBoundingClientRect();else{let{currentLayer:S,div:E}=this,C=E.style.display;E.style.display="hidden",S.div.append(this.div),A=E.getBoundingClientRect(),E.remove(),E.style.display=C}this.rotation%180==this.parentRotation%180?(this.width=A.width/S,this.height=A.height/E):(this.width=A.height/S,this.height=A.width/E),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let A=this.#eR,S=this.#eR=this.#eU().trimEnd();if(A===S)return;let setText=A=>{if(this.#eR=A,!A){this.remove();return}this.#ej(),this._uiManager.rebuild(this),this.#eB()};this.addCommands({cmd:()=>{setText(S)},undo:()=>{setText(A)},mustExec:!1}),this.#eB()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(A){this.enterInEditMode()}keydown(A){A.target===this.div&&"Enter"===A.key&&(this.enterInEditMode(),A.preventDefault())}editorDivKeydown(A){FreeTextEditor._keyboardManager.exec(this,A)}editorDivFocus(A){this.isEditing=!0}editorDivBlur(A){this.isEditing=!1}editorDivInput(A){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){let A,S;if(this.div)return this.div;this.width&&(A=this.x,S=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#eF),this.enableEditing(),P.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(A=>this.editorDiv?.setAttribute("aria-label",A)),P.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(A=>this.editorDiv?.setAttribute("default-content",A)),this.editorDiv.contentEditable=!0;let{style:E}=this.editorDiv;if(E.fontSize=`calc(${this.#eI}px * var(--scale-factor))`,E.color=this.#eM,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,T.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){let[E,C]=this.parentDimensions;if(this.annotationElementId){let T,P;let{position:M}=this.#eD,[R,F]=this.getInitialTranslation();[R,F]=this.pageTranslationToScreen(R,F);let[I,D]=this.pageDimensions,[L,O]=this.pageTranslation;switch(this.rotation){case 0:T=A+(M[0]-L)/I,P=S+this.height-(M[1]-O)/D;break;case 90:T=A+(M[0]-L)/I,P=S-(M[1]-O)/D,[R,F]=[F,-R];break;case 180:T=A-this.width+(M[0]-L)/I,P=S-(M[1]-O)/D,[R,F]=[-R,-F];break;case 270:T=A+(M[0]-L-this.height*D)/I,P=S+(M[1]-O-this.width*I)/D,[R,F]=[-F,R]}this.setAt(T*E,P*C,R,F)}else this.setAt(A*E,S*C,this.width*E,this.height*C);this.#ej(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#ej(){if(this.editorDiv.replaceChildren(),this.#eR)for(let A of this.#eR.split("\n")){let S=document.createElement("div");S.append(A?document.createTextNode(A):document.createElement("br")),this.editorDiv.append(S)}}get contentDiv(){return this.editorDiv}static deserialize(A,S,E){let T=null;if(A instanceof M.FreeTextAnnotationElement){let{data:{defaultAppearanceData:{fontSize:S,fontColor:E},rect:P,rotation:M,id:R},textContent:F,textPosition:I,parent:{page:{pageNumber:D}}}=A;if(!F||0===F.length)return null;T=A={annotationType:C.AnnotationEditorType.FREETEXT,color:Array.from(E),fontSize:S,value:F.join("\n"),position:I,pageIndex:D-1,rect:P,rotation:M,id:R,deleted:!1}}let P=super.deserialize(A,S,E);return P.#eI=A.fontSize,P.#eM=C.Util.makeHexColor(...A.color),P.#eR=A.value,P.annotationElementId=A.id||null,P.#eD=T,P}serialize(A=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};let S=FreeTextEditor._internalPadding*this.parentScale,E=this.getRect(S,S),T=P.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#eM),M={annotationType:C.AnnotationEditorType.FREETEXT,color:T,fontSize:this.#eI,value:this.#eR,pageIndex:this.pageIndex,rect:E,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return A?M:this.annotationElementId&&!this.#ez(M)?null:(M.id=this.annotationElementId,M)}#ez(A){let{value:S,fontSize:E,color:C,rect:T,pageIndex:P}=this.#eD;return A.value!==S||A.fontSize!==E||A.rect.some((A,S)=>Math.abs(A-T[S])>=1)||A.color.some((A,S)=>A!==C[S])||A.pageIndex!==P}#eN(A=!1){if(!this.annotationElementId)return;if(this.#eB(),!A&&(0===this.width||0===this.height)){setTimeout(()=>this.#eN(!0),0);return}let S=FreeTextEditor._internalPadding*this.parentScale;this.#eD.rect=this.getRect(S,S)}};S.FreeTextEditor=FreeTextEditor},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.StampAnnotationElement=S.InkAnnotationElement=S.FreeTextAnnotationElement=S.AnnotationLayer=void 0;var C=E(1),T=E(6),P=E(3),M=E(30),R=E(31),F=E(32);let I=1e3,D=9,L=new WeakSet;function getRectDims(A){return{width:A[2]-A[0],height:A[3]-A[1]}}let AnnotationElementFactory=class AnnotationElementFactory{static create(A){let S=A.data.annotationType;switch(S){case C.AnnotationType.LINK:return new LinkAnnotationElement(A);case C.AnnotationType.TEXT:return new TextAnnotationElement(A);case C.AnnotationType.WIDGET:let E=A.data.fieldType;switch(E){case"Tx":return new TextWidgetAnnotationElement(A);case"Btn":if(A.data.radioButton)return new RadioButtonWidgetAnnotationElement(A);if(A.data.checkBox)return new CheckboxWidgetAnnotationElement(A);return new PushButtonWidgetAnnotationElement(A);case"Ch":return new ChoiceWidgetAnnotationElement(A);case"Sig":return new SignatureWidgetAnnotationElement(A)}return new WidgetAnnotationElement(A);case C.AnnotationType.POPUP:return new PopupAnnotationElement(A);case C.AnnotationType.FREETEXT:return new FreeTextAnnotationElement(A);case C.AnnotationType.LINE:return new LineAnnotationElement(A);case C.AnnotationType.SQUARE:return new SquareAnnotationElement(A);case C.AnnotationType.CIRCLE:return new CircleAnnotationElement(A);case C.AnnotationType.POLYLINE:return new PolylineAnnotationElement(A);case C.AnnotationType.CARET:return new CaretAnnotationElement(A);case C.AnnotationType.INK:return new InkAnnotationElement(A);case C.AnnotationType.POLYGON:return new PolygonAnnotationElement(A);case C.AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(A);case C.AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(A);case C.AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(A);case C.AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(A);case C.AnnotationType.STAMP:return new StampAnnotationElement(A);case C.AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(A);default:return new AnnotationElement(A)}}};let AnnotationElement=class AnnotationElement{#eH=!1;constructor(A,{isRenderable:S=!1,ignoreBorder:E=!1,createQuadrilaterals:C=!1}={}){this.isRenderable=S,this.data=A.data,this.layer=A.layer,this.linkService=A.linkService,this.downloadManager=A.downloadManager,this.imageResourcesPath=A.imageResourcesPath,this.renderForms=A.renderForms,this.svgFactory=A.svgFactory,this.annotationStorage=A.annotationStorage,this.enableScripting=A.enableScripting,this.hasJSActions=A.hasJSActions,this._fieldObjects=A.fieldObjects,this.parent=A.parent,S&&(this.container=this._createContainer(E)),C&&this._createQuadrilaterals()}static _hasPopupData({titleObj:A,contentsObj:S,richText:E}){return!!(A?.str||S?.str||E?.str)}get hasPopupData(){return AnnotationElement._hasPopupData(this.data)}_createContainer(A){let{data:S,parent:{page:E,viewport:T}}=this,P=document.createElement("section");P.setAttribute("data-annotation-id",S.id),this instanceof WidgetAnnotationElement||(P.tabIndex=I),P.style.zIndex=this.parent.zIndex++,this.data.popupRef&&P.setAttribute("aria-haspopup","dialog"),S.noRotate&&P.classList.add("norotate");let{pageWidth:M,pageHeight:R,pageX:F,pageY:D}=T.rawDims;if(!S.rect||this instanceof PopupAnnotationElement){let{rotation:A}=S;return S.hasOwnCanvas||0===A||this.setRotation(A,P),P}let{width:L,height:O}=getRectDims(S.rect),B=C.Util.normalizeRect([S.rect[0],E.view[3]-S.rect[1]+E.view[1],S.rect[2],E.view[3]-S.rect[3]+E.view[1]]);if(!A&&S.borderStyle.width>0){P.style.borderWidth=`${S.borderStyle.width}px`;let A=S.borderStyle.horizontalCornerRadius,E=S.borderStyle.verticalCornerRadius;if(A>0||E>0){let S=`calc(${A}px * var(--scale-factor)) / calc(${E}px * var(--scale-factor))`;P.style.borderRadius=S}else if(this instanceof RadioButtonWidgetAnnotationElement){let A=`calc(${L}px * var(--scale-factor)) / calc(${O}px * var(--scale-factor))`;P.style.borderRadius=A}switch(S.borderStyle.style){case C.AnnotationBorderStyleType.SOLID:P.style.borderStyle="solid";break;case C.AnnotationBorderStyleType.DASHED:P.style.borderStyle="dashed";break;case C.AnnotationBorderStyleType.BEVELED:(0,C.warn)("Unimplemented border style: beveled");break;case C.AnnotationBorderStyleType.INSET:(0,C.warn)("Unimplemented border style: inset");break;case C.AnnotationBorderStyleType.UNDERLINE:P.style.borderBottomStyle="solid"}let T=S.borderColor||null;T?(this.#eH=!0,P.style.borderColor=C.Util.makeHexColor(0|T[0],0|T[1],0|T[2])):P.style.borderWidth=0}P.style.left=`${100*(B[0]-F)/M}%`,P.style.top=`${100*(B[1]-D)/R}%`;let{rotation:N}=S;return S.hasOwnCanvas||0===N?(P.style.width=`${100*L/M}%`,P.style.height=`${100*O/R}%`):this.setRotation(N,P),P}setRotation(A,S=this.container){let E,C;if(!this.data.rect)return;let{pageWidth:T,pageHeight:P}=this.parent.viewport.rawDims,{width:M,height:R}=getRectDims(this.data.rect);A%180==0?(E=100*M/T,C=100*R/P):(E=100*R/T,C=100*M/P),S.style.width=`${E}%`,S.style.height=`${C}%`,S.setAttribute("data-main-rotation",(360-A)%360)}get _commonActions(){let setColor=(A,S,E)=>{let C=E.detail[A],T=C[0],P=C.slice(1);E.target.style[S]=M.ColorConverters[`${T}_HTML`](P),this.annotationStorage.setValue(this.data.id,{[S]:M.ColorConverters[`${T}_rgb`](P)})};return(0,C.shadow)(this,"_commonActions",{display:A=>{let{display:S}=A.detail,E=S%2==1;this.container.style.visibility=E?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:E,noPrint:1===S||2===S})},print:A=>{this.annotationStorage.setValue(this.data.id,{noPrint:!A.detail.print})},hidden:A=>{let{hidden:S}=A.detail;this.container.style.visibility=S?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:S,noView:S})},focus:A=>{setTimeout(()=>A.target.focus({preventScroll:!1}),0)},userName:A=>{A.target.title=A.detail.userName},readonly:A=>{A.target.disabled=A.detail.readonly},required:A=>{this._setRequired(A.target,A.detail.required)},bgColor:A=>{setColor("bgColor","backgroundColor",A)},fillColor:A=>{setColor("fillColor","backgroundColor",A)},fgColor:A=>{setColor("fgColor","color",A)},textColor:A=>{setColor("textColor","color",A)},borderColor:A=>{setColor("borderColor","borderColor",A)},strokeColor:A=>{setColor("strokeColor","borderColor",A)},rotation:A=>{let S=A.detail.rotation;this.setRotation(S),this.annotationStorage.setValue(this.data.id,{rotation:S})}})}_dispatchEventFromSandbox(A,S){let E=this._commonActions;for(let C of Object.keys(S.detail)){let T=A[C]||E[C];T?.(S)}}_setDefaultPropertiesFromJS(A){if(!this.enableScripting)return;let S=this.annotationStorage.getRawValue(this.data.id);if(!S)return;let E=this._commonActions;for(let[C,T]of Object.entries(S)){let P=E[C];if(P){let E={detail:{[C]:T},target:A};P(E),delete S[C]}}}_createQuadrilaterals(){let A;if(!this.container)return;let{quadPoints:S}=this.data;if(!S)return;let[E,C,T,P]=this.data.rect;if(1===S.length){let[,{x:A,y:M},{x:R,y:F}]=S[0];if(T===A&&P===M&&E===R&&C===F)return}let{style:M}=this.container;if(this.#eH){let{borderColor:S,borderWidth:E}=M;M.borderWidth=0,A=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}let R=T-E,F=P-C,{svgFactory:I}=this,D=I.createElement("svg");D.classList.add("quadrilateralsContainer"),D.setAttribute("width",0),D.setAttribute("height",0);let L=I.createElement("defs");D.append(L);let O=I.createElement("clipPath"),B=`clippath_${this.data.id}`;for(let[,{x:C,y:T},{x:M,y:D}]of(O.setAttribute("id",B),O.setAttribute("clipPathUnits","objectBoundingBox"),L.append(O),S)){let S=I.createElement("rect"),L=(M-E)/R,B=(P-T)/F,N=(C-M)/R,U=(T-D)/F;S.setAttribute("x",L),S.setAttribute("y",B),S.setAttribute("width",N),S.setAttribute("height",U),O.append(S),A?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${B}" width="${N}" height="${U}"/>`)}this.#eH&&(A.push("</g></svg>')"),M.backgroundImage=A.join("")),this.container.append(D),this.container.style.clipPath=`url(#${B})`}_createPopup(){let{container:A,data:S}=this;A.setAttribute("aria-haspopup","dialog");let E=new PopupAnnotationElement({data:{color:S.color,titleObj:S.titleObj,modificationDate:S.modificationDate,contentsObj:S.contentsObj,richText:S.richText,parentRect:S.rect,borderStyle:0,id:`popup_${S.id}`,rotation:S.rotation},parent:this.parent,elements:[this]});this.parent.div.append(E.render())}render(){(0,C.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(A,S=null){let E=[];if(this._fieldObjects){let T=this._fieldObjects[A];if(T)for(let{page:A,id:P,exportValues:M}of T){if(-1===A||P===S)continue;let T="string"==typeof M?M:null,R=document.querySelector(`[data-element-id="${P}"]`);if(R&&!L.has(R)){(0,C.warn)(`_getElementsByName - element not allowed: ${P}`);continue}E.push({id:P,exportValue:T,domElement:R})}return E}for(let C of document.getElementsByName(A)){let{exportValue:A}=C,T=C.getAttribute("data-element-id");T!==S&&L.has(C)&&E.push({id:T,exportValue:A,domElement:C})}return E}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let A=this.getElementsToTriggerPopup();if(Array.isArray(A))for(let S of A)S.classList.add("highlightArea");else A.classList.add("highlightArea")}_editOnDoubleClick(){let{annotationEditorType:A,data:{id:S}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:A,editId:S})})}};let LinkAnnotationElement=class LinkAnnotationElement extends AnnotationElement{constructor(A,S=null){super(A,{isRenderable:!0,ignoreBorder:!!S?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=A.data.isTooltipOnly}render(){let{data:A,linkService:S}=this,E=document.createElement("a");E.setAttribute("data-element-id",A.id);let C=!1;return A.url?(S.addLinkAttributes(E,A.url,A.newWindow),C=!0):A.action?(this._bindNamedAction(E,A.action),C=!0):A.attachment?(this._bindAttachment(E,A.attachment),C=!0):A.setOCGState?(this.#eW(E,A.setOCGState),C=!0):A.dest?(this._bindLink(E,A.dest),C=!0):(A.actions&&(A.actions.Action||A.actions["Mouse Up"]||A.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(E,A),C=!0),A.resetForm?(this._bindResetFormAction(E,A.resetForm),C=!0):this.isTooltipOnly&&!C&&(this._bindLink(E,""),C=!0)),this.container.classList.add("linkAnnotation"),C&&this.container.append(E),this.container}#eG(){this.container.setAttribute("data-internal-link","")}_bindLink(A,S){A.href=this.linkService.getDestinationHash(S),A.onclick=()=>(S&&this.linkService.goToDestination(S),!1),(S||""===S)&&this.#eG()}_bindNamedAction(A,S){A.href=this.linkService.getAnchorUrl(""),A.onclick=()=>(this.linkService.executeNamedAction(S),!1),this.#eG()}_bindAttachment(A,S){A.href=this.linkService.getAnchorUrl(""),A.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,S.content,S.filename),!1),this.#eG()}#eW(A,S){A.href=this.linkService.getAnchorUrl(""),A.onclick=()=>(this.linkService.executeSetOCGState(S),!1),this.#eG()}_bindJSAction(A,S){A.href=this.linkService.getAnchorUrl("");let E=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let C of Object.keys(S.actions)){let T=E.get(C);T&&(A[T]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S.id,name:C}}),!1))}A.onclick||(A.onclick=()=>!1),this.#eG()}_bindResetFormAction(A,S){let E=A.onclick;if(E||(A.href=this.linkService.getAnchorUrl("")),this.#eG(),!this._fieldObjects){(0,C.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),E||(A.onclick=()=>!1);return}A.onclick=()=>{E?.();let{fields:A,refs:T,include:P}=S,M=[];if(0!==A.length||0!==T.length){let S=new Set(T);for(let E of A){let A=this._fieldObjects[E]||[];for(let{id:E}of A)S.add(E)}for(let A of Object.values(this._fieldObjects))for(let E of A)S.has(E.id)===P&&M.push(E)}else for(let A of Object.values(this._fieldObjects))M.push(...A);let R=this.annotationStorage,F=[];for(let A of M){let{id:S}=A;switch(F.push(S),A.type){case"text":{let E=A.defaultValue||"";R.setValue(S,{value:E});break}case"checkbox":case"radiobutton":{let E=A.defaultValue===A.exportValues;R.setValue(S,{value:E});break}case"combobox":case"listbox":{let E=A.defaultValue||"";R.setValue(S,{value:E});break}default:continue}let E=document.querySelector(`[data-element-id="${S}"]`);if(E){if(!L.has(E)){(0,C.warn)(`_bindResetFormAction - element not allowed: ${S}`);continue}E.dispatchEvent(new Event("resetform"))}}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:F,name:"ResetForm"}}),!1}}};let TextAnnotationElement=class TextAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let A=document.createElement("img");return A.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",A.alt="[{{type}} Annotation]",A.dataset.l10nId="text_annotation_type",A.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(A),this.container}};let WidgetAnnotationElement=class WidgetAnnotationElement extends AnnotationElement{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(A){this.data.hasOwnCanvas&&(A.previousSibling?.nodeName==="CANVAS"&&(A.previousSibling.hidden=!0),A.hidden=!1)}_getKeyModifier(A){let{isWin:S,isMac:E}=C.FeatureTest.platform;return S&&A.ctrlKey||E&&A.metaKey}_setEventListener(A,S,E,C,T){E.includes("mouse")?A.addEventListener(E,A=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:C,value:T(A),shift:A.shiftKey,modifier:this._getKeyModifier(A)}})}):A.addEventListener(E,A=>{if("blur"===E){if(!S.focused||!A.relatedTarget)return;S.focused=!1}else if("focus"===E){if(S.focused)return;S.focused=!0}T&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:C,value:T(A)}})})}_setEventListeners(A,S,E,C){for(let[T,P]of E)("Action"===P||this.data.actions?.[P])&&(("Focus"===P||"Blur"===P)&&(S||={focused:!1}),this._setEventListener(A,S,T,P,C),"Focus"!==P||this.data.actions?.Blur?"Blur"!==P||this.data.actions?.Focus||this._setEventListener(A,S,"focus","Focus",null):this._setEventListener(A,S,"blur","Blur",null))}_setBackgroundColor(A){let S=this.data.backgroundColor||null;A.style.backgroundColor=null===S?"transparent":C.Util.makeHexColor(S[0],S[1],S[2])}_setTextStyle(A){let S;let E=["left","center","right"],{fontColor:T}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||D,M=A.style,R=2,roundToOneDecimal=A=>Math.round(10*A)/10;if(this.data.multiLine){let A=Math.abs(this.data.rect[3]-this.data.rect[1]-R),E=Math.round(A/(C.LINE_FACTOR*P))||1,T=A/E;S=Math.min(P,roundToOneDecimal(T/C.LINE_FACTOR))}else{let A=Math.abs(this.data.rect[3]-this.data.rect[1]-R);S=Math.min(P,roundToOneDecimal(A/C.LINE_FACTOR))}M.fontSize=`calc(${S}px * var(--scale-factor))`,M.color=C.Util.makeHexColor(T[0],T[1],T[2]),null!==this.data.textAlignment&&(M.textAlign=E[this.data.textAlignment])}_setRequired(A,S){S?A.setAttribute("required",!0):A.removeAttribute("required"),A.setAttribute("aria-required",S)}};let TextWidgetAnnotationElement=class TextWidgetAnnotationElement extends WidgetAnnotationElement{constructor(A){let S=A.renderForms||!A.data.hasAppearance&&!!A.data.fieldValue;super(A,{isRenderable:S})}setPropertyOnSiblings(A,S,E,C){let T=this.annotationStorage;for(let P of this._getElementsByName(A.name,A.id))P.domElement&&(P.domElement[S]=E),T.setValue(P.id,{[C]:E})}render(){let A=this.annotationStorage,S=this.data.id;this.container.classList.add("textWidgetAnnotation");let E=null;if(this.renderForms){let C=A.getValue(S,{value:this.data.fieldValue}),T=C.value||"",P=A.getValue(S,{charLimit:this.data.maxLen}).charLimit;P&&T.length>P&&(T=T.slice(0,P));let M=C.formattedValue||this.data.textContent?.join("\n")||null;M&&this.data.comb&&(M=M.replaceAll(/\s+/g,""));let R={userValue:T,formattedValue:M,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?((E=document.createElement("textarea")).textContent=M??T,this.data.doNotScroll&&(E.style.overflowY="hidden")):((E=document.createElement("input")).type="text",E.setAttribute("value",M??T),this.data.doNotScroll&&(E.style.overflowX="hidden")),this.data.hasOwnCanvas&&(E.hidden=!0),L.add(E),E.setAttribute("data-element-id",S),E.disabled=this.data.readOnly,E.name=this.data.fieldName,E.tabIndex=I,this._setRequired(E,this.data.required),P&&(E.maxLength=P),E.addEventListener("input",C=>{A.setValue(S,{value:C.target.value}),this.setPropertyOnSiblings(E,"value",C.target.value,"value"),R.formattedValue=null}),E.addEventListener("resetform",A=>{let S=this.data.defaultFieldValue??"";E.value=R.userValue=S,R.formattedValue=null});let blurListener=A=>{let{formattedValue:S}=R;null!=S&&(A.target.value=S),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){E.addEventListener("focus",A=>{if(R.focused)return;let{target:S}=A;R.userValue&&(S.value=R.userValue),R.lastCommittedValue=S.value,R.commitKey=1,R.focused=!0}),E.addEventListener("updatefromsandbox",E=>{this.showElementAndHideCanvas(E.target);let C={value(E){R.userValue=E.detail.value??"",A.setValue(S,{value:R.userValue.toString()}),E.target.value=R.userValue},formattedValue(E){let{formattedValue:C}=E.detail;R.formattedValue=C,null!=C&&E.target!==document.activeElement&&(E.target.value=C),A.setValue(S,{formattedValue:C})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:E=>{let{charLimit:C}=E.detail,{target:T}=E;if(0===C){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let P=R.userValue;P&&!(P.length<=C)&&(P=P.slice(0,C),T.value=R.userValue=P,A.setValue(S,{value:P}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(C,E)}),E.addEventListener("keydown",A=>{R.commitKey=1;let E=-1;if("Escape"===A.key?E=0:"Enter"!==A.key||this.data.multiLine?"Tab"===A.key&&(R.commitKey=3):E=2,-1===E)return;let{value:C}=A.target;R.lastCommittedValue!==C&&(R.lastCommittedValue=C,R.userValue=C,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:C,willCommit:!0,commitKey:E,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});let C=blurListener;blurListener=null,E.addEventListener("blur",A=>{if(!R.focused||!A.relatedTarget)return;R.focused=!1;let{value:E}=A.target;R.userValue=E,R.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:E,willCommit:!0,commitKey:R.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}),C(A)}),this.data.actions?.Keystroke&&E.addEventListener("beforeinput",A=>{R.lastCommittedValue=null;let{data:E,target:C}=A,{value:T,selectionStart:P,selectionEnd:M}=C,F=P,I=M;switch(A.inputType){case"deleteWordBackward":{let A=T.substring(0,P).match(/\w*[^\w]*$/);A&&(F-=A[0].length);break}case"deleteWordForward":{let A=T.substring(P).match(/^[^\w]*\w*/);A&&(I+=A[0].length);break}case"deleteContentBackward":P===M&&(F-=1);break;case"deleteContentForward":P===M&&(I+=1)}A.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:T,change:E||"",willCommit:!1,selStart:F,selEnd:I}})}),this._setEventListeners(E,R,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(blurListener&&E.addEventListener("blur",blurListener),this.data.comb){let A=this.data.rect[2]-this.data.rect[0],S=A/P;E.classList.add("comb"),E.style.letterSpacing=`calc(${S}px * var(--scale-factor) - 1ch)`}}else(E=document.createElement("div")).textContent=this.data.fieldValue,E.style.verticalAlign="middle",E.style.display="table-cell";return this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}};let SignatureWidgetAnnotationElement=class SignatureWidgetAnnotationElement extends WidgetAnnotationElement{constructor(A){super(A,{isRenderable:!!A.data.hasOwnCanvas})}};let CheckboxWidgetAnnotationElement=class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement{constructor(A){super(A,{isRenderable:A.renderForms})}render(){let A=this.annotationStorage,S=this.data,E=S.id,C=A.getValue(E,{value:S.exportValue===S.fieldValue}).value;"string"==typeof C&&(C="Off"!==C,A.setValue(E,{value:C})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let T=document.createElement("input");return L.add(T),T.setAttribute("data-element-id",E),T.disabled=S.readOnly,this._setRequired(T,this.data.required),T.type="checkbox",T.name=S.fieldName,C&&T.setAttribute("checked",!0),T.setAttribute("exportValue",S.exportValue),T.tabIndex=I,T.addEventListener("change",C=>{let{name:T,checked:P}=C.target;for(let C of this._getElementsByName(T,E)){let E=P&&C.exportValue===S.exportValue;C.domElement&&(C.domElement.checked=E),A.setValue(C.id,{value:E})}A.setValue(E,{value:P})}),T.addEventListener("resetform",A=>{let E=S.defaultFieldValue||"Off";A.target.checked=E===S.exportValue}),this.enableScripting&&this.hasJSActions&&(T.addEventListener("updatefromsandbox",S=>{let C={value(S){S.target.checked="Off"!==S.detail.value,A.setValue(E,{value:S.target.checked})}};this._dispatchEventFromSandbox(C,S)}),this._setEventListeners(T,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.checked)),this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}};let RadioButtonWidgetAnnotationElement=class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement{constructor(A){super(A,{isRenderable:A.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let A=this.annotationStorage,S=this.data,E=S.id,C=A.getValue(E,{value:S.fieldValue===S.buttonValue}).value;"string"==typeof C&&(C=C!==S.buttonValue,A.setValue(E,{value:C}));let T=document.createElement("input");if(L.add(T),T.setAttribute("data-element-id",E),T.disabled=S.readOnly,this._setRequired(T,this.data.required),T.type="radio",T.name=S.fieldName,C&&T.setAttribute("checked",!0),T.tabIndex=I,T.addEventListener("change",S=>{let{name:C,checked:T}=S.target;for(let S of this._getElementsByName(C,E))A.setValue(S.id,{value:!1});A.setValue(E,{value:T})}),T.addEventListener("resetform",A=>{let E=S.defaultFieldValue;A.target.checked=null!=E&&E===S.buttonValue}),this.enableScripting&&this.hasJSActions){let C=S.buttonValue;T.addEventListener("updatefromsandbox",S=>{let T={value:S=>{let T=C===S.detail.value;for(let C of this._getElementsByName(S.target.name)){let S=T&&C.id===E;C.domElement&&(C.domElement.checked=S),A.setValue(C.id,{value:S})}}};this._dispatchEventFromSandbox(T,S)}),this._setEventListeners(T,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.checked)}return this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}};let PushButtonWidgetAnnotationElement=class PushButtonWidgetAnnotationElement extends LinkAnnotationElement{constructor(A){super(A,{ignoreBorder:A.data.hasAppearance})}render(){let A=super.render();A.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(A.title=this.data.alternativeText);let S=A.lastChild;return this.enableScripting&&this.hasJSActions&&S&&(this._setDefaultPropertiesFromJS(S),S.addEventListener("updatefromsandbox",A=>{this._dispatchEventFromSandbox({},A)})),A}};let ChoiceWidgetAnnotationElement=class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement{constructor(A){super(A,{isRenderable:A.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let A=this.annotationStorage,S=this.data.id,E=A.getValue(S,{value:this.data.fieldValue}),C=document.createElement("select");L.add(C),C.setAttribute("data-element-id",S),C.disabled=this.data.readOnly,this._setRequired(C,this.data.required),C.name=this.data.fieldName,C.tabIndex=I;let T=this.data.combo&&this.data.options.length>0;for(let A of(!this.data.combo&&(C.size=this.data.options.length,this.data.multiSelect&&(C.multiple=!0)),C.addEventListener("resetform",A=>{let S=this.data.defaultFieldValue;for(let A of C.options)A.selected=A.value===S}),this.data.options)){let S=document.createElement("option");S.textContent=A.displayValue,S.value=A.exportValue,E.value.includes(A.exportValue)&&(S.setAttribute("selected",!0),T=!1),C.append(S)}let P=null;if(T){let A=document.createElement("option");A.value=" ",A.setAttribute("hidden",!0),A.setAttribute("selected",!0),C.prepend(A),P=()=>{A.remove(),C.removeEventListener("input",P),P=null},C.addEventListener("input",P)}let getValue=A=>{let S=A?"value":"textContent",{options:E,multiple:T}=C;return T?Array.prototype.filter.call(E,A=>A.selected).map(A=>A[S]):-1===E.selectedIndex?null:E[E.selectedIndex][S]},M=getValue(!1),getItems=A=>{let S=A.target.options;return Array.prototype.map.call(S,A=>({displayValue:A.textContent,exportValue:A.value}))};return this.enableScripting&&this.hasJSActions?(C.addEventListener("updatefromsandbox",E=>{let T={value(E){P?.();let T=E.detail.value,R=new Set(Array.isArray(T)?T:[T]);for(let A of C.options)A.selected=R.has(A.value);A.setValue(S,{value:getValue(!0)}),M=getValue(!1)},multipleSelection(A){C.multiple=!0},remove(E){let T=C.options,P=E.detail.remove;if(T[P].selected=!1,C.remove(P),T.length>0){let A=Array.prototype.findIndex.call(T,A=>A.selected);-1===A&&(T[0].selected=!0)}A.setValue(S,{value:getValue(!0),items:getItems(E)}),M=getValue(!1)},clear(E){for(;0!==C.length;)C.remove(0);A.setValue(S,{value:null,items:[]}),M=getValue(!1)},insert(E){let{index:T,displayValue:P,exportValue:R}=E.detail.insert,F=C.children[T],I=document.createElement("option");I.textContent=P,I.value=R,F?F.before(I):C.append(I),A.setValue(S,{value:getValue(!0),items:getItems(E)}),M=getValue(!1)},items(E){let{items:T}=E.detail;for(;0!==C.length;)C.remove(0);for(let A of T){let{displayValue:S,exportValue:E}=A,T=document.createElement("option");T.textContent=S,T.value=E,C.append(T)}C.options.length>0&&(C.options[0].selected=!0),A.setValue(S,{value:getValue(!0),items:getItems(E)}),M=getValue(!1)},indices(E){let C=new Set(E.detail.indices);for(let A of E.target.options)A.selected=C.has(A.index);A.setValue(S,{value:getValue(!0)}),M=getValue(!1)},editable(A){A.target.disabled=!A.detail.editable}};this._dispatchEventFromSandbox(T,E)}),C.addEventListener("input",E=>{let C=getValue(!0);A.setValue(S,{value:C}),E.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S,name:"Keystroke",value:M,changeEx:C,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(C,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],A=>A.target.value)):C.addEventListener("input",function(E){A.setValue(S,{value:getValue(!0)})}),this.data.combo&&this._setTextStyle(C),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}};let PopupAnnotationElement=class PopupAnnotationElement extends AnnotationElement{constructor(A){let{data:S,elements:E}=A;super(A,{isRenderable:AnnotationElement._hasPopupData(S)}),this.elements=E}render(){this.container.classList.add("popupAnnotation");let A=new PopupElement({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),S=[];for(let E of this.elements)E.popup=A,S.push(E.data.id),E.addHighlightArea();return this.container.setAttribute("aria-controls",S.map(A=>`${C.AnnotationPrefix}${A}`).join(",")),this.container}};let PopupElement=class PopupElement{#eV=null;#eq=this.#e$.bind(this);#eX=this.#eK.bind(this);#eY=this.#eJ.bind(this);#eQ=this.#eZ.bind(this);#eM=null;#tF=null;#e0=null;#e1=null;#e2=null;#e3=null;#e5=!1;#e8=null;#e6=null;#e4=null;#e7=null;#e9=!1;constructor({container:A,color:S,elements:E,titleObj:C,modificationDate:P,contentsObj:M,richText:R,parent:F,rect:I,parentRect:D,open:L}){this.#tF=A,this.#e7=C,this.#e0=M,this.#e4=R,this.#e2=F,this.#eM=S,this.#e6=I,this.#e3=D,this.#e1=E;let O=T.PDFDateString.toDateObject(P);for(let A of(O&&(this.#eV=F.l10n.get("annotation_date_string",{date:O.toLocaleDateString(),time:O.toLocaleTimeString()})),this.trigger=E.flatMap(A=>A.getElementsToTriggerPopup()),this.trigger))A.addEventListener("click",this.#eQ),A.addEventListener("mouseenter",this.#eY),A.addEventListener("mouseleave",this.#eX),A.classList.add("popupTriggerArea");for(let A of E)A.container?.addEventListener("keydown",this.#eq);this.#tF.hidden=!0,L&&this.#eZ()}render(){if(this.#e8)return;let{page:{view:A},viewport:{rawDims:{pageWidth:S,pageHeight:E,pageX:T,pageY:P}}}=this.#e2,M=this.#e8=document.createElement("div");if(M.className="popup",this.#eM){let A=M.style.outlineColor=C.Util.makeHexColor(...this.#eM);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))M.style.backgroundColor=`color-mix(in srgb, ${A} 30%, white)`;else{let A=.7;M.style.backgroundColor=C.Util.makeHexColor(...this.#eM.map(S=>Math.floor(A*(255-S)+S)))}}let R=document.createElement("span");R.className="header";let I=document.createElement("h1");if(R.append(I),{dir:I.dir,str:I.textContent}=this.#e7,M.append(R),this.#eV){let A=document.createElement("span");A.classList.add("popupDate"),this.#eV.then(S=>{A.textContent=S}),R.append(A)}let D=this.#e0,L=this.#e4;if(L?.str&&(!D?.str||D.str===L.str))F.XfaLayer.render({xfaHtml:L.html,intent:"richText",div:M}),M.lastChild.classList.add("richText","popupContent");else{let A=this._formatContents(D);M.append(A)}let O=!!this.#e3,B=O?this.#e3:this.#e6;for(let A of this.#e1)if(!B||null!==C.Util.intersect(A.data.rect,B)){B=A.data.rect,O=!0;break}let N=C.Util.normalizeRect([B[0],A[3]-B[1]+A[1],B[2],A[3]-B[3]+A[1]]),U=5,z=O?B[2]-B[0]+U:0,H=N[0]+z,W=N[1],{style:V}=this.#tF;V.left=`${100*(H-T)/S}%`,V.top=`${100*(W-P)/E}%`,this.#tF.append(M)}_formatContents({str:A,dir:S}){let E=document.createElement("p");E.classList.add("popupContent"),E.dir=S;let C=A.split(/(?:\r\n?|\n)/);for(let A=0,S=C.length;A<S;++A){let T=C[A];E.append(document.createTextNode(T)),A<S-1&&E.append(document.createElement("br"))}return E}#e$(A){A.altKey||A.shiftKey||A.ctrlKey||A.metaKey||"Enter"!==A.key&&("Escape"!==A.key||!this.#e5)||this.#eZ()}#eZ(){this.#e5=!this.#e5,this.#e5?(this.#eJ(),this.#tF.addEventListener("click",this.#eQ),this.#tF.addEventListener("keydown",this.#eq)):(this.#eK(),this.#tF.removeEventListener("click",this.#eQ),this.#tF.removeEventListener("keydown",this.#eq))}#eJ(){this.#e8||this.render(),this.isVisible?this.#e5&&this.#tF.classList.add("focused"):(this.#tF.hidden=!1,this.#tF.style.zIndex=parseInt(this.#tF.style.zIndex)+1e3)}#eK(){this.#tF.classList.remove("focused"),!this.#e5&&this.isVisible&&(this.#tF.hidden=!0,this.#tF.style.zIndex=parseInt(this.#tF.style.zIndex)-1e3)}forceHide(){this.#e9=this.isVisible,this.#e9&&(this.#tF.hidden=!0)}maybeShow(){this.#e9&&(this.#e9=!1,this.#tF.hidden=!1)}get isVisible(){return!1===this.#tF.hidden}};let FreeTextAnnotationElement=class FreeTextAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0}),this.textContent=A.data.textContent,this.textPosition=A.data.textPosition,this.annotationEditorType=C.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let A=document.createElement("div");for(let S of(A.classList.add("annotationTextContent"),A.setAttribute("role","comment"),this.textContent)){let E=document.createElement("span");E.textContent=S,A.append(E)}this.container.append(A)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}};S.FreeTextAnnotationElement=FreeTextAnnotationElement;let LineAnnotationElement=class LineAnnotationElement extends AnnotationElement{#it=null;constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let A=this.data,{width:S,height:E}=getRectDims(A.rect),C=this.svgFactory.create(S,E,!0),T=this.#it=this.svgFactory.createElement("svg:line");return T.setAttribute("x1",A.rect[2]-A.lineCoordinates[0]),T.setAttribute("y1",A.rect[3]-A.lineCoordinates[1]),T.setAttribute("x2",A.rect[2]-A.lineCoordinates[2]),T.setAttribute("y2",A.rect[3]-A.lineCoordinates[3]),T.setAttribute("stroke-width",A.borderStyle.width||1),T.setAttribute("stroke","transparent"),T.setAttribute("fill","transparent"),C.append(T),this.container.append(C),!A.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#it}addHighlightArea(){this.container.classList.add("highlightArea")}};let SquareAnnotationElement=class SquareAnnotationElement extends AnnotationElement{#ie=null;constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let A=this.data,{width:S,height:E}=getRectDims(A.rect),C=this.svgFactory.create(S,E,!0),T=A.borderStyle.width,P=this.#ie=this.svgFactory.createElement("svg:rect");return P.setAttribute("x",T/2),P.setAttribute("y",T/2),P.setAttribute("width",S-T),P.setAttribute("height",E-T),P.setAttribute("stroke-width",T||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),C.append(P),this.container.append(C),!A.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#ie}addHighlightArea(){this.container.classList.add("highlightArea")}};let CircleAnnotationElement=class CircleAnnotationElement extends AnnotationElement{#ii=null;constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let A=this.data,{width:S,height:E}=getRectDims(A.rect),C=this.svgFactory.create(S,E,!0),T=A.borderStyle.width,P=this.#ii=this.svgFactory.createElement("svg:ellipse");return P.setAttribute("cx",S/2),P.setAttribute("cy",E/2),P.setAttribute("rx",S/2-T/2),P.setAttribute("ry",E/2-T/2),P.setAttribute("stroke-width",T||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),C.append(P),this.container.append(C),!A.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#ii}addHighlightArea(){this.container.classList.add("highlightArea")}};let PolylineAnnotationElement=class PolylineAnnotationElement extends AnnotationElement{#ir=null;constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let A=this.data,{width:S,height:E}=getRectDims(A.rect),C=this.svgFactory.create(S,E,!0),T=[];for(let S of A.vertices){let E=S.x-A.rect[0],C=A.rect[3]-S.y;T.push(E+","+C)}T=T.join(" ");let P=this.#ir=this.svgFactory.createElement(this.svgElementName);return P.setAttribute("points",T),P.setAttribute("stroke-width",A.borderStyle.width||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),C.append(P),this.container.append(C),!A.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#ir}addHighlightArea(){this.container.classList.add("highlightArea")}};let PolygonAnnotationElement=class PolygonAnnotationElement extends PolylineAnnotationElement{constructor(A){super(A),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}};let CaretAnnotationElement=class CaretAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}};let InkAnnotationElement=class InkAnnotationElement extends AnnotationElement{#is=[];constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=C.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);let A=this.data,{width:S,height:E}=getRectDims(A.rect),C=this.svgFactory.create(S,E,!0);for(let S of A.inkLists){let E=[];for(let C of S){let S=C.x-A.rect[0],T=A.rect[3]-C.y;E.push(`${S},${T}`)}E=E.join(" ");let T=this.svgFactory.createElement(this.svgElementName);this.#is.push(T),T.setAttribute("points",E),T.setAttribute("stroke-width",A.borderStyle.width||1),T.setAttribute("stroke","transparent"),T.setAttribute("fill","transparent"),!A.popupRef&&this.hasPopupData&&this._createPopup(),C.append(T)}return this.container.append(C),this.container}getElementsToTriggerPopup(){return this.#is}addHighlightArea(){this.container.classList.add("highlightArea")}};S.InkAnnotationElement=InkAnnotationElement;let HighlightAnnotationElement=class HighlightAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}};let UnderlineAnnotationElement=class UnderlineAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}};let SquigglyAnnotationElement=class SquigglyAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}};let StrikeOutAnnotationElement=class StrikeOutAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}};let StampAnnotationElement=class StampAnnotationElement extends AnnotationElement{constructor(A){super(A,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}};S.StampAnnotationElement=StampAnnotationElement;let FileAttachmentAnnotationElement=class FileAttachmentAnnotationElement extends AnnotationElement{#ia=null;constructor(A){super(A,{isRenderable:!0});let{filename:S,content:E}=this.data.file;this.filename=(0,T.getFilenameFromUrl)(S,!0),this.content=E,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:S,content:E})}render(){let A;this.container.classList.add("fileAttachmentAnnotation");let{container:S,data:E}=this;E.hasAppearance||0===E.fillAlpha?A=document.createElement("div"):((A=document.createElement("img")).src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(E.name)?"paperclip":"pushpin"}.svg`,E.fillAlpha&&E.fillAlpha<1&&(A.style=`filter: opacity(${Math.round(100*E.fillAlpha)}%);`)),A.addEventListener("dblclick",this.#io.bind(this)),this.#ia=A;let{isMac:T}=C.FeatureTest.platform;return S.addEventListener("keydown",A=>{"Enter"===A.key&&(T?A.metaKey:A.ctrlKey)&&this.#io()}),!E.popupRef&&this.hasPopupData?this._createPopup():A.classList.add("popupTriggerArea"),S.append(A),S}getElementsToTriggerPopup(){return this.#ia}addHighlightArea(){this.container.classList.add("highlightArea")}#io(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}};let AnnotationLayer=class AnnotationLayer{#eu=null;#il=null;#ih=new Map;constructor({div:A,accessibilityManager:S,annotationCanvasMap:E,l10n:C,page:T,viewport:P}){this.div=A,this.#eu=S,this.#il=E,this.l10n=C,this.page=T,this.viewport=P,this.zIndex=0,this.l10n||=R.NullL10n}#id(A,S){let E=A.firstChild||A;E.id=`${C.AnnotationPrefix}${S}`,this.div.append(A),this.#eu?.moveElementInDOM(this.div,A,E,!1)}async render(A){let{annotations:S}=A,E=this.div;(0,T.setLayerDimensions)(E,this.viewport);let M=new Map,R={data:null,layer:E,linkService:A.linkService,downloadManager:A.downloadManager,imageResourcesPath:A.imageResourcesPath||"",renderForms:!1!==A.renderForms,svgFactory:new T.DOMSVGFactory,annotationStorage:A.annotationStorage||new P.AnnotationStorage,enableScripting:!0===A.enableScripting,hasJSActions:A.hasJSActions,fieldObjects:A.fieldObjects,parent:this,elements:null};for(let A of S){if(A.noHTML)continue;let S=A.annotationType===C.AnnotationType.POPUP;if(S){let S=M.get(A.id);if(!S)continue;R.elements=S}else{let{width:S,height:E}=getRectDims(A.rect);if(S<=0||E<=0)continue}R.data=A;let E=AnnotationElementFactory.create(R);if(!E.isRenderable)continue;if(!S&&A.popupRef){let S=M.get(A.popupRef);S?S.push(E):M.set(A.popupRef,[E])}E.annotationEditorType>0&&this.#ih.set(E.data.id,E);let T=E.render();A.hidden&&(T.style.visibility="hidden"),this.#id(T,A.id)}this.#ic(),await this.l10n.translate(E)}update({viewport:A}){let S=this.div;this.viewport=A,(0,T.setLayerDimensions)(S,{rotation:A.rotation}),this.#ic(),S.hidden=!1}#ic(){if(!this.#il)return;let A=this.div;for(let[S,E]of this.#il){let C=A.querySelector(`[data-annotation-id="${S}"]`);if(!C)continue;let{firstChild:T}=C;T?"CANVAS"===T.nodeName?T.replaceWith(E):T.before(E):C.append(E)}this.#il.clear()}getEditableAnnotations(){return Array.from(this.#ih.values())}getEditableAnnotation(A){return this.#ih.get(A)}};S.AnnotationLayer=AnnotationLayer},(A,S)=>{function makeColorComp(A){return Math.floor(255*Math.max(0,Math.min(1,A))).toString(16).padStart(2,"0")}function scaleAndClamp(A){return Math.max(0,Math.min(255,255*A))}Object.defineProperty(S,"__esModule",{value:!0}),S.ColorConverters=void 0;let ColorConverters=class ColorConverters{static CMYK_G([A,S,E,C]){return["G",1-Math.min(1,.3*A+.59*E+.11*S+C)]}static G_CMYK([A]){return["CMYK",0,0,0,1-A]}static G_RGB([A]){return["RGB",A,A,A]}static G_rgb([A]){return[A=scaleAndClamp(A),A,A]}static G_HTML([A]){let S=makeColorComp(A);return`#${S}${S}${S}`}static RGB_G([A,S,E]){return["G",.3*A+.59*S+.11*E]}static RGB_rgb(A){return A.map(scaleAndClamp)}static RGB_HTML(A){return`#${A.map(makeColorComp).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([A,S,E,C]){return["RGB",1-Math.min(1,A+C),1-Math.min(1,E+C),1-Math.min(1,S+C)]}static CMYK_rgb([A,S,E,C]){return[scaleAndClamp(1-Math.min(1,A+C)),scaleAndClamp(1-Math.min(1,E+C)),scaleAndClamp(1-Math.min(1,S+C))]}static CMYK_HTML(A){let S=this.CMYK_RGB(A).slice(1);return this.RGB_HTML(S)}static RGB_CMYK([A,S,E]){let C=1-A,T=1-S,P=1-E,M=Math.min(C,T,P);return["CMYK",C,T,P,M]}};S.ColorConverters=ColorConverters},(A,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.NullL10n=void 0,S.getL10nFallback=getL10nFallback;let E={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xd7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xd7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};function getL10nFallback(A,S){switch(A){case"find_match_count":A=`find_match_count[${1===S.total?"one":"other"}]`;break;case"find_match_count_limit":A=`find_match_count_limit[${1===S.limit?"one":"other"}]`}return E[A]||""}function formatL10nValue(A,S){return S?A.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(A,E)=>E in S?S[E]:"{{"+E+"}}"):A}E.print_progress_percent="{{progress}}%";let C={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(A,S=null,E=getL10nFallback(A,S))=>formatL10nValue(E,S),async translate(A){}};S.NullL10n=C},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.XfaLayer=void 0;var C=E(25);let XfaLayer=class XfaLayer{static setupStorage(A,S,E,C,T){let P=C.getValue(S,{value:null});switch(E.name){case"textarea":if(null!==P.value&&(A.textContent=P.value),"print"===T)break;A.addEventListener("input",A=>{C.setValue(S,{value:A.target.value})});break;case"input":if("radio"===E.attributes.type||"checkbox"===E.attributes.type){if(P.value===E.attributes.xfaOn?A.setAttribute("checked",!0):P.value===E.attributes.xfaOff&&A.removeAttribute("checked"),"print"===T)break;A.addEventListener("change",A=>{C.setValue(S,{value:A.target.checked?A.target.getAttribute("xfaOn"):A.target.getAttribute("xfaOff")})})}else{if(null!==P.value&&A.setAttribute("value",P.value),"print"===T)break;A.addEventListener("input",A=>{C.setValue(S,{value:A.target.value})})}break;case"select":if(null!==P.value)for(let S of(A.setAttribute("value",P.value),E.children))S.attributes.value===P.value?S.attributes.selected=!0:S.attributes.hasOwnProperty("selected")&&delete S.attributes.selected;A.addEventListener("input",A=>{let E=A.target.options,T=-1===E.selectedIndex?"":E[E.selectedIndex].value;C.setValue(S,{value:T})})}}static setAttributes({html:A,element:S,storage:E=null,intent:C,linkService:T}){let{attributes:P}=S,M=A instanceof HTMLAnchorElement;for(let[S,E]of("radio"===P.type&&(P.name=`${P.name}-${C}`),Object.entries(P)))if(null!=E)switch(S){case"class":E.length&&A.setAttribute(S,E.join(" "));break;case"dataId":break;case"id":A.setAttribute("data-element-id",E);break;case"style":Object.assign(A.style,E);break;case"textContent":A.textContent=E;break;default:M&&("href"===S||"newWindow"===S)||A.setAttribute(S,E)}M&&T.addLinkAttributes(A,P.href,P.newWindow),E&&P.dataId&&this.setupStorage(A,P.dataId,S,E)}static render(A){let S=A.annotationStorage,E=A.linkService,T=A.xfaHtml,P=A.intent||"display",M=document.createElement(T.name);T.attributes&&this.setAttributes({html:M,element:T,intent:P,linkService:E});let R=[[T,-1,M]],F=A.div;if(F.append(M),A.viewport){let S=`matrix(${A.viewport.transform.join(",")})`;F.style.transform=S}"richText"!==P&&F.setAttribute("class","xfaLayer xfaFont");let I=[];for(;R.length>0;){let[A,T,M]=R.at(-1);if(T+1===A.children.length){R.pop();continue}let F=A.children[++R.at(-1)[1]];if(null===F)continue;let{name:D}=F;if("#text"===D){let A=document.createTextNode(F.value);I.push(A),M.append(A);continue}let L=F?.attributes?.xmlns?document.createElementNS(F.attributes.xmlns,D):document.createElement(D);if(M.append(L),F.attributes&&this.setAttributes({html:L,element:F,storage:S,intent:P,linkService:E}),F.children&&F.children.length>0)R.push([F,-1,L]);else if(F.value){let A=document.createTextNode(F.value);C.XfaText.shouldBuildText(D)&&I.push(A),L.append(A)}}for(let A of F.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:I}}static update(A){let S=`matrix(${A.viewport.transform.join(",")})`;A.div.style.transform=S,A.div.hidden=!1}};S.XfaLayer=XfaLayer},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.InkEditor=void 0;var C=E(1),T=E(4),P=E(29),M=E(6),R=E(5);let InkEditor=class InkEditor extends T.AnnotationEditor{#iu=0;#ip=0;#ig=this.canvasPointermove.bind(this);#im=this.canvasPointerleave.bind(this);#ib=this.canvasPointerup.bind(this);#iA=this.canvasPointerdown.bind(this);#iy=new Path2D;#iv=!1;#i_=!1;#iS=!1;#iE=null;#ix=0;#iC=0;#iw=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(A){super({...A,name:"inkEditor"}),this.color=A.color||null,this.thickness=A.thickness||null,this.opacity=A.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(A){T.AnnotationEditor.initialize(A,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(A,S){switch(A){case C.AnnotationEditorParamsType.INK_THICKNESS:InkEditor._defaultThickness=S;break;case C.AnnotationEditorParamsType.INK_COLOR:InkEditor._defaultColor=S;break;case C.AnnotationEditorParamsType.INK_OPACITY:InkEditor._defaultOpacity=S/100}}updateParams(A,S){switch(A){case C.AnnotationEditorParamsType.INK_THICKNESS:this.#iT(S);break;case C.AnnotationEditorParamsType.INK_COLOR:this.#eO(S);break;case C.AnnotationEditorParamsType.INK_OPACITY:this.#iP(S)}}static get defaultPropertiesToUpdate(){return[[C.AnnotationEditorParamsType.INK_THICKNESS,InkEditor._defaultThickness],[C.AnnotationEditorParamsType.INK_COLOR,InkEditor._defaultColor||T.AnnotationEditor._defaultLineColor],[C.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*InkEditor._defaultOpacity)]]}get propertiesToUpdate(){return[[C.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||InkEditor._defaultThickness],[C.AnnotationEditorParamsType.INK_COLOR,this.color||InkEditor._defaultColor||T.AnnotationEditor._defaultLineColor],[C.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??InkEditor._defaultOpacity))]]}#iT(A){let S=this.thickness;this.addCommands({cmd:()=>{this.thickness=A,this.#ik()},undo:()=>{this.thickness=S,this.#ik()},mustExec:!0,type:C.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#eO(A){let S=this.color;this.addCommands({cmd:()=>{this.color=A,this.#iM()},undo:()=>{this.color=S,this.#iM()},mustExec:!0,type:C.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#iP(A){A/=100;let S=this.opacity;this.addCommands({cmd:()=>{this.opacity=A,this.#iM()},undo:()=>{this.opacity=S,this.#iM()},mustExec:!0,type:C.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(this.#iR(),this.#iF()),this.isAttachedToDOM||(this.parent.add(this),this.#iI()),this.#ik()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#iE.disconnect(),this.#iE=null,super.remove())}setParent(A){!this.parent&&A?this._uiManager.removeShouldRescale(this):this.parent&&null===A&&this._uiManager.addShouldRescale(this),super.setParent(A)}onScaleChanging(){let[A,S]=this.parentDimensions,E=this.width*A,C=this.height*S;this.setDimensions(E,C)}enableEditMode(){this.#iv||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#iA))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#iA))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#iD(){let{parentRotation:A,parentDimensions:[S,E]}=this;switch(A){case 90:return[0,E,E,S];case 180:return[S,E,S,E];case 270:return[S,0,E,S];default:return[0,0,S,E]}}#iL(){let{ctx:A,color:S,opacity:E,thickness:C,parentScale:T,scaleFactor:P}=this;A.lineWidth=C*T/P,A.lineCap="round",A.lineJoin="round",A.miterLimit=10,A.strokeStyle=`${S}${(0,R.opacityToHex)(E)}`}#iO(A,S){this.canvas.addEventListener("contextmenu",M.noContextMenu),this.canvas.addEventListener("pointerleave",this.#im),this.canvas.addEventListener("pointermove",this.#ig),this.canvas.addEventListener("pointerup",this.#ib),this.canvas.removeEventListener("pointerdown",this.#iA),this.isEditing=!0,this.#iS||(this.#iS=!0,this.#iI(),this.thickness||=InkEditor._defaultThickness,this.color||=InkEditor._defaultColor||T.AnnotationEditor._defaultLineColor,this.opacity??=InkEditor._defaultOpacity),this.currentPath.push([A,S]),this.#i_=!1,this.#iL(),this.#iw=()=>{this.#iB(),this.#iw&&window.requestAnimationFrame(this.#iw)},window.requestAnimationFrame(this.#iw)}#iN(A,S){let[E,C]=this.currentPath.at(-1);if(this.currentPath.length>1&&A===E&&S===C)return;let T=this.currentPath,P=this.#iy;if(T.push([A,S]),this.#i_=!0,T.length<=2){P.moveTo(...T[0]),P.lineTo(A,S);return}3===T.length&&(this.#iy=P=new Path2D,P.moveTo(...T[0])),this.#iU(P,...T.at(-3),...T.at(-2),A,S)}#ij(){if(0===this.currentPath.length)return;let A=this.currentPath.at(-1);this.#iy.lineTo(...A)}#iz(A,S){let E;if(this.#iw=null,A=Math.min(Math.max(A,0),this.canvas.width),S=Math.min(Math.max(S,0),this.canvas.height),this.#iN(A,S),this.#ij(),1!==this.currentPath.length)E=this.#iH();else{let C=[A,S];E=[[C,C.slice(),C.slice(),C]]}let C=this.#iy,T=this.currentPath;this.currentPath=[],this.#iy=new Path2D;let cmd=()=>{this.allRawPaths.push(T),this.paths.push(E),this.bezierPath2D.push(C),this.rebuild()},undo=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#iR(),this.#iF()),this.#ik())};this.addCommands({cmd,undo,mustExec:!0})}#iB(){if(!this.#i_)return;this.#i_=!1,this.thickness,this.parentScale;let A=this.currentPath.slice(-3),{ctx:S}=(A.map(A=>A[0]),A.map(A=>A[1]),this);for(let A of(S.save(),S.clearRect(0,0,this.canvas.width,this.canvas.height),this.bezierPath2D))S.stroke(A);S.stroke(this.#iy),S.restore()}#iU(A,S,E,C,T,P,M){let R=(S+C)/2,F=(E+T)/2,I=(C+P)/2,D=(T+M)/2;A.bezierCurveTo(R+2*(C-R)/3,F+2*(T-F)/3,I+2*(C-I)/3,D+2*(T-D)/3,I,D)}#iH(){let A;let S=this.currentPath;if(S.length<=2)return[[S[0],S[0],S.at(-1),S.at(-1)]];let E=[],[C,T]=S[0];for(A=1;A<S.length-2;A++){let[P,M]=S[A],[R,F]=S[A+1],I=(P+R)/2,D=(M+F)/2,L=[C+2*(P-C)/3,T+2*(M-T)/3],O=[I+2*(P-I)/3,D+2*(M-D)/3];E.push([[C,T],L,O,[I,D]]),[C,T]=[I,D]}let[P,M]=S[A],[R,F]=S[A+1],I=[C+2*(P-C)/3,T+2*(M-T)/3],D=[R+2*(P-R)/3,F+2*(M-F)/3];return E.push([[C,T],I,D,[R,F]]),E}#iM(){if(this.isEmpty()){this.#iW();return}this.#iL();let{canvas:A,ctx:S}=this;for(let E of(S.setTransform(1,0,0,1,0,0),S.clearRect(0,0,A.width,A.height),this.#iW(),this.bezierPath2D))S.stroke(E)}commit(){this.#iv||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#iv=!0,this.div.classList.add("disabled"),this.#ik(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(A){this._focusEventsAllowed&&(super.focusin(A),this.enableEditMode())}canvasPointerdown(A){0===A.button&&this.isInEditMode()&&!this.#iv&&(this.setInForeground(),A.preventDefault(),"mouse"!==A.type&&this.div.focus(),this.#iO(A.offsetX,A.offsetY))}canvasPointermove(A){A.preventDefault(),this.#iN(A.offsetX,A.offsetY)}canvasPointerup(A){A.preventDefault(),this.#iG(A)}canvasPointerleave(A){this.#iG(A)}#iG(A){this.canvas.removeEventListener("pointerleave",this.#im),this.canvas.removeEventListener("pointermove",this.#ig),this.canvas.removeEventListener("pointerup",this.#ib),this.canvas.addEventListener("pointerdown",this.#iA),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",M.noContextMenu)},10),this.#iz(A.offsetX,A.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#iR(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",T.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(A=>this.canvas?.setAttribute("aria-label",A)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#iF(){this.#iE=new ResizeObserver(A=>{let S=A[0].contentRect;S.width&&S.height&&this.setDimensions(S.width,S.height)}),this.#iE.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#iv}render(){let A,S;if(this.div)return this.div;this.width&&(A=this.x,S=this.y),super.render(),T.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(A=>this.div?.setAttribute("aria-label",A));let[E,C,P,M]=this.#iD();if(this.setAt(E,C,0,0),this.setDims(P,M),this.#iR(),this.width){let[E,C]=this.parentDimensions;this.setAspectRatio(this.width*E,this.height*C),this.setAt(A*E,S*C,this.width*E,this.height*C),this.#iS=!0,this.#iI(),this.setDims(this.width*E,this.height*C),this.#iM(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#iF(),this.div}#iI(){if(!this.#iS)return;let[A,S]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*A),this.canvas.height=Math.ceil(this.height*S),this.#iW()}setDimensions(A,S){let E=Math.round(A),C=Math.round(S);if(this.#ix===E&&this.#iC===C)return;this.#ix=E,this.#iC=C,this.canvas.style.visibility="hidden";let[T,P]=this.parentDimensions;this.width=A/T,this.height=S/P,this.fixAndSetPosition(),this.#iv&&this.#iV(A,S),this.#iI(),this.#iM(),this.canvas.style.visibility="visible",this.fixDims()}#iV(A,S){let E=this.#iq(),C=(A-E)/this.#ip,T=(S-E)/this.#iu;this.scaleFactor=Math.min(C,T)}#iW(){let A=this.#iq()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+A,this.translationY*this.scaleFactor+A)}static #i$(A){let S=new Path2D;for(let E=0,C=A.length;E<C;E++){let[C,T,P,M]=A[E];0===E&&S.moveTo(...C),S.bezierCurveTo(T[0],T[1],P[0],P[1],M[0],M[1])}return S}static #iX(A,S,E){let[C,T,P,M]=S;switch(E){case 0:for(let S=0,E=A.length;S<E;S+=2)A[S]+=C,A[S+1]=M-A[S+1];break;case 90:for(let S=0,E=A.length;S<E;S+=2){let E=A[S];A[S]=A[S+1]+C,A[S+1]=E+T}break;case 180:for(let S=0,E=A.length;S<E;S+=2)A[S]=P-A[S],A[S+1]+=T;break;case 270:for(let S=0,E=A.length;S<E;S+=2){let E=A[S];A[S]=P-A[S+1],A[S+1]=M-E}break;default:throw Error("Invalid rotation")}return A}static #iK(A,S,E){let[C,T,P,M]=S;switch(E){case 0:for(let S=0,E=A.length;S<E;S+=2)A[S]-=C,A[S+1]=M-A[S+1];break;case 90:for(let S=0,E=A.length;S<E;S+=2){let E=A[S];A[S]=A[S+1]-T,A[S+1]=E-C}break;case 180:for(let S=0,E=A.length;S<E;S+=2)A[S]=P-A[S],A[S+1]-=T;break;case 270:for(let S=0,E=A.length;S<E;S+=2){let E=A[S];A[S]=M-A[S+1],A[S+1]=P-E}break;default:throw Error("Invalid rotation")}return A}#iY(A,S,E,C){let T=[],P=this.thickness/2,M=A*S+P,R=A*E+P;for(let S of this.paths){let E=[],P=[];for(let C=0,T=S.length;C<T;C++){let[F,I,D,L]=S[C],O=A*F[0]+M,B=A*F[1]+R,N=A*I[0]+M,U=A*I[1]+R,z=A*D[0]+M,H=A*D[1]+R,W=A*L[0]+M,V=A*L[1]+R;0===C&&(E.push(O,B),P.push(O,B)),E.push(N,U,z,H,W,V),P.push(N,U),C===T-1&&P.push(W,V)}T.push({bezier:InkEditor.#iX(E,C,this.rotation),points:InkEditor.#iX(P,C,this.rotation)})}return T}#iJ(){let A=1/0,S=-1/0,E=1/0,T=-1/0;for(let P of this.paths)for(let[M,R,F,I]of P){let P=C.Util.bezierBoundingBox(...M,...R,...F,...I);A=Math.min(A,P[0]),E=Math.min(E,P[1]),S=Math.max(S,P[2]),T=Math.max(T,P[3])}return[A,E,S,T]}#iq(){return this.#iv?Math.ceil(this.thickness*this.parentScale):0}#ik(A=!1){if(this.isEmpty())return;if(!this.#iv){this.#iM();return}let S=this.#iJ(),E=this.#iq();this.#ip=Math.max(T.AnnotationEditor.MIN_SIZE,S[2]-S[0]),this.#iu=Math.max(T.AnnotationEditor.MIN_SIZE,S[3]-S[1]);let C=Math.ceil(E+this.#ip*this.scaleFactor),P=Math.ceil(E+this.#iu*this.scaleFactor),[M,R]=this.parentDimensions;this.width=C/M,this.height=P/R,this.setAspectRatio(C,P);let F=this.translationX,I=this.translationY;this.translationX=-S[0],this.translationY=-S[1],this.#iI(),this.#iM(),this.#ix=C,this.#iC=P,this.setDims(C,P);let D=A?E/this.scaleFactor/2:0;this.translate(F-this.translationX-D,I-this.translationY-D)}static deserialize(A,S,E){if(A instanceof P.InkAnnotationElement)return null;let M=super.deserialize(A,S,E);M.thickness=A.thickness,M.color=C.Util.makeHexColor(...A.color),M.opacity=A.opacity;let[R,F]=M.pageDimensions,I=M.width*R,D=M.height*F,L=M.parentScale,O=A.thickness/2;M.#iv=!0,M.#ix=Math.round(I),M.#iC=Math.round(D);let{paths:B,rect:N,rotation:U}=A;for(let{bezier:A}of B){A=InkEditor.#iK(A,N,U);let S=[];M.paths.push(S);let E=L*(A[0]-O),C=L*(A[1]-O);for(let T=2,P=A.length;T<P;T+=6){let P=L*(A[T]-O),M=L*(A[T+1]-O),R=L*(A[T+2]-O),F=L*(A[T+3]-O),I=L*(A[T+4]-O),D=L*(A[T+5]-O);S.push([[E,C],[P,M],[R,F],[I,D]]),E=I,C=D}let T=this.#i$(S);M.bezierPath2D.push(T)}let z=M.#iJ();return M.#ip=Math.max(T.AnnotationEditor.MIN_SIZE,z[2]-z[0]),M.#iu=Math.max(T.AnnotationEditor.MIN_SIZE,z[3]-z[1]),M.#iV(I,D),M}serialize(){if(this.isEmpty())return null;let A=this.getRect(0,0),S=T.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:C.AnnotationEditorType.INK,color:S,thickness:this.thickness,opacity:this.opacity,paths:this.#iY(this.scaleFactor/this.parentScale,this.translationX,this.translationY,A),pageIndex:this.pageIndex,rect:A,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};S.InkEditor=InkEditor},(A,S,E)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.StampEditor=void 0;var C=E(1),T=E(4),P=E(6),M=E(29);let StampEditor=class StampEditor extends T.AnnotationEditor{#iQ=null;#iZ=null;#i0=null;#i1=null;#i2=null;#i3=null;#iE=null;#i5=null;#i8=!1;#i6=!1;static _type="stamp";constructor(A){super({...A,name:"stampEditor"}),this.#i1=A.bitmapUrl,this.#i2=A.bitmapFile}static initialize(A){T.AnnotationEditor.initialize(A)}static get supportedTypes(){let A=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,C.shadow)(this,"supportedTypes",A.map(A=>`image/${A}`))}static get supportedTypesStr(){return(0,C.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(A){return this.supportedTypes.includes(A)}static paste(A,S){S.pasteEditor(C.AnnotationEditorType.STAMP,{bitmapFile:A.getAsFile()})}#i4(A,S=!1){if(!A){this.remove();return}this.#iQ=A.bitmap,S||(this.#iZ=A.id,this.#i8=A.isSvg),this.#iR()}#i7(){this.#i0=null,this._uiManager.enableWaiting(!1),this.#i3&&this.div.focus()}#i9(){if(this.#iZ){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#iZ).then(A=>this.#i4(A,!0)).finally(()=>this.#i7());return}if(this.#i1){let A=this.#i1;this.#i1=null,this._uiManager.enableWaiting(!0),this.#i0=this._uiManager.imageManager.getFromUrl(A).then(A=>this.#i4(A)).finally(()=>this.#i7());return}if(this.#i2){let A=this.#i2;this.#i2=null,this._uiManager.enableWaiting(!0),this.#i0=this._uiManager.imageManager.getFromFile(A).then(A=>this.#i4(A)).finally(()=>this.#i7());return}let A=document.createElement("input");A.type="file",A.accept=StampEditor.supportedTypesStr,this.#i0=new Promise(S=>{A.addEventListener("change",async()=>{if(A.files&&0!==A.files.length){this._uiManager.enableWaiting(!0);let S=await this._uiManager.imageManager.getFromFile(A.files[0]);this.#i4(S)}else this.remove();S()}),A.addEventListener("cancel",()=>{this.remove(),S()})}).finally(()=>this.#i7()),A.click()}remove(){this.#iZ&&(this.#iQ=null,this._uiManager.imageManager.deleteId(this.#iZ),this.#i3?.remove(),this.#i3=null,this.#iE?.disconnect(),this.#iE=null),super.remove()}rebuild(){if(!this.parent){this.#iZ&&this.#i9();return}super.rebuild(),null!==this.div&&(this.#iZ&&this.#i9(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#i0||this.#iQ||this.#i1||this.#i2)}get isResizable(){return!0}render(){let A,S;if(this.div)return this.div;if(this.width&&(A=this.x,S=this.y),super.render(),this.div.hidden=!0,this.#iQ?this.#iR():this.#i9(),this.width){let[E,C]=this.parentDimensions;this.setAt(A*E,S*C,this.width*E,this.height*C)}return this.div}#iR(){let{div:A}=this,{width:S,height:E}=this.#iQ,[C,T]=this.pageDimensions,P=.75;if(this.width)S=this.width*C,E=this.height*T;else if(S>P*C||E>P*T){let A=Math.min(P*C/S,P*T/E);S*=A,E*=A}let[M,R]=this.parentDimensions;this.setDims(S*M/C,E*R/T),this._uiManager.enableWaiting(!1);let F=this.#i3=document.createElement("canvas");A.append(F),A.hidden=!1,this.#rt(S,E),this.#iF(),this.#i6||(this.parent.addUndoableEditor(this),this.#i6=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#re(A,S){let[E,C]=this.parentDimensions;this.width=A/E,this.height=S/C,this.setDims(A,S),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==this.#i5&&clearTimeout(this.#i5);let T=200;this.#i5=setTimeout(()=>{this.#i5=null,this.#rt(A,S)},T)}#ri(A,S){let{width:E,height:C}=this.#iQ,T=E,P=C,M=this.#iQ;for(;T>2*A||P>2*S;){let E=T,C=P;T>2*A&&(T=T>=16384?Math.floor(T/2)-1:Math.ceil(T/2)),P>2*S&&(P=P>=16384?Math.floor(P/2)-1:Math.ceil(P/2));let R=new OffscreenCanvas(T,P),F=R.getContext("2d");F.drawImage(M,0,0,E,C,0,0,T,P),M=R.transferToImageBitmap()}return M}#rt(A,S){A=Math.ceil(A),S=Math.ceil(S);let E=this.#i3;if(!E||E.width===A&&E.height===S)return;E.width=A,E.height=S;let C=this.#i8?this.#iQ:this.#ri(A,S),T=E.getContext("2d");T.filter=this._uiManager.hcmFilter,T.drawImage(C,0,0,C.width,C.height,0,0,A,S)}#rr(A){if(A){if(this.#i8){let A=this._uiManager.imageManager.getSvgUrl(this.#iZ);if(A)return A}let A=document.createElement("canvas");({width:A.width,height:A.height}=this.#iQ);let S=A.getContext("2d");return S.drawImage(this.#iQ,0,0),A.toDataURL()}if(this.#i8){let[A,S]=this.pageDimensions,E=Math.round(this.width*A*P.PixelsPerInch.PDF_TO_CSS_UNITS),C=Math.round(this.height*S*P.PixelsPerInch.PDF_TO_CSS_UNITS),T=new OffscreenCanvas(E,C),M=T.getContext("2d");return M.drawImage(this.#iQ,0,0,this.#iQ.width,this.#iQ.height,0,0,E,C),T.transferToImageBitmap()}return structuredClone(this.#iQ)}#iF(){this.#iE=new ResizeObserver(A=>{let S=A[0].contentRect;S.width&&S.height&&this.#re(S.width,S.height)}),this.#iE.observe(this.div)}static deserialize(A,S,E){if(A instanceof M.StampAnnotationElement)return null;let C=super.deserialize(A,S,E),{rect:T,bitmapUrl:P,bitmapId:R,isSvg:F,accessibilityData:I}=A;R&&E.imageManager.isValidId(R)?C.#iZ=R:C.#i1=P,C.#i8=F;let[D,L]=C.pageDimensions;return C.width=(T[2]-T[0])/D,C.height=(T[3]-T[1])/L,I&&(C.altTextData=I),C}serialize(A=!1,S=null){if(this.isEmpty())return null;let E={annotationType:C.AnnotationEditorType.STAMP,bitmapId:this.#iZ,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#i8,structTreeParentId:this._structTreeParentId};if(A)return E.bitmapUrl=this.#rr(!0),E.accessibilityData=this.altTextData,E;let{decorative:T,altText:P}=this.altTextData;if(!T&&P&&(E.accessibilityData={type:"Figure",alt:P}),null===S)return E;S.stamps||=new Map;let M=this.#i8?(E.rect[2]-E.rect[0])*(E.rect[3]-E.rect[1]):null;if(S.stamps.has(this.#iZ)){if(this.#i8){let A=S.stamps.get(this.#iZ);M>A.area&&(A.area=M,A.serialized.bitmap.close(),A.serialized.bitmap=this.#rr(!1))}}else S.stamps.set(this.#iZ,{area:M,serialized:E}),E.bitmap=this.#rr(!1);return E}};S.StampEditor=StampEditor}],__webpack_module_cache__={};function __w_pdfjs_require__(A){var S=__webpack_module_cache__[A];if(void 0!==S)return S.exports;var E=__webpack_module_cache__[A]={exports:{}};return __webpack_modules__[A](E,E.exports,__w_pdfjs_require__),E.exports}var __nested_webpack_exports__={};return(()=>{var A=__nested_webpack_exports__;Object.defineProperty(A,"__esModule",{value:!0}),Object.defineProperty(A,"AbortException",{enumerable:!0,get:function(){return S.AbortException}}),Object.defineProperty(A,"AnnotationEditorLayer",{enumerable:!0,get:function(){return P.AnnotationEditorLayer}}),Object.defineProperty(A,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return S.AnnotationEditorParamsType}}),Object.defineProperty(A,"AnnotationEditorType",{enumerable:!0,get:function(){return S.AnnotationEditorType}}),Object.defineProperty(A,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return M.AnnotationEditorUIManager}}),Object.defineProperty(A,"AnnotationLayer",{enumerable:!0,get:function(){return R.AnnotationLayer}}),Object.defineProperty(A,"AnnotationMode",{enumerable:!0,get:function(){return S.AnnotationMode}}),Object.defineProperty(A,"CMapCompressionType",{enumerable:!0,get:function(){return S.CMapCompressionType}}),Object.defineProperty(A,"DOMSVGFactory",{enumerable:!0,get:function(){return C.DOMSVGFactory}}),Object.defineProperty(A,"FeatureTest",{enumerable:!0,get:function(){return S.FeatureTest}}),Object.defineProperty(A,"GlobalWorkerOptions",{enumerable:!0,get:function(){return F.GlobalWorkerOptions}}),Object.defineProperty(A,"ImageKind",{enumerable:!0,get:function(){return S.ImageKind}}),Object.defineProperty(A,"InvalidPDFException",{enumerable:!0,get:function(){return S.InvalidPDFException}}),Object.defineProperty(A,"MissingPDFException",{enumerable:!0,get:function(){return S.MissingPDFException}}),Object.defineProperty(A,"OPS",{enumerable:!0,get:function(){return S.OPS}}),Object.defineProperty(A,"PDFDataRangeTransport",{enumerable:!0,get:function(){return E.PDFDataRangeTransport}}),Object.defineProperty(A,"PDFDateString",{enumerable:!0,get:function(){return C.PDFDateString}}),Object.defineProperty(A,"PDFWorker",{enumerable:!0,get:function(){return E.PDFWorker}}),Object.defineProperty(A,"PasswordResponses",{enumerable:!0,get:function(){return S.PasswordResponses}}),Object.defineProperty(A,"PermissionFlag",{enumerable:!0,get:function(){return S.PermissionFlag}}),Object.defineProperty(A,"PixelsPerInch",{enumerable:!0,get:function(){return C.PixelsPerInch}}),Object.defineProperty(A,"PromiseCapability",{enumerable:!0,get:function(){return S.PromiseCapability}}),Object.defineProperty(A,"RenderingCancelledException",{enumerable:!0,get:function(){return C.RenderingCancelledException}}),Object.defineProperty(A,"SVGGraphics",{enumerable:!0,get:function(){return E.SVGGraphics}}),Object.defineProperty(A,"UnexpectedResponseException",{enumerable:!0,get:function(){return S.UnexpectedResponseException}}),Object.defineProperty(A,"Util",{enumerable:!0,get:function(){return S.Util}}),Object.defineProperty(A,"VerbosityLevel",{enumerable:!0,get:function(){return S.VerbosityLevel}}),Object.defineProperty(A,"XfaLayer",{enumerable:!0,get:function(){return I.XfaLayer}}),Object.defineProperty(A,"build",{enumerable:!0,get:function(){return E.build}}),Object.defineProperty(A,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return S.createValidAbsoluteUrl}}),Object.defineProperty(A,"getDocument",{enumerable:!0,get:function(){return E.getDocument}}),Object.defineProperty(A,"getFilenameFromUrl",{enumerable:!0,get:function(){return C.getFilenameFromUrl}}),Object.defineProperty(A,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return C.getPdfFilenameFromUrl}}),Object.defineProperty(A,"getXfaPageViewport",{enumerable:!0,get:function(){return C.getXfaPageViewport}}),Object.defineProperty(A,"isDataScheme",{enumerable:!0,get:function(){return C.isDataScheme}}),Object.defineProperty(A,"isPdfFile",{enumerable:!0,get:function(){return C.isPdfFile}}),Object.defineProperty(A,"loadScript",{enumerable:!0,get:function(){return C.loadScript}}),Object.defineProperty(A,"noContextMenu",{enumerable:!0,get:function(){return C.noContextMenu}}),Object.defineProperty(A,"normalizeUnicode",{enumerable:!0,get:function(){return S.normalizeUnicode}}),Object.defineProperty(A,"renderTextLayer",{enumerable:!0,get:function(){return T.renderTextLayer}}),Object.defineProperty(A,"setLayerDimensions",{enumerable:!0,get:function(){return C.setLayerDimensions}}),Object.defineProperty(A,"shadow",{enumerable:!0,get:function(){return S.shadow}}),Object.defineProperty(A,"updateTextLayer",{enumerable:!0,get:function(){return T.updateTextLayer}}),Object.defineProperty(A,"version",{enumerable:!0,get:function(){return E.version}});var S=__w_pdfjs_require__(1),E=__w_pdfjs_require__(2),C=__w_pdfjs_require__(6),T=__w_pdfjs_require__(26),P=__w_pdfjs_require__(27),M=__w_pdfjs_require__(5),R=__w_pdfjs_require__(29),F=__w_pdfjs_require__(14),I=__w_pdfjs_require__(32)})(),__nested_webpack_exports__})())},3414:function(){},172:function(){},2001:function(){},3779:function(){},2258:function(){},2191:function(A,S,E){"use strict";var C=E(9299);let T=C;S.default=T}},function(A){var __webpack_exec__=function(S){return A(A.s=S)};A.O(0,[774,179],function(){return __webpack_exec__(1118),__webpack_exec__(9974)}),_N_E=A.O()}]);